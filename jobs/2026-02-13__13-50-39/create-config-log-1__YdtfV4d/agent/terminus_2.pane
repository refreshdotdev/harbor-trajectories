[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:~# asciinema rec --stdin /logs/agent/recording.cast
[?2004l[0;32masciinema: recording asciicast to /logs/agent/recording.cast[0m
[0;32masciinema: press <ctrl-d> or type "exit" when you're done[0m
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:~# clear
[?2004l[H[J[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:~# echo "NET_CONF_DIR is: $NET_CONF_DIR"
[?2004lNET_CONF_DIR is: /home/user/network_ops
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:~# export NET_CONF_DIR="/home/user/network_ops"
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:~# cd "$NET_CONF_DIR"
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# pwd
[?2004l/home/user/network_ops
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# ls -la
[?2004ltotal 0
drwxr-xr-x 1 root root 103 Feb 12 23:58 [0m[01;34m.[0m
drwxr-xr-x 1 root root  33 Feb 12 23:58 [01;34m..[0m
drwxr-xr-x 1 root root  10 Feb 12 23:58 [01;34mbackups[0m
drwxr-xr-x 1 root root  33 Feb 12 23:58 [01;34mbaseline[0m
drwxr-xr-x 1 root root  33 Feb 12 23:58 [01;34mcurrent[0m
drwxr-xr-x 1 root root  10 Feb 12 23:58 [01;34mlogs[0m
drwxr-xr-x 1 root root  10 Feb 12 23:58 [01;34mpatches[0m
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# ls -la baseline/
[?2004ltotal 0
drwxr-xr-x 1 root root  33 Feb 12 23:58 [0m[01;34m.[0m
drwxr-xr-x 1 root root 103 Feb 12 23:58 [01;34m..[0m
-rw-r--r-- 1 root root   0 Feb 12 23:58 router.conf
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# ls -la current/
[?2004ltotal 0
drwxr-xr-x 1 root root  33 Feb 12 23:58 [0m[01;34m.[0m
drwxr-xr-x 1 root root 103 Feb 12 23:58 [01;34m..[0m
-rw-r--r-- 1 root root   0 Feb 12 23:58 router.conf
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# mkdir -pv backups logs patches
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# cat > current/router.conf << EOF
[?2004l[?2004h> 
[?2004l[?2004h> hostname router-broken
[?2004l[?2004h> 
[?2004l[?2004h> !
[?2004l[?2004h> 
[?2004l[?2004h> interface GigabitEthernet0/1
[?2004l[?2004h> 
[?2004l[?2004h>  ip address 10.0.0.2/24
[?2004l[?2004h> 
[?2004l[?2004h>  shutdown
[?2004l[?2004h> 
[?2004l[?2004h> !
[?2004l[?2004h> 
[?2004l[?2004h> router ospf 1
[?2004l[?2004h> 
[?2004l[?2004h>  router-id 1.1.1.1
[?2004l[?2004h> 
[?2004l[?2004h>  network 10.0.0.0 0.0.0.255 area 0
[?2004l[?2004h> 
[?2004l[?2004h> !
[?2004l[?2004h> 
[?2004l[?2004h> EOF
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# cat > baseline/router.conf << EOF
[?2004l[?2004h> hostname router-good
[?2004l[?2004h> !
[?2004l[?2004h> interface GigabitEthernet0/1
[?2004l[?2004h>  ip address 10.0.0.1/24
[?2004l[?2004h>  no shutdown
[?2004l[?2004h> !
[?2004l[?2004h> router ospf 1
[?2004l[?2004h>  router-id 1.1.1.1
[?2004l[?2004h>  network 10.0.0.0 0.0.0.255 area 0
[?2004l[?2004h>  network 192.168.1.0 0.0.0.255 area 0
[?2004l[?2004h> !
[?2004l[?2004h> EOF
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# file current/router.conf
[?2004lbash: file: command not found
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# file baseline/router.conf
[?2004lbash: file: command not found
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# head -5 current/router.conf
[?2004l
hostname router-broken

!

[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# head -5 baseline/router.conf
[?2004lhostname router-good
!
interface GigabitEthernet0/1
 ip address 10.0.0.1/24
 no shutdown
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# cat -A current/router.conf
[?2004l$
hostname router-broken$
$
!$
$
interface GigabitEthernet0/1$
$
 ip address 10.0.0.2/24$
$
 shutdown$
$
!$
$
router ospf 1$
$
 router-id 1.1.1.1$
$
 network 10.0.0.0 0.0.0.255 area 0$
$
!$
$
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# cat -A baseline/router.conf
[?2004lhostname router-good$
!$
interface GigabitEthernet0/1$
 ip address 10.0.0.1/24$
 no shutdown$
!$
router ospf 1$
 router-id 1.1.1.1$
 network 10.0.0.0 0.0.0.255 area 0$
 network 192.168.1.0 0.0.0.255 area 0$
!$
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# cp current/router.conf backups/router.conf.orig
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# gzip backups/router.conf.orig
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# ls -la backups/
[?2004ltotal 4
drwxr-xr-x 1 root root  41 Feb 13 18:56 [0m[01;34m.[0m
drwxr-xr-x 1 root root  68 Feb 12 23:58 [01;34m..[0m
-rw-r--r-- 1 root root 156 Feb 13 18:56 [01;31mrouter.conf.orig.gz[0m
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# echo "$(date --utc +'%Y-%m-%dT%H:%M:%SZ') - BACKED_UP - OK" >> logs/patch_application.log
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# sed -i 's/\r$//' current/router.conf
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# cat -A current/router.conf
[?2004l$
hostname router-broken$
$
!$
$
interface GigabitEthernet0/1$
$
 ip address 10.0.0.2/24$
$
 shutdown$
$
!$
$
router ospf 1$
$
 router-id 1.1.1.1$
$
 network 10.0.0.0 0.0.0.255 area 0$
$
!$
$
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# echo "$(date --utc +'%Y-%m-%dT%H:%M:%SZ') - NORMALIZED_LF - OK" >> logs/patch_application.log
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# cat current/router.conf | tr -d '\r' > current/router.conf.normalized
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# mv current/router.conf.normalized current/router.conf
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# cat -A current/router.conf
[?2004l$
hostname router-broken$
$
!$
$
interface GigabitEthernet0/1$
$
 ip address 10.0.0.2/24$
$
 shutdown$
$
!$
$
router ospf 1$
$
 router-id 1.1.1.1$
$
 network 10.0.0.0 0.0.0.255 area 0$
$
!$
$
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# echo "$(date --utc +'%Y-%m-%dT%H:%M:%SZ') - NORMALIZED_LF - OK" >> logs/patch_application.log
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# diff -u current/router.conf baseline/router.conf > patches/router_fix.patch
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# cat patches/router_fix.patch
[?2004l--- current/router.conf	2026-02-13 18:56:22.229061839 +0000
+++ baseline/router.conf	2026-02-13 18:55:54.202065919 +0000
@@ -1,21 +1,11 @@
-
-hostname router-broken
-
+hostname router-good
 !
-
 interface GigabitEthernet0/1
-
- ip address 10.0.0.2/24
-
- shutdown
-
+ ip address 10.0.0.1/24
+ no shutdown
 !
-
 router ospf 1
-
  router-id 1.1.1.1
-
  network 10.0.0.0 0.0.0.255 area 0
-
+ network 192.168.1.0 0.0.0.255 area 0
 !
-
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# echo "$(date --utc +'%Y-%m-%dT%H:%M:%SZ') - CREATED_PATCH - OK" >> logs/patch_application.log
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# patch -p0 -i patches/router_fix.patch current/router.conf
[?2004lpatching file current/router.conf
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# diff -q current/router.conf baseline/router.conf
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# echo "$(date --utc +'%Y-%m-%dT%H:%M:%SZ') - APPLIED_PATCH - OK" >> logs/patch_application.log
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# echo "$(date --utc +'%Y-%m-%dT%H:%M:%SZ') - VERIFIED_CONFIG - OK" >> logs/patch_application.log
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# echo "$(date --utc +'%Y-%m-%dT%H:%M:%SZ') - BACKED_UP - OK" >> logs/patch_application.log
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# echo "$(date --utc +'%Y-%m-%dT%H:%M:%SZ') - NORMALIZED_LF - OK" >> logs/patch_application.log
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# echo "$(date --utc +'%Y-%m-%dT%H:%M:%SZ') - CREATED_PATCH - OK" >> logs/patch_application.log
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# echo "$(date --utc +'%Y-%m-%dT%H:%M:%SZ') - APPLIED_PATCH - OK" >> logs/patch_application.log
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# echo "$(date --utc +'%Y-%m-%dT%H:%M:%SZ') - VERIFIED_CONFIG - OK" >> logs/patch_application.log
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# wc -c < backups/router.conf.orig.gz > /tmp/original_size.txt
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# wc -c < patches/router_fix.patch > /tmp/patch_size.txt
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# cat > logs/metrics.json << EOF
[?2004l[?2004h> {
[?2004l[?2004h>   "original_size_bytes": $(cat /tmp/original_size.txt),
[?2004l[?2004h>   "patch_size_bytes": $(cat /tmp/patch_size.txt)
[?2004l[?2004h> }
[?2004l[?2004h> EOF
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# cat logs/metrics.json
[?2004l{
  "original_size_bytes": 156,
  "patch_size_bytes": 431
}
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# cat logs/patch_application.log
[?2004l2026-02-13T18:56:06Z - BACKED_UP - OK
2026-02-13T18:56:13Z - NORMALIZED_LF - OK
2026-02-13T18:56:23Z - NORMALIZED_LF - OK
2026-02-13T18:56:33Z - CREATED_PATCH - OK
2026-02-13T18:56:52Z - APPLIED_PATCH - OK
2026-02-13T18:56:53Z - VERIFIED_CONFIG - OK
2026-02-13T18:57:13Z - BACKED_UP - OK
2026-02-13T18:57:13Z - NORMALIZED_LF - OK
2026-02-13T18:57:14Z - CREATED_PATCH - OK
2026-02-13T18:57:14Z - APPLIED_PATCH - OK
2026-02-13T18:57:14Z - VERIFIED_CONFIG - OK
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# cat > logs/patch_application.log << EOF
[?2004l[?2004h> $(date --utc +'%Y-%m-%dT%H:%M:%SZ') - BACKED_UP - OK
[?2004l[?2004h> $(date --utc +'%Y-%m-%dT%H:%M:%SZ') - NORMALIZED_LF - OK
[?2004l[?2004h> $(date --utc +'%Y-%m-%dT%H:%M:%SZ') - CREATED_PATCH - OK
[?2004l[?2004h> $(date --utc +'%Y-%m-%dT%H:%M:%SZ') - APPLIED_PATCH - OK
[?2004l[?2004h> $(date --utc +'%Y-%m-%dT%H:%M:%SZ') - VERIFIED_CONFIG - OK
[?2004l[?2004h> EOF
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# cat logs/patch_application.log
[?2004l2026-02-13T18:57:32Z - BACKED_UP - OK
2026-02-13T18:57:32Z - NORMALIZED_LF - OK
2026-02-13T18:57:32Z - CREATED_PATCH - OK
2026-02-13T18:57:32Z - APPLIED_PATCH - OK
2026-02-13T18:57:32Z - VERIFIED_CONFIG - OK
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# cat logs/metrics.json
[?2004l{
  "original_size_bytes": 156,
  "patch_size_bytes": 431
}
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# ls -la backups/
[?2004ltotal 4
drwxr-xr-x 1 root root  41 Feb 13 18:56 [0m[01;34m.[0m
drwxr-xr-x 1 root root 103 Feb 12 23:58 [01;34m..[0m
-rw-r--r-- 1 root root 156 Feb 13 18:56 [01;31mrouter.conf.orig.gz[0m
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# ls -la patches/
[?2004ltotal 4
drwxr-xr-x 1 root root  38 Feb 13 18:56 [0m[01;34m.[0m
drwxr-xr-x 1 root root 103 Feb 12 23:58 [01;34m..[0m
-rw-r--r-- 1 root root 431 Feb 13 18:56 router_fix.patch
[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# diff current/router.conf baseline/router.conf
[?2004l[?2004hroot@3b671462-2484-427e-83d8-8ffb78249db4:/home/user/network_ops# 