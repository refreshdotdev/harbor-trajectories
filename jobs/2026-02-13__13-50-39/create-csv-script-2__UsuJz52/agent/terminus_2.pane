[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:~# asciinema rec --stdin /logs/agent/recording.cast
[?2004l[0;32masciinema: recording asciicast to /logs/agent/recording.cast[0m
[0;32masciinema: press <ctrl-d> or type "exit" when you're done[0m
[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:~# clear
[?2004l[H[J[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:~# cd /home/user/inventory
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# ls -la
[?2004ltotal 4
drwxr-xr-x 1 user user  62 Feb 13 00:00 [0m[01;34m.[0m
drwxr-xr-x 1 user user  94 Feb 13 00:00 [01;34m..[0m
-rw-r--r-- 1 user user   0 Feb 13 00:00 legacy_map.conf
-rw-r--r-- 1 user user 285 Oct 25  2023 ssh_audit.csv
[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# cat legacy_map.conf
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# head -5 ssh_audit.csv
[?2004lserverName,port,permitRootLogin,protocol,owner,extra
alpha,22,yes,2,admin,none
beta,2222,no,1,rené,deprecated
  # This is a indented comment
gamma,22,prohibit-password,2,müller,ok
[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# iconv -f ISO-8859-1 -t UTF-8 ssh_audit.csv > ssh_audit_utf8.csv
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# grep -v '^\s*#' ssh_audit_utf8.csv | tr -d '
[?2004l[?2004h> ' > filtered_csv.csv
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# awk -F, 'NR>1 && $4=="2" {print}' filtered_csv.csv > protocol_filtered.csv
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# awk -F, 'BEGIN {OFS="|"} {if ($3=="prohibit-password") $3="without-password"; if ($3=="forced-commands-only") $3="no"; print $1, $3}' protocol_filtered.csv > ssh_root_status.txt
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# unix2dos ssh_root_status.txt
[?2004lunix2dos: converting file ssh_root_status.txt to DOS format...
[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# sort -k1,1 ssh_root_status.txt > ssh_root_status_sorted.txt
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# mv ssh_root_status_sorted.txt ssh_root_status.txt
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# awk -F, '{print $2 "\t" $1 "\t" $5}' protocol_filtered.csv | sort -k1,1n -k2,2r | sed '1i#PRIORITY_LIST' > ssh_priority.txt
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# iconv -t UTF-16LE ssh_priority.txt > ssh_priority.tsv
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# wc -l < ssh_root_status.txt > line_count.txt
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# valid_records=$(cat line_count.txt)
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# echo "{valid_records:0,legacy_nodes_detected:0}" > audit_manifest.json
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# timestamp=$(stat -c %y ssh_audit.csv | cut -c1-19 | tr ' ' 'T')Z
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# mkdir -p /home/user/task_logs
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# echo "$timestamp awk -F, 'BEGIN {OFS=\"|\"} {if ($3==\"prohibit-password\") $3=\"without-password\"; if ($3==\"forced-commands-only\") $3=\"no\"; print $1, $3}' protocol_filtered.csv" >> /home/user/task_logs/column_manipulation.log
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# echo "$timestamp awk -F, '{print $2 \"\t\" $1 \"\t\" $5}' protocol_filtered.csv | sort -k1,1n -k2,2r | sed '1i#PRIORITY_LIST'" >> /home/user/task_logs/column_manipulation.log
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# echo "$timestamp echo \"{valid_records:$(wc -l < ssh_root_status.txt),legacy_nodes_detected:0}\" > audit_manifest.json" >> /home/user/task_logs/column_manipulation.log
[?2004l[?2004hroot@08463872-d0a1-4734-92cf-c2e60ddcb9b9:/home/user/inventory# 