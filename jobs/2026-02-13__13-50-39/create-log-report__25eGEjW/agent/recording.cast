{"version": 2, "width": 160, "height": 40, "timestamp": 1771009565, "env": {"SHELL": "/bin/bash", "TERM": "screen"}}
[0.005893, "o", "\u001b[?2004hroot@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:~# "]
[1.118844, "i", "clear\r"]
[1.11904, "o", "clear\r\n\u001b[?2004l\r"]
[1.120025, "o", "\u001b[H\u001b[J"]
[1.120181, "o", "\u001b[?2004h"]
[1.120197, "o", "root@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:~# "]
[20.467989, "i", "mkdir -p /home/user/datasets/organized/png_large /home/user/datasets/organized/jpg_old /home/user/datasets/organized/misc_small\n"]
[20.468391, "o", "mkdir -p /home/user/datasets/organized/png_large /home/user/datasets/organized/jpg_old /home/user/datasets/organized/misc_small\r\n\u001b[?2004l\r"]
[20.470681, "o", "\u001b[?2004hroot@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:~# "]
[20.684542, "i", "touch /home/user/datasets/organized/organize_log.tsv\n"]
[20.68472, "o", "touch /home/user/datasets/organized/organize_log.tsv\r\n\u001b[?2004l\r"]
[20.686066, "o", "\u001b[?2004h"]
[20.686116, "o", "root@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:~# "]
[20.828564, "i", "cat > /home/user/datasets/organized/summary.json << EOF\n{\n  \"moved_count\": 0,\n  \"copied_count\": 0,\n  \"total_bytes\": 0\n}\nEOF\n"]
[20.828757, "o", "cat > /home/user/datasets/organized/summary.json << EOF\r\n\u001b[?2004l\r"]
[20.828813, "o", "\u001b[?2004h"]
[20.828838, "o", "> {\r\n\u001b[?2004l\r"]
[20.828901, "o", "\u001b[?2004h> "]
[20.828968, "o", "  \"moved_count\": 0,\r\n\u001b[?2004l\r\u001b[?2004h> "]
[20.829012, "o", "  \"copied_count\": 0,\r\n\u001b[?2004l\r"]
[20.829049, "o", "\u001b[?2004h> "]
[20.829096, "o", "  \"total_bytes\": 0\r\n\u001b[?2004l\r"]
[20.829126, "o", "\u001b[?2004h> }\r\n\u001b[?2004l\r"]
[20.829166, "o", "\u001b[?2004h> EOF\r\n\u001b[?2004l\r"]
[20.830695, "o", "\u001b[?2004hroot@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:~# "]
[20.970282, "i", "cd /home/user\n"]
[20.970418, "o", "cd /home/user\r\n\u001b[?2004l\r"]
[20.970528, "o", "\u001b[?2004hroot@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[87.457672, "i", "find /home/user/datasets/raw -type f -print0 | sort -z > /tmp/sorted_files.txt\n"]
[87.457936, "o", "find /home/user/datasets/raw -type f -print0 | sort -z > /tmp/sorted_files.txt\r\n\u001b[?2004l\r"]
[87.460045, "o", "\u001b[?2004h"]
[87.460066, "o", "root@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[88.14447, "i", "while IFS= read -r -d '' source_file; do\n  # Skip broken symbolic links (ls -L dereferences, -H prevents infinite recursion)\n  if [ ! -L \"${source_file}\" ] || [ ! -e \"$(ls -L \"${source_file}\" 2>/dev/null)\" ]; then\n    echo \"Skipping broken link: ${source_file}\"\n    continue\n  fi\n\n  # Skip files with permission mode 000\n  if [ \"$(stat -c '%a' \"${source_file}\")\" = \"000\" ]; then\n    echo \"Skipping file with 000 permissions: ${source_file}\"\n    continue\n  fi\n\n  ABS_DEST_PATH=\"\"\n  SIZE_BYTES=\"\"\n  MTIME_EPOCH=\"\"\n  MD5_HASH=\"\"\n  LOG_LINE=\"\"\n  FILE_MOVED=0\n  FILE_COPIED=0\n\n  # Rule 1: png_large (Move every *.png file strictly larger than 1,000,000 bytes)\n  if [ \"$(basename \"${source_file}\" | grep -E '\\.png$')\" ]; then\n    fsize=$(stat -c%s \"${source_file}\")\n    if [ ${fsize} -gt 1000000 ]; then\n      BASENAME=$(basename \"${source_file}\")\n      DEST_DIR=\"/home/user/datasets/organized/png_large\"\n      TARGET_PATH=\"${DEST_DIR}/${BASENAME}\"\n      COUNTER=1\n      while [ -e \"${TARGET_PATH}\" ]; do\n        PARENT_DIR_NAME=$"]
[88.144514, "i", "(basename \"$(dirname \"${source_file}\")\")\n        TARGET_PATH=\"${DEST_DIR}/${BASENAME%.png}_${PARENT_DIR_NAME}.png\"\n        COUNTER=$((COUNTER+1))\n        if [ ${COUNTER} -gt 1 ]; then TARGET_PATH=\"${TARGET_PATH%.png}_${COUNTER}.png\"; fi\n      done\n      ABS_DEST_PATH=\"${TARGET_PATH}\"\n      mv \"${source_file}\" \"${ABS_DEST_PATH}\"\n      SIZE_BYTES=$(stat -c%s \"${ABS_DEST_PATH}\")\n      MTIME_EPOCH=$(stat -c%Y \"${ABS_DEST_PATH}\")\n      MD5_HASH=$(md5sum \"${ABS_DEST_PATH}\" | awk '{print $1}')\n      LOG_LINE=\"${source_file}\\t${ABS_DEST_PATH}\\t${SIZE_BYTES}\\t${MTIME_EPOCH}\\t${MD5_HASH}\"\n      FILE_MOVED=1\n    fi\n  fi\n\n  # Rule 2: jpg_old (Copy every *.jpg file with mtime strictly before Unix Epoch 1625097600)\n  if [ ${FILE_MOVED} -eq 0 ]; then\n    if [ \"$(basename \"${source_file}\" | grep -E '\\.jpg$')\" ]; then\n      MTIME_SRC=$(stat -c%Y \"${source_file}\")\n      if [ ${MTIME_SRC} -lt 1625097600 ]; then\n        BASENAME=$(basename \"${source_file}\")\n        DEST_DIR=\"/home/user/datasets/organized/jpg_old\"\n        TARGET_"]
[88.144525, "i", "PATH=\"${DEST_DIR}/${BASENAME}\"\n        COUNTER=1\n        while [ -e \"${TARGET_PATH}\" ]; do\n          PARENT_DIR_NAME=$(basename \"$(dirname \"${source_file}\")\")\n          TARGET_PATH=\"${DEST_DIR}/${BASENAME%.jpg}_${PARENT_DIR_NAME}.jpg\"\n          COUNTER=$((COUNTER+1))\n          if [ ${COUNTER} -gt 1 ]; then TARGET_PATH=\"${TARGET_PATH%.jpg}_${COUNTER}.jpg\"; fi\n        done\n        ABS_DEST_PATH=\"${TARGET_PATH}\"\n        cp -p \"${source_file}\" \"${ABS_DEST_PATH}\"\n        SIZE_BYTES=$(stat -c%s \"${ABS_DEST_PATH}\")\n        MTIME_EPOCH=$(stat -c%Y \"${ABS_DEST_PATH}\")\n        MD5_HASH=$(md5sum \"${ABS_DEST_PATH}\" | awk '{print $1}')\n        LOG_LINE=\"${source_file}\\t${ABS_DEST_PATH}\\t${SIZE_BYTES}\\t${MTIME_EPOCH}\\t${MD5_HASH}\"\n        FILE_COPIED=1\n      fi\n    fi\n  fi\n\n  # Rule 3: misc_small (Copy every remaining regular file <= 512,000 bytes AND not .txt)\n  if [ ${FILE_MOVED} -eq 0 ] && [ ${FILE_COPIED} -eq 0 ]; then\n    if [ ! \"$(basename \"${source_file}\" | grep -E '\\.txt$')\" ] && [ $(stat -c%s \"${source_file}\") -le"]
[88.144534, "i", " 512000 ]; then\n      BASENAME=$(basename \"${source_file}\")\n      DEST_DIR=\"/home/user/datasets/organized/misc_small\"\n      TARGET_PATH=\"${DEST_DIR}/${BASENAME}\"\n      COUNTER=1\n      while [ -e \"${TARGET_PATH}\" ]; do\n        PARENT_DIR_NAME=$(basename \"$(dirname \"${source_file}\")\")\n        TARGET_PATH=\"${DEST_DIR}/${BASENAME%.*}_${PARENT_DIR_NAME}.${BASENAME##*.}\"\n        COUNTER=$((COUNTER+1))\n        if [ ${COUNTER} -gt 1 ]; then TARGET_PATH=\"${TARGET_PATH%.*}_${COUNTER}.${BASENAME##*.}\"; fi\n      done\n      ABS_DEST_PATH=\"${TARGET_PATH}\"\n      cp -p \"${source_file}\" \"${ABS_DEST_PATH}\"\n      SIZE_BYTES=$(stat -c%s \"${ABS_DEST_PATH}\")\n      MTIME_EPOCH=$(stat -c%Y \"${ABS_DEST_PATH}\")\n      MD5_HASH=$(md5sum \"${ABS_DEST_PATH}\" | awk '{print $1}')\n      LOG_LINE=\"${source_file}\\t${ABS_DEST_PATH}\\t${SIZE_BYTES}\\t${MTIME_EPOCH}\\t${MD5_HASH}\"\n      FILE_COPIED=1\n    fi\n  fi\n\n  if [ -n \"${LOG_LINE}\" ]; then\n    echo \"${LOG_LINE}\" >> /home/user/datasets/organized/organize_log.tsv\n    if [ ${FILE_MOVED} -eq 1 ]; th"]
[88.144657, "i", "en\n      MOVED_COUNT=$(jq '.moved_count += 1' /home/user/datasets/organized/summary.json)\n      jq '.moved_count += 1' /home/user/datasets/organized/summary.json | sponge /home/user/datasets/organized/summary.json\n    fi\n    if [ ${FILE_COPIED} -eq 1 ]; then\n      COPIED_COUNT=$(jq '.copied_count += 1' /home/user/datasets/organized/summary.json)\n      jq '.copied_count += 1' /home/user/datasets/organized/summary.json | sponge /home/user/datasets/organized/summary.json\n    fi\n  fi\ndone < /tmp/sorted_files.txt\n"]
[88.144773, "o", "while IFS= read -r -d '' source_file; do\r\n\u001b[?2004l\ren\r\n      MOVED_COUNT=$(jq '.moved_count \u001b[?2004h> "]
[88.145004, "o", "  # Skip broken symbolic links (ls -L dereferences, -H prevents infinite recursion)\r\n\u001b[?2004l\r"]
[88.145016, "o", "\u001b[?2004h"]
[88.145025, "o", "> "]
[88.145362, "o", "  if [ ! -L \"${source_file}\" ] || [ ! -e \"$(ls -L \"${source_file}\" 2>/dev/null)\" ]; then\r\n\u001b[?2004l\r"]
[88.145447, "o", "\u001b[?2004h> "]
[88.14556, "o", "    echo \"Skipping broken link: ${source_file}\"\r\n\u001b[?2004l\r"]
[88.145574, "o", "\u001b[?2004h> "]
[88.145629, "o", "    continue\r\n"]
[88.145642, "o", "\u001b[?2004l\r"]
[88.145691, "o", "\u001b[?2004h>   fi\r\n\u001b[?2004l\r\u001b[?2004h"]
[88.145703, "o", "> \r\n\u001b[?2004l\r"]
[88.145751, "o", "(\u001b[?2004h> "]
[88.145859, "o", "  # Skip files with permission mode 000\r\n\u001b[?2004l\r"]
[88.145903, "o", "\u001b[?2004h> "]
[88.146086, "o", "  if [ \"$(stat -c '%a' \"${source_file}\")\" = \"000\" ]; then\r\n\u001b[?2004l\r"]
[88.146133, "o", "\u001b[?2004h> "]
[88.146341, "o", "    echo \"Skipping file with 000 permissions: ${source_file}\"\r\n\u001b[?2004l\r"]
[88.146354, "o", "\u001b[?2004h"]
[88.146415, "o", ">     continue\r\n\u001b[?2004l\r"]
[88.146427, "o", "\u001b[?2004h> "]
[88.146476, "o", "  fi\r\n\u001b[?2004l\r\u001b[?2004h> \r\n\u001b[?2004l\rd"]
[88.146487, "o", "\u001b[?2004h"]
[88.146539, "o", "> "]
[88.146581, "o", "  ABS_DEST_PATH=\"\"\r\n\u001b[?2004l\r\u001b[?2004h"]
[88.146593, "o", "> "]
[88.146641, "o", "  SIZE_BYTES=\"\"\r\n\u001b[?2004l\r"]
[88.146653, "o", "\u001b[?2004h"]
[88.146705, "o", "> "]
[88.146717, "o", "  MTIME_EPOCH=\"\"\r\n\u001b[?2004l\r"]
[88.146765, "o", "\u001b[?2004h> "]
[88.146806, "o", "  MD5_HASH=\"\"\r\n\u001b[?2004l\r\u001b[?2004h> "]
[88.146847, "o", "  LOG_LINE=\"\"\r\n\u001b[?2004l\r"]
[88.146859, "o", "\u001b[?2004h"]
[88.146906, "o", ">   FILE_MOVED=0\r\n\u001b[?2004l\r"]
[88.146945, "o", "\u001b[?2004h"]
[88.146985, "o", "> "]
[88.147026, "o", "  FILE_COPIED=0\r\n\u001b[?2004l\r\u001b[?2004h> \r\n\u001b[?2004l\r"]
[88.14707, "o", "\u001b[?2004h> "]
[88.147259, "o", "  # Rule 1: png_large (Move every *.png file strictly larger than 1,000,000 bytes)\r\n\u001b[?2004l\r\u001b[?2004h> "]
[88.147541, "o", "  if [ \"$(basename \"${source_file}\" | grep -E '\\.png$')\" ]; then\r\n\u001b[?2004l\r\u001b[?2004h> "]
[88.147656, "o", "    fsize=$(stat -c%s \"${source_file}\")\r\n\u001b[?2004l\r\u001b[?2004h> "]
[88.147769, "o", "    if [ ${fsize} -gt 1000000 ]; then\r\n\u001b[?2004l\r\u001b[?2004h> "]
[88.147878, "o", "      BASENAME=$(basename \"${source_file}\")\r\n\u001b[?2004l\r"]
[88.147928, "o", "\u001b[?2004h> "]
[88.148043, "o", "      DEST_DIR=\"/home/user/datasets/organized/png_large\"\r\n\u001b[?2004l\r"]
[88.148066, "o", "\u001b[?2004h> "]
[88.148187, "o", "      TARGET_PATH=\"${DEST_DIR}/${BASENAME}\"\r\n\u001b[?2004l\r"]
[88.14824, "o", "\u001b[?2004h> "]
[88.148285, "o", "      COUNTER=1\r\n\u001b[?2004l\r\u001b[?2004h"]
[88.1483, "o", "> "]
[88.148422, "o", "      while [ -e \"${TARGET_PATH}\" ]; do\r\n\u001b[?2004l\r"]
[88.148464, "o", "\u001b[?2004h> "]
[88.148616, "o", "        PARENT_DIR_NAME=$(basename \"$(dirname \"${source_file}\")\")\r\n\u001b[?2004l\r"]
[88.148647, "o", "\u001b[?2004h"]
[88.148681, "o", "> "]
[88.148844, "o", "        TARGET_PATH=\"${DEST_DIR}/${BASENAME%.png}_${PARENT_DIR_NAME}.png\"\r\n\u001b[?2004l\r"]
[88.148878, "o", "\u001b[?2004h> "]
[88.148953, "o", "        COUNTER=$((COUNTER+1))\r\n\u001b[?2004l\r"]
[88.148984, "o", "\u001b[?2004h"]
[88.149016, "o", "> "]
[88.149213, "o", "        if [ ${COUNTER} -gt 1 ]; then TARGET_PATH=\"${TARGET_PATH%.png}_${COUNTER}.png\"; fi\r\n\u001b[?2004l\r"]
[88.149249, "o", "\u001b[?2004h> "]
[88.149277, "o", "      done\r\n\u001b[?2004l\r"]
[88.149311, "o", "\u001b[?2004h> "]
[88.149419, "o", "      ABS_DEST_PATH=\"${TARGET_PATH}\"\r\n\u001b[?2004l\r"]
[88.14946, "o", "\u001b[?2004h> "]
[88.149556, "o", "      mv \"${source_file}\" \"${ABS_DEST_PATH}\"\r\n\u001b[?2004l\r"]
[88.149612, "o", "\u001b[?2004h> "]
[88.149705, "o", "      SIZE_BYTES=$(stat -c%s \"${ABS_DEST_PATH}\")\r\n\u001b[?2004l\r"]
[88.149715, "o", "\u001b[?2004h"]
[88.149765, "o", "> "]
[88.149851, "o", "      MTIME_EPOCH=$(stat -c%Y \"${ABS_DEST_PATH}\")\r\n\u001b[?2004l\r"]
[88.149892, "o", "\u001b[?2004h> "]
[88.150035, "o", "      MD5_HASH=$(md5sum \"${ABS_DEST_PATH}\" | awk '{print $1}')\r\n\u001b[?2004l\r"]
[88.150069, "o", "\u001b[?2004h> "]
[88.150306, "o", "      LOG_LINE=\"${source_file}\\t${ABS_DEST_PATH}\\t${SIZE_BYTES}\\t${MTIME_EPOCH}\\t${MD5_HASH}\"\r\n\u001b[?2004l\r"]
[88.150339, "o", "\u001b[?2004h> "]
[88.150402, "o", "      FILE_MOVED=1\r\n\u001b[?2004l\r"]
[88.150435, "o", "\u001b[?2004h> "]
[88.150472, "o", "    fi\r\n\u001b[?2004l\r\u001b[?2004h"]
[88.150532, "o", ">   fi\r\n\u001b[?2004l\r"]
[88.150543, "o", "\u001b[?2004h"]
[88.1506, "o", "> \r\n\u001b[?2004l\r\u001b[?2004h> "]
[88.150809, "o", "  # Rule 2: jpg_old (Copy every *.jpg file with mtime strictly before Unix Epoch 1625097600)\r\n\u001b[?2004l\r"]
[88.150853, "o", "\u001b[?2004h> "]
[88.150925, "o", "  if [ ${FILE_MOVED} -eq 0 ]; then\r\n\u001b[?2004l\r"]
[88.150963, "o", "\u001b[?2004h> "]
[88.15112, "o", "    if [ \"$(basename \"${source_file}\" | grep -E '\\.jpg$')\" ]; then\r\n\u001b[?2004l\r"]
[88.151159, "o", "\u001b[?2004h> "]
[88.151279, "o", "      MTIME_SRC=$(stat -c%Y \"${source_file}\")\r\n\u001b[?2004l\r"]
[88.151365, "o", "\u001b[?2004h> "]
[88.151452, "o", "      if [ ${MTIME_SRC} -lt 1625097600 ]; then\r\n\u001b[?2004l\r"]
[88.151511, "o", "\u001b[?2004h> "]
[88.151591, "o", "        BASENAME=$(basename \"${source_file}\")\r\n\u001b[?2004l\r"]
[88.151652, "o", "\u001b[?2004h> "]
[88.151757, "o", "        DEST_DIR=\"/home/user/datasets/organized/jpg_old\"\r\n\u001b[?2004l\r"]
[88.151804, "o", "\u001b[?2004h> "]
[88.151896, "o", "        TARGET_PATH=\"${DEST_DIR}/${BASENAME}\"\r\n\u001b[?2004l\r"]
[88.151945, "o", "\u001b[?2004h> "]
[88.151995, "o", "        COUNTER=1\r\n\u001b[?2004l\r\u001b[?2004h> "]
[88.152098, "o", "        while [ -e \"${TARGET_PATH}\" ]; do\r\n\u001b[?2004l\r"]
[88.152148, "o", "\u001b[?2004h> "]
[88.152291, "o", "          PARENT_DIR_NAME=$(basename \"$(dirname \"${source_file}\")\")\r\n\u001b[?2004l\r"]
[88.152343, "o", "\u001b[?2004h> "]
[88.152525, "o", "          TARGET_PATH=\"${DEST_DIR}/${BASENAME%.jpg}_${PARENT_DIR_NAME}.jpg\"\r\n\u001b[?2004l\r"]
[88.152573, "o", "\u001b[?2004h> "]
[88.152642, "o", "          COUNTER=$((COUNTER+1))\r\n\u001b[?2004l\r\u001b[?2004h"]
[88.152688, "o", "> "]
[88.152891, "o", "          if [ ${COUNTER} -gt 1 ]; then TARGET_PATH=\"${TARGET_PATH%.jpg}_${COUNTER}.jpg\"; fi\r\n\u001b[?2004l\r"]
[88.152938, "o", "\u001b[?2004h> "]
[88.152995, "o", "        done\r\n\u001b[?2004l\r\u001b[?2004h> "]
[88.153074, "o", "        ABS_DEST_PATH=\"${TARGET_PATH}\"\r\n\u001b[?2004l\r"]
[88.153121, "o", "\u001b[?2004h> "]
[88.153222, "o", "        cp -p \"${source_file}\" \"${ABS_DEST_PATH}\"\r\n\u001b[?2004l\r"]
[88.153267, "o", "\u001b[?2004h> "]
[88.153389, "o", "        SIZE_BYTES=$(stat -c%s \"${ABS_DEST_PATH}\")\r\n\u001b[?2004l\r\u001b[?2004h"]
[88.153435, "o", "> "]
[88.153533, "o", "        MTIME_EPOCH=$(stat -c%Y \"${ABS_DEST_PATH}\")\r\n\u001b[?2004l\r"]
[88.153583, "o", "\u001b[?2004h> "]
[88.153719, "o", "        MD5_HASH=$(md5sum \"${ABS_DEST_PATH}\" | awk '{print $1}')\r\n\u001b[?2004l\r"]
[88.153768, "o", "\u001b[?2004h> "]
[88.153982, "o", "        LOG_LINE=\"${source_file}\\t${ABS_DEST_PATH}\\t${SIZE_BYTES}\\t${MTIME_EPOCH}\\t${MD5_HASH}\"\r\n\u001b[?2004l\r"]
[88.154028, "o", "\u001b[?2004h> "]
[88.154074, "o", "        FILE_COPIED=1\r\n\u001b[?2004l\r"]
[88.154116, "o", "\u001b[?2004h>       fi\r\n\u001b[?2004l\r"]
[88.154164, "o", "\u001b[?2004h>     fi\r\n\u001b[?2004l\r"]
[88.154233, "o", "\u001b[?2004h>   fi\r\n\u001b[?2004l\r\u001b[?2004h> \r\n\u001b[?2004l\r"]
[88.154276, "o", "\u001b[?2004h> "]
[88.154517, "o", "  # Rule 3: misc_small (Copy every remaining regular file <= 512,000 bytes AND not .txt)\r\n\u001b[?2004l\r"]
[88.154578, "o", "\u001b[?2004h> "]
[88.154704, "o", "  if [ ${FILE_MOVED} -eq 0 ] && [ ${FILE_COPIED} -eq 0 ]; then\r\n\u001b[?2004l\r"]
[88.154752, "o", "\u001b[?2004h> "]
[88.15501, "o", "    if [ ! \"$(basename \"${source_file}\" | grep -E '\\.txt$')\" ] && [ $(stat -c%s \"${source_file}\") -le 512000 ]; then\r\n\u001b[?2004l\r"]
[88.155059, "o", "\u001b[?2004h> "]
[88.155165, "o", "      BASENAME=$(basename \"${source_file}\")\r\n\u001b[?2004l\r\u001b[?2004h"]
[88.155212, "o", "> "]
[88.155331, "o", "      DEST_DIR=\"/home/user/datasets/organized/misc_small\"\r\n\u001b[?2004l\r"]
[88.155401, "o", "\u001b[?2004h> "]
[88.155483, "o", "      TARGET_PATH=\"${DEST_DIR}/${BASENAME}\"\r\n\u001b[?2004l\r\u001b[?2004h> "]
[88.155537, "o", "      COUNTER=1\r\n\u001b[?2004l\r"]
[88.155591, "o", "\u001b[?2004h> "]
[88.155661, "o", "      while [ -e \"${TARGET_PATH}\" ]; do\r\n\u001b[?2004l\r"]
[88.155708, "o", "\u001b[?2004h> "]
[88.155849, "o", "        PARENT_DIR_NAME=$(basename \"$(dirname \"${source_file}\")\")\r\n\u001b[?2004l\r"]
[88.155896, "o", "\u001b[?2004h> "]
[88.156087, "o", "        TARGET_PATH=\"${DEST_DIR}/${BASENAME%.*}_${PARENT_DIR_NAME}.${BASENAME##*.}\"\r\n\u001b[?2004l\r"]
[88.156134, "o", "\u001b[?2004h> "]
[88.156222, "o", "        COUNTER=$((COUNTER+1))\r\n\u001b[?2004l\r"]
[88.15627, "o", "\u001b[?2004h> "]
[88.156523, "o", "        if [ ${COUNTER} -gt 1 ]; then TARGET_PATH=\"${TARGET_PATH%.*}_${COUNTER}.${BASENAME##*.}\"; fi\r\n\u001b[?2004l\r\u001b[?2004h"]
[88.156577, "o", ">       done\r\n\u001b[?2004l\r\u001b[?2004h"]
[88.156641, "o", "> "]
[88.156691, "o", "      ABS_DEST_PATH=\"${TARGET_PATH}\"\r\n\u001b[?2004l\r\u001b[?2004h"]
[88.156734, "o", "> "]
[88.156834, "o", "      cp -p \"${source_file}\" \"${ABS_DEST_PATH}\"\r\n\u001b[?2004l\r\u001b[?2004h"]
[88.156891, "o", "> "]
[88.156977, "o", "      SIZE_BYTES=$(stat -c%s \"${ABS_DEST_PATH}\")\r\n\u001b[?2004l\r"]
[88.157023, "o", "\u001b[?2004h> "]
[88.157126, "o", "      MTIME_EPOCH=$(stat -c%Y \"${ABS_DEST_PATH}\")\r\n\u001b[?2004l\r"]
[88.157171, "o", "\u001b[?2004h> "]
[88.157307, "o", "      MD5_HASH=$(md5sum \"${ABS_DEST_PATH}\" | awk '{print $1}')\r\n\u001b[?2004l\r"]
[88.157354, "o", "\u001b[?2004h> "]
[88.157569, "o", "      LOG_LINE=\"${source_file}\\t${ABS_DEST_PATH}\\t${SIZE_BYTES}\\t${MTIME_EPOCH}\\t${MD5_HASH}\"\r\n\u001b[?2004l\r"]
[88.157628, "o", "\u001b[?2004h> "]
[88.157671, "o", "      FILE_COPIED=1\r\n\u001b[?2004l\r\u001b[?2004h> "]
[88.157714, "o", "    fi\r\n\u001b[?2004l\r\u001b[?2004h> "]
[88.15776, "o", "  fi\r\n\u001b[?2004l\r\u001b[?2004h> \r\n\u001b[?2004l\r"]
[88.157805, "o", "\u001b[?2004h> "]
[88.157871, "o", "  if [ -n \"${LOG_LINE}\" ]; then\r\n\u001b[?2004l\r"]
[88.157928, "o", "\u001b[?2004h> "]
[88.158075, "o", "    echo \"${LOG_LINE}\" >> /home/user/datasets/organized/organize_log.tsv\r\n\u001b[?2004l\r"]
[88.15813, "o", "\u001b[?2004h> "]
[88.158197, "o", "    if [ ${FILE_MOVED} -eq 1 ]; then\r\n\u001b[?2004l\r"]
[88.158254, "o", "\u001b[?2004h> "]
[88.15845, "o", "      MOVED_COUNT=$(jq '.moved_count += 1' /home/user/datasets/organized/summary.json)\r\n\u001b[?2004l\r"]
[88.158508, "o", "\u001b[?2004h> "]
[88.158781, "o", "      jq '.moved_count += 1' /home/user/datasets/organized/summary.json | sponge /home/user/datasets/organized/summary.json\r\n\u001b[?2004l\r"]
[88.158826, "o", "\u001b[?2004h>     fi\r\n\u001b[?2004l\r"]
[88.158888, "o", "\u001b[?2004h> "]
[88.158945, "o", "    if [ ${FILE_COPIED} -eq 1 ]; then\r\n\u001b[?2004l\r"]
[88.159005, "o", "\u001b[?2004h> "]
[88.159198, "o", "      COPIED_COUNT=$(jq '.copied_count += 1' /home/user/datasets/organized/summary.json)\r\n\u001b[?2004l\r"]
[88.159254, "o", "\u001b[?2004h> "]
[88.15957, "o", "      jq '.copied_count += 1' /home/user/datasets/organized/summary.json | sponge /home/user/datasets/organized/summary.json\r\n\u001b[?2004l\r"]
[88.159624, "o", "\u001b[?2004h>     fi\r\n\u001b[?2004l\r"]
[88.159668, "o", "\u001b[?2004h>   fi\r\n\u001b[?2004l\r"]
[88.159711, "o", "\u001b[?2004h> "]
[88.159779, "o", "done < /tmp/sorted_files.txt\r\n\u001b[?2004l\r"]
[88.159897, "o", "Skipping broken link: /home/user/datasets/raw/orphan.jpg\r\n"]
[88.159959, "o", "Skipping broken link: /home/user/datasets/raw/projectA/img1.png\r\n"]
[88.160022, "o", "Skipping broken link: /home/user/datasets/raw/projectA/img2.png\r\n"]
[88.160086, "o", "Skipping broken link: /home/user/datasets/raw/projectA/note.txt\r\n"]
[88.160154, "o", "Skipping broken link: /home/user/datasets/raw/projectA/old1.jpg\r\n"]
[88.160234, "o", "Skipping broken link: /home/user/datasets/raw/projectB/big_graph.png\r\n"]
[88.160306, "o", "Skipping broken link: /home/user/datasets/raw/projectB/img1.png\r\n"]
[88.160391, "o", "Skipping broken link: /home/user/datasets/raw/projectB/locked.dat\r\n"]
[88.160448, "o", "Skipping broken link: /home/user/datasets/raw/projectB/recent.jpg\r\n"]
[88.160496, "o", "Skipping broken link: /home/user/datasets/raw/projectB/tiny.dat\r\n"]
[88.160542, "o", "Skipping broken link: /home/user/datasets/raw/readme.md\r\n"]
[88.160585, "o", "\u001b[?2004hroot@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[109.470415, "i", "TOTAL_BYTES_SUM=0\n"]
[109.470527, "o", "TOTAL_BYTES_SUM=0\r\n\u001b[?2004l\r"]
[109.470559, "o", "\u001b[?2004h"]
[109.470583, "o", "root@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[109.587035, "i", "find /home/user/datasets/organized/png_large /home/user/datasets/organized/jpg_old /home/user/datasets/organized/misc_small -type f -printf '\\0' | xargs -0 -I {} sh -c 'SUM=$(stat -c%s \"{}\" 2>/dev/null); if [ -n \"${SUM}\" ]; then TOTAL_BYTES_SUM=$((TOTAL_BYTES_SUM + SUM)); fi' _\n"]
[109.587917, "o", "find /home/user/datasets/organized/png_large /home/user/datasets/organized/jpg_old /home/user/datasets/organized/misc_small -type f -printf '\\0' | xargs -0 -I {} sh -c 'SUM=$(stat -c%s \"{}\" 2>/dev/null); if [ -n \"${SUM}\" ]; then TOTAL_BYTES_SUM=$((TOTAL_BYTES_SUM + SUM)); fi' _\r\n\u001b[?2004l\r"]
[109.591171, "o", "\u001b[?2004h"]
[109.591218, "o", "root@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[114.596422, "i", "jq \".total_bytes = ${TOTAL_BYTES_SUM}\" /home/user/datasets/organized/summary.json | sponge /home/user/datasets/organized/summary.json\n"]
[114.597094, "o", "jq \".total_bytes = ${TOTAL_BYTES_SUM}\" /home/user/datasets/organized/summary.json | sponge /home/user/datasets/organized/summary.json\r\n"]
[114.597143, "o", "\u001b[?2004l\r"]
[114.597831, "o", "bash: sponge: command not found\r\n"]
[114.597891, "o", "bash: jq: command not found\r\n"]
[114.59822, "o", "\u001b[?2004h"]
[114.598258, "o", "root@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[115.099302, "i", "sort -o /home/user/datasets/organized/organize_log.tsv /home/user/datasets/organized/organize_log.tsv\n"]
[115.099622, "o", "sort -o /home/user/datasets/organized/organize_log.tsv /home/user/datasets/organized/organize_log.tsv\r\n\u001b[?2004l\r"]
[115.100943, "o", "\u001b[?2004h"]
[115.100975, "o", "root@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[116.121827, "i", "rm /tmp/sorted_files.txt\n"]
[116.122029, "o", "rm /tmp/sorted_files.txt\r\n\u001b[?2004l\r"]
[116.123331, "o", "\u001b[?2004hroot@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[116.294635, "i", "echo \"Task complete. Final summary:\"\n"]
[116.294957, "o", "echo \"Task complete. Final summary:\"\r\n"]
[116.295021, "o", "\u001b[?2004l\r"]
[116.295073, "o", "Task complete. Final summary:\r\n"]
[116.295122, "o", "\u001b[?2004hroot@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[116.396442, "i", "cat /home/user/datasets/organized/summary.json\n"]
[116.396922, "o", "cat /home/user/datasets/organized/summary.json\r\n"]
[116.397009, "o", "\u001b[?2004l\r"]
[116.398282, "o", "{\r\n  \"moved_count\": 0,\r\n  \"copied_count\": 0,\r\n  \"total_bytes\": 0\r\n}\r\n"]
[116.398564, "o", "\u001b[?2004h"]
[116.398598, "o", "root@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[147.069211, "i", "which jq\n"]
[147.069364, "o", "which jq\r\n\u001b[?2004l\r"]
[147.070452, "o", "\u001b[?2004hroot@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[147.293757, "i", "apt list --installed | grep -w jq\n"]
[147.293912, "o", "apt list --installed | grep -w jq\r\n\u001b[?2004l\r"]
[147.298732, "o", "\r\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.\r\n\r\n"]
[147.668907, "i", "echo \"Assuming jq is not installable or not preferred. Will calculate counts from log and total bytes manually.\" \n"]
[147.668945, "o", "echo \"Assuming jq is not installable or not preferred. Will calculate counts from log and total bytes manually.\" \r\n"]
[147.770149, "i", "MOVED_COUNT=$(grep -E '\\.png$' /home/user/datasets/organized/organize_log.tsv | wc -l)\n"]
[147.770314, "o", "MOVED_COUNT=$(grep -E '\\.png$' /home/user/datasets/organized/organize_log.tsv | wc -l)\r\n"]
[148.307433, "o", "\u001b[?2004hroot@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[148.307731, "o", "echo \"Assuming jq is not installable or not preferred. Will calculate counts from log and total bytes manually.\" \r\n\u001b[?2004l\r"]
[148.307768, "o", "Assuming jq is not installable or not preferred. Will calculate counts from log and total bytes manually.\r\n"]
[148.307804, "o", "\u001b[?2004hroot@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[148.308026, "o", "MOVED_COUNT=$(grep -E '\\.png$' /home/user/datasets/organized/organize_log.tsv | wc -l)\r\n\u001b[?2004l\r"]
[148.308894, "i", "COPIED_COUNT=$(grep -v -E '\\.png$' /home/user/datasets/organized/organize_log.tsv | wc -l)\n"]
[148.308922, "o", "COPIED_COUNT=$(grep -v -E '\\.png$' /home/user/datasets/organized/organize_log.tsv | wc -l)\r\n"]
[148.311199, "o", "\u001b[?2004h"]
[148.311248, "o", "root@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[148.311846, "o", "COPIED_COUNT=$(grep -v -E '\\.png$' /home/user/datasets/organized/organize_log.tsv | wc -l)\r\n\u001b[?2004l\r"]
[148.315014, "o", "\u001b[?2004h"]
[148.315052, "o", "root@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[148.802923, "i", "TOTAL_BYTES=0\n"]
[148.803085, "o", "TOTAL_BYTES=0\r\n\u001b[?2004l\r"]
[148.803185, "o", "\u001b[?2004h"]
[148.803227, "o", "root@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[148.918676, "i", "cat /home/user/datasets/organized/organize_log.tsv | while IFS=$'\\t' read -r orig new size mtime md5; do TOTAL_BYTES=$((TOTAL_BYTES + size)); done\n"]
[148.919445, "o", "cat /home/user/datasets/organized/organize_log.tsv | while IFS=$'\\t' read -r orig new size mtime md5; do TOTAL_BYTES=$((TOTAL_BYTES + size)); done\r\n\u001b[?2004l\r"]
[148.921175, "o", "\u001b[?2004h"]
[148.921225, "o", "root@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[149.903565, "i", "cat > /home/user/datasets/organized/summary.json << EOF\n{\n  \"moved_count\": ${MOVED_COUNT},\n  \"copied_count\": ${COPIED_COUNT},\n  \"total_bytes\": ${TOTAL_BYTES}\n}\nEOF\n"]
[149.903913, "o", "cat > /home/user/datasets/organized/summary.json << EOF\r\n\u001b[?2004l\r"]
[149.903984, "o", "\u001b[?2004h> "]
[149.904027, "o", "{\r\n\u001b[?2004l\r\u001b[?2004h"]
[149.904064, "o", "> "]
[149.904226, "o", "  \"moved_count\": ${MOVED_COUNT},\r\n\u001b[?2004l\r\u001b[?2004h"]
[149.904261, "o", "> "]
[149.904419, "o", "  \"copied_count\": ${COPIED_COUNT},\r\n\u001b[?2004l\r"]
[149.904442, "o", "\u001b[?2004h"]
[149.904509, "o", "> "]
[149.904601, "o", "  \"total_bytes\": ${TOTAL_BYTES}\r\n\u001b[?2004l\r"]
[149.904651, "o", "\u001b[?2004h> }\r\n\u001b[?2004l\r"]
[149.904696, "o", "\u001b[?2004h> "]
[149.904707, "o", "EOF\r\n"]
[149.904754, "o", "\u001b[?2004l\r"]
[149.906229, "o", "\u001b[?2004h"]
[149.906267, "o", "root@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[149.998189, "i", "echo \"Final summary (manually calculated):\"\n"]
[149.998526, "o", "echo \"Final summary (manually calculated):\"\r\n\u001b[?2004l\r"]
[149.998643, "o", "Final summary (manually calculated):\r\n\u001b[?2004h"]
[149.998655, "o", "root@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
[150.145102, "i", "cat /home/user/datasets/organized/summary.json\n"]
[150.145303, "o", "cat /home/user/datasets/organized/summary.json\r\n\u001b[?2004l\r"]
[150.146451, "o", "{\r\n  \"moved_count\": 0,\r\n  \"copied_count\": 0,\r\n  \"total_bytes\": 0\r\n}\r\n"]
[150.146774, "o", "\u001b[?2004h"]
[150.146824, "o", "root@fc3b6b1b-89a5-4d40-83c5-d146a3dc8344:/home/user# "]
