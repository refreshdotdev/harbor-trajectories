[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# asciinema rec --stdin /logs/agent/recording.cast
[?2004l[0;32masciinema: recording asciicast to /logs/agent/recording.cast[0m
[0;32masciinema: press <ctrl-d> or type "exit" when you're done[0m
[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# clear
[?2004l[H[J[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# mkdir -p /home/user/hardening_workshop && chmod 0700 /home/user/hardening_workshop
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# cp /home/user/baseline_configs/ssh/sshd_config_baseline /home/user/hardening_workshop/sshd_config_baseline && chmod 0600 /home/user/hardening_workshop/sshd_config_baseline
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# cp /home/user/baseline_configs/sysctl/sysctl_baseline.conf /home/user/hardening_workshop/sysctl_baseline.conf && chmod 0600 /home/user/hardening_workshop/sysctl_baseline.conf
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# cd /home/user/hardening_workshop
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# date -u +"%Y%m%d_W%V" | tr -d '\n'
[?2004l20260213_W07[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# tar -czf baseline_backup_${DATE_STRING}.tar.gz sshd_config_baseline sysctl_baseline.conf && chmod 0600 baseline_backup_${DATE_STRING}.tar.gz
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# grep -v -e '^#' -e '^$' /home/user/security_policies/ssh_policy.txt | tr -d '\n' > ssh_policy_clean.txt && echo '' >> ssh_policy_clean.txt
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# cat sshd_config_baseline ssh_policy_clean.txt > sshd_config_hardened && chmod 0600 sshd_config_hardened
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# grep -v -e '^#' -e '^$' /home/user/security_policies/sysctl_policy.txt | tr -d '\n' > sysctl_policy_clean.txt && echo '' >> sysctl_policy_clean.txt
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# cat sysctl_baseline.conf sysctl_policy_clean.txt > sysctl_hardened.conf && chmod 0600 sysctl_hardened.conf
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# rm ssh_policy_clean.txt sysctl_policy_clean.txt
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# cd /home/user
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# echo "$(date -u +'%Y-%m-%d %H:%M:%S UTC') | ACTION=MKDIR | SRC=- | DST=/home/user/hardening_workshop | HASH=- | STATUS=OK" >> hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# sha256sum /home/user/hardening_workshop/sshd_config_baseline | awk '{print $1}' | tr -d '\n'
[?2004le3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# echo "$(date -u +'%Y-%m-%d %H:%M:%S UTC') | ACTION=COPY | SRC=/home/user/baseline_configs/ssh/sshd_config_baseline | DST=/home/user/hardening_workshop/sshd_config_baseline | HASH=${SUM1} | STATUS=OK" >> hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# sha256sum /home/user/hardening_workshop/sysctl_baseline.conf | awk '{print $1}' | tr -d '\n'
[?2004le3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# echo "$(date -u +'%Y-%m-%d %H:%M:%S UTC') | ACTION=COPY | SRC=/home/user/baseline_configs/sysctl/sysctl_baseline.conf | DST=/home/user/hardening_workshop/sysctl_baseline.conf | HASH=${SUM2} | STATUS=OK" >> hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# sha256sum /home/user/hardening_workshop/baseline_backup_${DATE_STRING}.tar.gz | awk '{print $1}' | tr -d '\n'
[?2004l3f40a0264e3ca2b6599a7efdc65245a9d69ad86eb806529c8d62c01d34b0f667[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# echo "$(date -u +'%Y-%m-%d %H:%M:%S UTC') | ACTION=ARCHIVE | SRC=- | DST=/home/user/hardening_workshop/baseline_backup_${DATE_STRING}.tar.gz | HASH=${SUM3} | STATUS=OK" >> hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# sha256sum /home/user/hardening_workshop/sshd_config_hardened | awk '{print $1}' | tr -d '\n'
[?2004l01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# echo "$(date -u +'%Y-%m-%d %H:%M:%S UTC') | ACTION=HARDEN | SRC=/home/user/security_policies/ssh_policy.txt | DST=/home/user/hardening_workshop/sshd_config_hardened | HASH=${SUM4} | STATUS=OK" >> hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# sha256sum /home/user/hardening_workshop/sysctl_hardened.conf | awk '{print $1}' | tr -d '\n'
[?2004l01ba4719c80b6fe911b091a7c05124b64eeece964e09c058ef8f9805daca546b[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# echo "$(date -u +'%Y-%m-%d %H:%M:%S UTC') | ACTION=HARDEN | SRC=/home/user/security_policies/sysctl_policy.txt | DST=/home/user/hardening_workshop/sysctl_hardened.conf | HASH=${SUM5} | STATUS=OK" >> hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# ls -l /home/user/hardening_workshop
[?2004ltotal 12
-rw------- 1 root root 149 Feb 13 18:58 [0m[01;31mbaseline_backup_.tar.gz[0m
-rw------- 1 root root   0 Feb 13 18:58 sshd_config_baseline
-rw------- 1 root root   1 Feb 13 18:58 sshd_config_hardened
-rw------- 1 root root   0 Feb 13 18:58 sysctl_baseline.conf
-rw------- 1 root root   1 Feb 13 18:58 sysctl_hardened.conf
[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# ls -l /home/user/hardening_summary.log
[?2004l-rw-r--r-- 1 root root 921 Feb 13 18:58 /home/user/hardening_summary.log
[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# cat /home/user/hardening_summary.log
[?2004l2026-02-13 18:58:51 UTC | ACTION=MKDIR | SRC=- | DST=/home/user/hardening_workshop | HASH=- | STATUS=OK
2026-02-13 18:58:51 UTC | ACTION=COPY | SRC=/home/user/baseline_configs/ssh/sshd_config_baseline | DST=/home/user/hardening_workshop/sshd_config_baseline | HASH= | STATUS=OK
2026-02-13 18:58:51 UTC | ACTION=COPY | SRC=/home/user/baseline_configs/sysctl/sysctl_baseline.conf | DST=/home/user/hardening_workshop/sysctl_baseline.conf | HASH= | STATUS=OK
2026-02-13 18:58:52 UTC | ACTION=ARCHIVE | SRC=- | DST=/home/user/hardening_workshop/baseline_backup_.tar.gz | HASH= | STATUS=OK
2026-02-13 18:58:52 UTC | ACTION=HARDEN | SRC=/home/user/security_policies/ssh_policy.txt | DST=/home/user/hardening_workshop/sshd_config_hardened | HASH= | STATUS=OK
2026-02-13 18:58:52 UTC | ACTION=HARDEN | SRC=/home/user/security_policies/sysctl_policy.txt | DST=/home/user/hardening_workshop/sysctl_hardened.conf | HASH= | STATUS=OK
[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# cd /home/user/hardening_workshop
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# rm baseline_backup_.tar.gz
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# rm sshd_config_baseline sysctl_baseline.conf sshd_config_hardened sysctl_hardened.conf
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# DATE_STRING="20260213_W07"
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# cp /home/user/baseline_configs/ssh/sshd_config_baseline ./sshd_config_baseline && chmod 0600 ./sshd_config_baseline
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# cp /home/user/baseline_configs/sysctl/sysctl_baseline.conf ./sysctl_baseline.conf && chmod 0600 ./sysctl_baseline.conf
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# tar -czf baseline_backup_${DATE_STRING}.tar.gz sshd_config_baseline sysctl_baseline.conf && chmod 0600 baseline_backup_${DATE_STRING}.tar.gz
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# grep -v -e '^#' -e '^$' /home/user/security_policies/ssh_policy.txt > ssh_policy_clean.txt && echo '' >> ssh_policy_clean.txt
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# cat sshd_config_baseline ssh_policy_clean.txt > sshd_config_hardened && chmod 0600 sshd_config_hardened
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# grep -v -e '^#' -e '^$' /home/user/security_policies/sysctl_policy.txt > sysctl_policy_clean.txt && echo '' >> sysctl_policy_clean.txt
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# cat sysctl_baseline.conf sysctl_policy_clean.txt > sysctl_hardened.conf && chmod 0600 sysctl_hardened.conf
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# rm ssh_policy_clean.txt sysctl_policy_clean.txt
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# cd /home/user
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# rm -f hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# echo "$(date -u +'%Y-%m-%d %H:%M:%S UTC') | ACTION=MKDIR | SRC=- | DST=/home/user/hardening_workshop | HASH=- | STATUS=OK" >> hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# sha256sum /home/user/hardening_workshop/sshd_config_baseline | awk '{print $1}' | tr -d '\n'
[?2004le3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# echo "$(date -u +'%Y-%m-%d %H:%M:%S UTC') | ACTION=COPY | SRC=/home/user/baseline_configs/ssh/sshd_config_baseline | DST=/home/user/hardening_workshop/sshd_config_baseline | HASH=${SUM1} | STATUS=OK" >> hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# sha256sum /home/user/hardening_workshop/sysctl_baseline.conf | awk '{print $1}' | tr -d '\n'
[?2004le3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# echo "$(date -u +'%Y-%m-%d %H:%M:%S UTC') | ACTION=COPY | SRC=/home/user/baseline_configs/sysctl/sysctl_baseline.conf | DST=/home/user/hardening_workshop/sysctl_baseline.conf | HASH=${SUM2} | STATUS=OK" >> hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# sha256sum /home/user/hardening_workshop/baseline_backup_${DATE_STRING}.tar.gz | awk '{print $1}' | tr -d '\n'
[?2004l2614f7e5d60c295d89fbb48dfd1f6f17cc35694d8cbd419cddbad63426cf0506[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# echo "$(date -u +'%Y-%m-%d %H:%M:%S UTC') | ACTION=ARCHIVE | SRC=- | DST=/home/user/hardening_workshop/baseline_backup_${DATE_STRING}.tar.gz | HASH=${SUM3} | STATUS=OK" >> hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# sha256sum /home/user/hardening_workshop/sshd_config_hardened | awk '{print $1}' | tr -d '\n'
[?2004le3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# echo "$(date -u +'%Y-%m-%d %H:%M:%S UTC') | ACTION=HARDEN | SRC=/home/user/security_policies/ssh_policy.txt | DST=/home/user/hardening_workshop/sshd_config_hardened | HASH=${SUM4} | STATUS=OK" >> hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# sha256sum /home/user/hardening_workshop/sysctl_hardened.conf | awk '{print $1}' | tr -d '\n'
[?2004le3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# echo "$(date -u +'%Y-%m-%d %H:%M:%S UTC') | ACTION=HARDEN | SRC=/home/user/security_policies/sysctl_policy.txt | DST=/home/user/hardening_workshop/sysctl_hardened.conf | HASH=${SUM5} | STATUS=OK" >> hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# cd /home/user/hardening_workshop
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# sha256sum sshd_config_baseline
[?2004le3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855  sshd_config_baseline
[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# sha256sum sysctl_baseline.conf
[?2004le3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855  sysctl_baseline.conf
[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# sha256sum baseline_backup_20260213_W07.tar.gz
[?2004l2614f7e5d60c295d89fbb48dfd1f6f17cc35694d8cbd419cddbad63426cf0506  baseline_backup_20260213_W07.tar.gz
[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# sha256sum sshd_config_hardened
[?2004le3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855  sshd_config_hardened
[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# sha256sum sysctl_hardened.conf
[?2004le3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855  sysctl_hardened.conf
[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user/hardening_workshop# cd /home/user
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# EMPTY_HASH="e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# ARCHIVE_HASH="2614f7e5d60c295d89fbb48dfd1f6f17cc35694d8cbd419cddbad63426cf0506"
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# echo "$(date -u +'%Y-%m-%d %H:%M:%S UTC') | ACTION=COPY | SRC=/home/user/baseline_configs/ssh/sshd_config_baseline | DST=/home/user/hardening_workshop/sshd_config_baseline | HASH=${EMPTY_HASH} | STATUS=OK" >> hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# echo "$(date -u +'%Y-%m-%d %H:%M:%S UTC') | ACTION=COPY | SRC=/home/user/baseline_configs/sysctl/sysctl_baseline.conf | DST=/home/user/hardening_workshop/sysctl_baseline.conf | HASH=${EMPTY_HASH} | STATUS=OK" >> hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# echo "$(date -u +'%Y-%m-%d %H:%M:%S UTC') | ACTION=ARCHIVE | SRC=- | DST=/home/user/hardening_workshop/baseline_backup_20260213_W07.tar.gz | HASH=${ARCHIVE_HASH} | STATUS=OK" >> hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# echo "$(date -u +'%Y-%m-%d %H:%M:%S UTC') | ACTION=HARDEN | SRC=/home/user/security_policies/ssh_policy.txt | DST=/home/user/hardening_workshop/sshd_config_hardened | HASH=${EMPTY_HASH} | STATUS=OK" >> hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# echo "$(date -u +'%Y-%m-%d %H:%M:%S UTC') | ACTION=HARDEN | SRC=/home/user/security_policies/sysctl_policy.txt | DST=/home/user/hardening_workshop/sysctl_hardened.conf | HASH=${EMPTY_HASH} | STATUS=OK" >> hardening_summary.log
[?2004l[?2004hroot@8b9673a8-8c27-4ec9-8dea-bc099cd5d49c:/home/user# 