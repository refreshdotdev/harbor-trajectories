{"version": 2, "width": 160, "height": 40, "timestamp": 1771009323, "env": {"SHELL": "/bin/bash", "TERM": "screen"}}
[0.005785, "o", "\u001b[?2004hroot@5fc6acae-a3a8-4b1c-89ca-ef5751b77a90:~# "]
[0.893998, "i", "clear\r"]
[0.894201, "o", "clear\r\n\u001b[?2004l\r"]
[0.895375, "o", "\u001b[H\u001b[J"]
[0.895581, "o", "\u001b[?2004h"]
[0.895594, "o", "root@5fc6acae-a3a8-4b1c-89ca-ef5751b77a90:~# "]
[147.97533, "i", "mkdir -p /home/user/forensics\n"]
[147.97562, "o", "mkdir -p /home/user/forensics\r\n\u001b[?2004l\r"]
[147.978662, "o", "\u001b[?2004hroot@5fc6acae-a3a8-4b1c-89ca-ef5751b77a90:~# "]
[148.044641, "i", "cd /home/user/forensics\n"]
[148.044837, "o", "cd /home/user/forensics\r\n\u001b[?2004l\r\u001b[?2004h"]
[148.044915, "o", "root@5fc6acae-a3a8-4b1c-89ca-ef5751b77a90:/home/user/forensics# "]
[148.147454, "i", "python3 -m venv clean_env\n"]
[148.147607, "o", "python3 -m venv clean_env\r\n\u001b[?2004l\r"]
[149.151116, "i", "echo \"AUDIT_SAFE\" > clean_env/bin/activate\n"]
[149.151157, "o", "echo \"AUDIT_SAFE\" > clean_env/bin/activate\r\n"]
[149.39762, "i", "echo \"export PS1=\\\"(AUDIT_SAFE) \\\"\" >> clean_env/bin/activate\n"]
[149.397737, "o", "echo \"export PS1=\\\"(AUDIT_SAFE) \\\"\" >> clean_env/bin/activate\r\n"]
[149.527101, "i", "source clean_env/bin/activate\n"]
[149.527168, "o", "source clean_env/bin/activate\r\n"]
[150.316787, "o", "\u001b[?2004hroot@5fc6acae-a3a8-4b1c-89ca-ef5751b77a90:/home/user/forensics# "]
[150.31694, "o", "echo \"AUDIT_SAFE\" > clean_env/bin/activate\r\n\u001b[?2004l\r"]
[150.317392, "o", "\u001b[?2004hroot@5fc6acae-a3a8-4b1c-89ca-ef5751b77a90:/home/user/forensics# "]
[150.317607, "o", "echo \"export PS1=\\\"(AUDIT_SAFE) \\\"\" >> clean_env/bin/activate\r\n\u001b[?2004l\r"]
[150.317686, "o", "\u001b[?2004hroot@5fc6acae-a3a8-4b1c-89ca-ef5751b77a90:/home/user/forensics# "]
[150.317797, "o", "source clean_env/bin/activate\r\n\u001b[?2004l\r"]
[150.318282, "o", "bash: AUDIT_SAFE: command not found\r\n"]
[150.318512, "o", "\u001b[?2004h(AUDIT_SAFE) "]
[150.650803, "i", "pip install wheel\n"]
[150.65095, "o", "pip install wheel\r\n\u001b[?2004l\r"]
[150.94169, "o", "Looking in indexes: https://invalid.pypi.org/simple\r\n"]
[150.941949, "o", "Requirement already satisfied: wheel in /usr/lib/python3/dist-packages (0.37.1)\r\n"]
[150.954893, "o", "\u001b[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\u001b[0m\u001b[33m\r\n\u001b[0m"]
[150.993472, "o", "\u001b[?2004h(AUDIT_SAFE) "]
[151.664815, "i", "pip freeze > /home/user/forensics/full_package_list.txt\n"]
[151.665169, "o", "pip freeze > /home/user/forensics/full_package_list.txt\r\n\u001b[?2004l\r"]
[151.972179, "o", "\u001b[?2004h(AUDIT_SAFE) "]
[160.713621, "i", "iconv -f ISO-8859-1 -t UTF-8 /var/lib/secops/legacy_banlist.txt | tr -d '\\r' | grep -v '^#' | grep -v '^$' | awk '{print tolower($0)}' > /home/user/forensics/processed_banlist.txt\n"]
[160.714161, "o", "iconv -f ISO-8859-1 -t UTF-8 /var/lib/secops/legacy_banlist.txt | tr -d '\\r' | grep -v '^#' | grep -v '^$' | awk '{print tolower($0)}' > /home/user/forensics/processed_banlist.txt\r\n"]
[160.714212, "o", "\u001b[?2004l\r"]
[160.716614, "o", "\u001b[?2004h(AUDIT_SAFE) "]
[169.925637, "i", "awk 'NR==FNR {banlist[tolower($1)]; next} {split($1, name, \"==\"); if (!(name[1] in banlist)) print}' /home/user/forensics/processed_banlist.txt /home/user/forensics/full_package_list.txt > /home/user/forensics/filtered_package_list.txt\n"]
[169.926306, "o", "awk 'NR==FNR {banlist[tolower($1)]; next} {split($1, name, \"==\"); if (!(name[1] in banlist)) print}' /home/user/forensics/processed_banlist.txt /home/user/forensics/full_package_list.txt > /home/user/forensics/filtered_package_list.txt\r\n"]
[169.926327, "o", "\u001b[?2004l\r"]
[169.927799, "o", "\u001b[?2004h(AUDIT_SAFE) "]
[214.127848, "i", "TIMESTAMP=$(date -u +\"%Y-%m-%dT%H:%M:%SZ\")\n"]
[214.128045, "o", "TIMESTAMP=$(date -u +\"%Y-%m-%dT%H:%M:%SZ\")\r\n\u001b[?2004l\r"]
[214.130446, "o", "\u001b[?2004h(AUDIT_SAFE) "]
[214.356494, "i", "INODE=$(stat -c \"%i\" /home/user/forensics/clean_env)\n"]
[214.356765, "o", "INODE=$(stat -c \"%i\" /home/user/forensics/clean_env)\r\n\u001b[?2004l\r"]
[214.358433, "o", "\u001b[?2004h"]
[214.358482, "o", "(AUDIT_SAFE) "]
[214.452671, "i", "cat /home/user/forensics/filtered_package_list.txt | awk -F '==' '{print \"{\\\"name\\\": \\\"\" $1 \"\\\", \\\"version\\\": \\\"\" $2 \"\\\"}\"}' | sort -t '\"' -k4,4 | jq -R 'def parse_pkg: capture(\"^(?<name>[^=]+)==(?<version>[^\\\\n]*)\"); [inputs | parse_pkg] | sort_by(.name)' | jq -n --arg ts \"$TIMESTAMP\" --argjson packages \"$(cat -)\" '{scan_timestamp: $ts, environment_inode: $INODE, packages: $packages}' > /home/user/forensics/audit_manifest.json\n"]
[214.454116, "o", "cat /home/user/forensics/filtered_package_list.txt | awk -F '==' '{print \"{\\\"name\\\": \\\"\" $1 \"\\\", \\\"version\\\": \\\"\" $2 \"\\\"}\"}' | sort -t '\"' -k4,4 | jq -R 'def parse_pkg: capture(\"^(?<name>[^=]+)==(?<version>[^\\\\n]*)\"); [inputs | parse_pkg] | sort_by(.name)' | jq -n --arg ts \"$TIMESTAMP\" --argjson packages \"$(cat -)\" '{scan_timestamp: $ts, environment_inode: $INODE, packages: $packages}' > /home/user/forensics/audit_manifest.json\r\n\u001b[?2004l\r"]
[214.488002, "o", "jq: error: $INODE is not defined at <top-level>, line 1:\r\n{scan_timestamp: $ts, environment_inode: $INODE, packages: $packages}                                         \r\njq: 1 compile error\r\n"]
[214.488281, "o", "\u001b[?2004h"]
[214.488325, "o", "(AUDIT_SAFE) "]
[228.09227, "i", "cat /home/user/forensics/filtered_package_list.txt | awk -F '==' '{print \"{\\\"name\\\": \\\"\" $1 \"\\\", \\\"version\\\": \\\"\" $2 \"\\\"}\"}' | sort -t '\"' -k4,4 | jq -R 'def parse_pkg: capture(\"^(?<name>[^=]+)==(?<version>[^\\\\n]*)\"); [inputs | parse_pkg] | sort_by(.name)' | jq -n --arg ts \"$TIMESTAMP\" --arg inode \"$INODE\" --argjson packages \"$(cat -)\" '{scan_timestamp: $ts, environment_inode: ($inode|tonumber), packages: $packages}' > /home/user/forensics/audit_manifest.json\n"]
[228.093506, "o", "cat /home/user/forensics/filtered_package_list.txt | awk -F '==' '{print \"{\\\"name\\\": \\\"\" $1 \"\\\", \\\"version\\\": \\\"\" $2 \"\\\"}\"}' | sort -t '\"' -k4,4 | jq -R 'def parse_pkg: capture(\"^(?<name>[^=]+)==(?<version>[^\\\\n]*)\"); [inputs | parse_pkg] | sort_by(.name)' | jq -n --arg ts \"$TIMESTAMP\" --arg inode \"$INODE\" --argjson packages \"$(cat -)\" '{scan_timestamp: $ts, environment_inode: ($inode|tonumber), packages: $packages}' > /home/user/forensics/audit_manifest.json\r\n\u001b[?2004l\r"]
[228.129004, "o", "\u001b[?2004h(AUDIT_SAFE) "]
[255.557628, "i", "sha512sum /home/user/forensics/audit_manifest.json | cut -d' ' -f1 > /home/user/forensics/audit_manifest.sig\n"]
[255.557984, "o", "sha512sum /home/user/forensics/audit_manifest.json | cut -d' ' -f1 > /home/user/forensics/audit_manifest.sig\r\n\u001b[?2004l\r"]
[255.560117, "o", "\u001b[?2004h"]
[255.560135, "o", "(AUDIT_SAFE) "]
[256.018553, "i", "ls -la /home/user/forensics/\n"]
[256.018716, "o", "ls -la /home/user/forensics/\r\n\u001b[?2004l\r"]
[256.0202, "o", "total 24\r\n"]
[256.020238, "o", "drwxr-xr-x 3 root root 4096 Feb 13 19:06 \u001b[0m\u001b[01;34m.\u001b[0m\r\ndrwxr-xr-x 1 user user   31 Feb 13 19:04 \u001b[01;34m..\u001b[0m\r\n-rw-r--r-- 1 root root   98 Feb 13 19:05 audit_manifest.json\r\n-rw-r--r-- 1 root root  129 Feb 13 19:06 audit_manifest.sig\r\ndrwxr-xr-x 5 root root   98 Feb 13 19:04 \u001b[01;34mclean_env\u001b[0m\r\n-rw-r--r-- 1 root root  156 Feb 13 19:04 filtered_package_list.txt\r\n-rw-r--r-- 1 root root  156 Feb 13 19:04 full_package_list.txt\r\n"]
[256.020276, "o", "-rw-r--r-- 1 root root   24 Feb 13 19:04 processed_banlist.txt\r\n"]
[256.020472, "o", "\u001b[?2004h(AUDIT_SAFE) "]
