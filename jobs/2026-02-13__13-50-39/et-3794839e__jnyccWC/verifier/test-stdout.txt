============================= test session starts ==============================
platform linux -- Python 3.10.12, pytest-9.0.2, pluggy-1.6.0 -- /usr/bin/python3
cachedir: .pytest_cache
rootdir: /tests
collecting ... collected 3 items

../../tests/test_final_state.py::test_corruption_report FAILED           [ 33%]
../../tests/test_final_state.py::test_inventory_content FAILED           [ 66%]
../../tests/test_final_state.py::test_manifest_file FAILED               [100%]

=================================== FAILURES ===================================
____________________________ test_corruption_report ____________________________

    def test_corruption_report():
        assert CORRUPTION_FILE.exists(), "corruption_report.txt missing"
        content = CORRUPTION_FILE.read_bytes()
        # The line in exp_alpha was "data_dirty.csv | READY \n"
        # 1 trailing space.
>       assert b"data_dirty.csv | READY \n" in content, "Corrupted line not found in report exactly as bytes"
E       AssertionError: Corrupted line not found in report exactly as bytes
E       assert b'data_dirty.csv | READY \n' in b'/home/user/mlops/experiments/exp_alpha/artifacts.txt:1:valid_model_v1.pt | READY | {"version": 1}  valid_model_v2.pt | TRAINING | {"version": 2}  valid_model_v3.pt | READY | {"version": 3}  valid_model_v4.pt | VALIDATION | {"version": 4}  valid_model_v5.pt | READY | {"version": 5}  valid_model_v6.pt | TRAINING | {"version": 6}  \n/home/user/mlops/experiments/exp_alpha/artifacts.log:1:valid_model_v7.pt | READY | {"version": 7}  valid_model_v8.pt | TRAINING | {"version": 8}  valid_model_v9.pt | READY | {"version": 9}  valid_model_v10.pt | VALIDATION | {"version": 10}  valid_model_v11.pt | READY | {"version": 11}  \n/home/user/mlops/experiments/exp_beta/artifacts.txt:1:valid_model_v12.pt | READY | {"version": 12}  valid_model_v13.pt | TRAINING | {"version": 13}  valid_model_v14.pt | READY | {"version": 14}  valid_model_v15.pt | VALIDATION | {"version": 15}  valid_model_v16.pt | READY | {"version": 16}  \n/home/user/mlops/experiments/exp_beta/artifacts.log:1:model_v17.pt | READY | {"version": 17}  model_v18.pt | TRAINING | {"version": 18}  model_v19.pt | READY | {"version": 19}  model_v20.pt | VALIDATION | {"version": 20}  \n/home/user/mlops/experiments/exp_gamma/artifacts.txt:1:r\xc3\xa9sum\xc3\xa9_parser.pt | READY\n/home/user/mlops/experiments/exp_legacy/artifacts.txt:1:legacy_model.pt | IGNORE\n'

/tests/test_final_state.py:50: AssertionError
____________________________ test_inventory_content ____________________________

    def test_inventory_content():
        assert INVENTORY_FILE.exists(), "inventory.csv missing"
    
        with open(INVENTORY_FILE, 'r', encoding='utf-8') as f:
            lines = f.readlines()
    
        header = lines[0].strip()
        assert header == "Artifact|NameHash|Locations", "Header format incorrect"
    
        data_rows = [line.strip().split('|') for line in lines[1:] if line.strip()]
>       assert len(data_rows) == 4, f"Expected 4 valid artifacts, found {len(data_rows)}"
E       AssertionError: Expected 4 valid artifacts, found 0
E       assert 0 == 4
E        +  where 0 = len([])

/tests/test_final_state.py:62: AssertionError
______________________________ test_manifest_file ______________________________

    def test_manifest_file():
        assert MANIFEST_FILE.exists(), "manifest.yaml missing"
    
        with open(MANIFEST_FILE, 'r') as f:
            manifest = yaml.safe_load(f)
    
>       assert manifest['total_artifacts'] == 4
E       assert 0 == 4

/tests/test_final_state.py:84: AssertionError
=========================== short test summary info ============================
FAILED ../../tests/test_final_state.py::test_corruption_report - AssertionErr...
FAILED ../../tests/test_final_state.py::test_inventory_content - AssertionErr...
FAILED ../../tests/test_final_state.py::test_manifest_file - assert 0 == 4
============================== 3 failed in 0.04s ===============================
