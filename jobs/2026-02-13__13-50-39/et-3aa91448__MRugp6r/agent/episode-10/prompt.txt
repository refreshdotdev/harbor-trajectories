Previous response had warnings:
WARNINGS: - Extra text detected before JSON object
- Extra text detected after JSON object

New Terminal Output:

root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data# cat /tmp/suspicious_packets_count.csv_temp
DEBUG: Active IP: 203.0.113.55
DEBUG: Active IP: 10.0.0.99
DEBUG: Active IP: 192.168.1.100
203.0.113.55 1
10.0.0.99 3
192.168.1.100 3
root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data# REPORT_CONTENT="Source_IP,Risk_Score,Packet_Count\r\n"
root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data#
root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data# # For IP 192.168.1.100
root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data# REPORT_CONTENT="$REPORT_CONTENT""192.168.1.100,9,3\r\n"
root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data#
root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data# # For IP 10.0.0.99
root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data# REPORT_CONTENT="$REPORT_CONTENT""10.0.0.99,8,3\r\n"
root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data#
root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data# # For IP 203.0.113.55
root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data# REPORT_CONTENT="$REPORT_CONTENT""203.0.113.55,7,1\r\n"
root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data#
root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data# echo -e "$REPORT_CONTENT" | tee /tmp/report_content_utf8.txt
Source_IP,Risk_Score,Packet_Count
192.168.1.100,9,3
10.0.0.99,8,3
203.0.113.55,7,1

root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data# if command -v iconv >/dev/null; then
>     iconv -f UTF-8 -t WINDOWS-1252 /tmp/report_content_utf8.txt > /home/user/evidence/report.csv
>   else
>     echo "iconv not found. Creating report.csv with UTF-8 encoding (Windows-1252 required)."
>     echo -e "$REPORT_CONTENT" > /home/user/evidence/report.csv
> fi
root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data#
root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data# echo "Contents of /home/user/evidence/report.csv after iconv (if applicable):"
Contents of /home/user/evidence/report.csv after iconv (if applicable):
root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data# cat /home/user/evidence/report.csv 2>/dev/null || echo "File not readable or iconv failed, check /tmp
/report_content_utf8.txt for intended content."
Source_IP,Risk_Score,Packet_Count
192.168.1.100,9,3
10.0.0.99,8,3
203.0.113.55,7,1

root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data# echo -e "\n--- /tmp/report_content_utf8.txt (UTF-8 source for report.csv) ---"; cat /tmp/report_conte
nt_utf8.txt

--- /tmp/report_content_utf8.txt (UTF-8 source for report.csv) ---
Source_IP,Risk_Score,Packet_Count
192.168.1.100,9,3
10.0.0.99,8,3
203.0.113.55,7,1

root@92332309-2701-47d5-9ad9-1302447f1d26:/home/user/data#
