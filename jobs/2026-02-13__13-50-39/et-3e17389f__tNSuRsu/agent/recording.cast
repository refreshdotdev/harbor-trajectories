{"version": 2, "width": 160, "height": 40, "timestamp": 1771008929, "env": {"SHELL": "/bin/bash", "TERM": "screen"}}
[0.004789, "o", "\u001b[?2004h"]
[0.005261, "o", "root@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[0.941011, "i", "clear\r"]
[0.941142, "o", "clear\r\n\u001b[?2004l\r"]
[0.942249, "o", "\u001b[H\u001b[J"]
[0.942527, "o", "\u001b[?2004h"]
[0.942569, "o", "root@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[5.388036, "i", "su - user\n"]
[5.388134, "o", "su - user\r\n\u001b[?2004l\r"]
[5.389475, "o", "su: user user does not exist or the user entry does not contain all the required fields\r\n"]
[5.389645, "o", "\u001b[?2004h"]
[5.389654, "o", "root@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[10.933828, "i", "useradd -m user\n"]
[10.933982, "o", "useradd -m user\r\n\u001b[?2004l\r"]
[10.934498, "o", "bash: useradd: command not found\r\n"]
[10.93489, "o", "\u001b[?2004h"]
[10.934915, "o", "root@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[11.108603, "i", "passwd user\n"]
[11.108917, "o", "passwd user\r\n\u001b[?2004l\r"]
[11.110476, "o", "passwd: user 'user' does not exist\r\n"]
[11.110673, "o", "\u001b[?2004h"]
[11.110687, "o", "root@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[12.110089, "i", "password123\n"]
[12.11026, "o", "password123\r\n\u001b[?2004l\r"]
[12.110655, "o", "bash: password123: command not found\r\n"]
[12.110919, "o", "\u001b[?2004hroot@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[12.261865, "i", "password123\n"]
[12.262007, "o", "password123\r\n\u001b[?2004l\r"]
[12.262365, "o", "bash: password123: command not found\r\n"]
[12.262609, "o", "\u001b[?2004h"]
[12.26265, "o", "root@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[16.83036, "i", "mkdir -p /home/user\n"]
[16.830532, "o", "mkdir -p /home/user\r\n\u001b[?2004l\r"]
[16.831747, "o", "\u001b[?2004hroot@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[16.937716, "i", "mkdir -p /home/user/db_queries\n"]
[16.93785, "o", "mkdir -p /home/user/db_queries\r\n\u001b[?2004l\r"]
[16.938814, "o", "\u001b[?2004hroot@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[17.102008, "i", "mkdir -p /home/user/.venvs\n"]
[17.102314, "o", "mkdir -p /home/user/.venvs\r\n"]
[17.102372, "o", "\u001b[?2004l\r"]
[17.107386, "o", "\u001b[?2004h"]
[17.107445, "o", "root@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[22.533713, "i", "cat > /home/user/db_queries/raw_batch_42.sql << 'EOF'\nselect * from t;\nINSERT INTO table VALUES (1, 'test');\nUPDATE table SET col = 'value' WHERE id = 1;\nDELETE FROM table WHERE id = 1;\nEOF\n"]
[22.53392, "o", "cat > /home/user/db_queries/raw_batch_42.sql << 'EOF'\r\n\u001b[?2004l\r"]
[22.533973, "o", "\u001b[?2004h> "]
[22.534017, "o", "select * from t;\r\n\u001b[?2004l\r"]
[22.534049, "o", "\u001b[?2004h"]
[22.534082, "o", "> "]
[22.534164, "o", "INSERT INTO table VALUES (1, 'test');\r\n\u001b[?2004l\r"]
[22.534173, "o", "\u001b[?2004h"]
[22.534217, "o", "> "]
[22.534298, "o", "UPDATE table SET col = 'value' WHERE id = 1;\r\n\u001b[?2004l\r"]
[22.534333, "o", "\u001b[?2004h> "]
[22.53441, "o", "DELETE FROM table WHERE id = 1;\r\n\u001b[?2004l\r"]
[22.534443, "o", "\u001b[?2004h> EOF\r\n\u001b[?2004l\r"]
[22.535738, "o", "\u001b[?2004hroot@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[28.121202, "i", "python3 -m venv /home/user/.venvs/opt_queries\n"]
[28.121488, "o", "python3 -m venv /home/user/.venvs/opt_queries\r\n\u001b[?2004l\r"]
[29.174566, "i", "echo \"sqlparse==0.4.4\" > /home/user/.venvs/opt_queries/requirements.txt\n"]
[29.174597, "o", "echo \"sqlparse==0.4.4\" > /home/user/.venvs/opt_queries"]
[29.174655, "o", "/requirements.txt\r\n"]
[29.304344, "i", "/home/user/.venvs/opt_queries/bin/pip install -r /home/user/.venvs/opt_queries/requirements.txt\n"]
[29.304387, "o", "/home/user/.venvs/opt_queries/bin/pip install -r /home/user/.v"]
[29.304496, "o", "envs/opt_queries/requirements.txt\r\n"]
[30.118899, "o", "\u001b[?2004hroot@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[30.119249, "o", "echo \"sqlparse==0.4.4\" > /home/user/.venvs/opt_queries/requirements.txt\r\n"]
[30.11929, "o", "\u001b[?2004l\r"]
[30.119516, "o", "\u001b[?2004h"]
[30.119543, "o", "root@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[30.120082, "o", "/home/user/.venvs/opt_queries/bin/pip install -r /home/user/.venvs/opt_queries/requirements.txt\r\n"]
[30.120108, "o", "\u001b[?2004l\r"]
[30.404098, "o", "Collecting sqlparse==0.4.4\r\n"]
[30.435377, "o", "  Downloading sqlparse-0.4.4-py3-none-any.whl (41 kB)\r\n"]
[30.435623, "o", "\u001b[?25l"]
[30.436611, "o", "     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m0.0/41.2 KB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m"]
[30.445094, "o", "\r\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m41.2/41.2 KB\u001b[0m \u001b[31m4.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\r\n\u001b[?25h"]
[30.465014, "o", "Installing collected packages: sqlparse\r\n"]
[30.492186, "o", "Successfully installed sqlparse-0.4.4\r\n"]
[30.53232, "o", "\u001b[?2004hroot@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[52.322957, "i", "cat > /home/user/db_queries/process_batch.py << 'EOF'\n#!/usr/bin/env python3\n\nimport os\nimport sys\nimport hashlib\nimport sqlparse\nimport json\n\ndef process_queries():\n    # Get batch ID from environment variable\n    batch_id = os.environ.get('DB_BATCH_ID', '42')\n    \n    # File paths\n    input_file = f\"/home/user/db_queries/raw_batch_{batch_id}.sql\"\n    backup_file = f\"/home/user/db_queries/raw_batch_{batch_id}_backup.sql\"\n    read_output = f\"/home/user/db_queries/batch_{batch_id}_optimized_read.sql\"\n    write_output = f\"/home/user/db_queries/batch_{batch_id}_optimized_write.sql\"\n    manifest_file = f\"/home/user/db_queries/batch_{batch_id}_manifest.json\"\n    log_file = f\"/home/user/db_queries/batch_{batch_id}_pipeline.log\"\n    \n    # Read input file\n    try:\n        with open(input_file, 'r') as f:\n            raw_sql = f.read()\n    except FileNotFoundError:\n        print(f\"Input file {input_file} not found\")\n        return\n    \n    # Create backup\n    with open(backup_file, 'w') as f:\n        f.write(raw_sql)"]
[52.323057, "i", "\n    \n    # Initialize variables\n    queries = sqlparse.split(raw_sql)\n    total_queries = len(queries)\n    read_queries = []\n    write_queries = []\n    \n    # Process each query\n    for query in queries:\n        # Skip empty queries\n        if not query.strip():\n            continue\n            \n        original_query = query.strip()\n        md5_hash = hashlib.md5(original_query.encode()).hexdigest()\n        \n        # Parse and format query\n        parsed = sqlparse.parse(original_query)[0]\n        formatted = sqlparse.format(parsed, \n                                    keyword_case='upper', \n                                    indent_columns=False, \n                                    strip_comments=False,\n                                    reindent=False,\n                                    wrap_after=None,\n                                    indent_tabs=False)\n        \n        # Replace newlines with spaces and add comment\n        optimized = formatted.replace('\\n', ' ').strip() + f' -- id={md5_hash}'\n "]
[52.323081, "i", "       \n        # Classify query\n        first_token = sqlparse.sql.IdentifierList(parsed.tokens).get_identifiers()[0].value\n        if first_token.lower() == 'select':\n            read_queries.append(f\"{optimized};\\n\")\n        else:\n            write_queries.append(f\"{optimized};\\n\")\n    \n    # Write output files\n    with open(read_output, 'w') as f:\n        f.writelines(read_queries)\n    \n    with open(write_output, 'w') as f:\n        f.writelines(write_queries)\n    \n    # Create manifest\n    manifest = {\n        \"batch_id\": batch_id,\n        \"read_count\": len(read_queries),\n        \"write_count\": len(write_queries)\n    }\n    with open(manifest_file, 'w') as f:\n        json.dump(manifest, f, indent=2)\n    \n    # Create log\n    with open(log_file, 'w') as f:\n        f.write(\"PIPELINE START\\n\")\n        f.write(f\"Batch ID: {batch_id}\\n\")\n        f.write(f\"Input: raw_batch_{batch_id}.sql\\n\")\n        f.write(f\"Processed: {total_queries}\\n\")\n        f.write(\"PIPELINE END\\n\")\n\nif __name__ == \"__main__\":\n    proces"]
[52.323101, "i", "s_queries()\nEOF\n"]
[52.323356, "o", "cat > /home/user/db_queries/process_batch.py << 'EOF'\r\n\u001b[?2004l\r"]
[52.323438, "o", "\u001b[?2004h"]
[52.323459, "o", "> "]
[52.323598, "o", "#!/usr/bin/env python3\r\n\u001b[?2004l\r"]
[52.323637, "o", "\u001b[?2004h"]
[52.323658, "o", "> \r\n"]
[52.323672, "o", "\u001b[?2004l\r"]
[52.323697, "o", "\u001b[?2004h"]
[52.323715, "o", "> "]
[52.323792, "o", "import os\r\n"]
[52.323807, "o", "\u001b[?2004l\r"]
[52.323829, "o", "\u001b[?2004h"]
[52.323855, "o", "> "]
[52.323916, "o", "import sys\r\n\u001b[?2004l\r"]
[52.323951, "o", "\u001b[?2004h"]
[52.323969, "o", "> "]
[52.324061, "o", "import hashlib\r\n\u001b[?2004l\r"]
[52.324109, "o", "\u001b[?2004h"]
[52.32415, "o", "> "]
[52.324226, "o", "import sqlparse\r\n"]
[52.324236, "o", "\u001b[?2004l\r"]
[52.324314, "o", "\u001b[?2004h> "]
[52.324361, "o", "import json\r\n\u001b[?2004l\r"]
[52.324399, "o", "\u001b[?2004h"]
[52.324434, "o", "> "]
[52.32447, "o", "\r\n\u001b[?2004l\r\u001b[?2004h"]
[52.324504, "o", "> "]
[52.324631, "o", "def process_queries():\r\n\u001b[?2004l\r"]
[52.324687, "o", "\u001b[?2004h> "]
[52.325037, "o", "    # Get batch ID from environment variable\r\n"]
[52.325595, "o", "\u001b[?2004l\r\u001b[?2004h>     batch_id = os.environ.get('DB_BATCH_ID', '42')\r\n\u001b[?2004l\r\u001b[?2004h>     \r\n"]
[52.325647, "o", "\u001b[?2004l\r\u001b[?2004h> "]
[52.325752, "o", "    # File paths\r\n\u001b[?2004l\r"]
[52.325802, "o", "\u001b[?2004h"]
[52.32582, "o", "> "]
[52.326122, "o", "    input_file = f\"/home/user/db_queries/raw_batch_{batch_id}.sql\"\r\n\u001b[?2004l\r"]
[52.326165, "o", "\u001b[?2004h> "]
[52.326528, "o", "    backup_file = f\"/home/user/db_queries/raw_batch_{batch_id}_backup.sql\"\r\n\u001b[?2004l\r"]
[52.326555, "o", "\u001b[?2004h"]
[52.326577, "o", "> "]
[52.326992, "o", "    read_output = f\"/home/user/db_queries/batch_{batch_id}_optimized_read.sql\"\r\n\u001b[?2004l\r\u001b[?2004h"]
[52.327075, "o", "> "]
[52.327425, "o", "    write_output = f\"/home/user/db_queries/batch_{batch_id}_optimized_write.sql\"\r\n\u001b[?2004l\r"]
[52.327476, "o", "\u001b[?2004h> "]
[52.327862, "o", "    manifest_file = f\"/home/user/db_queries/batch_{batch_id}_manifest.json\"\r\n\u001b[?2004l\r"]
[52.327908, "o", "\u001b[?2004h> "]
[52.328255, "o", "    log_file = f\"/home/user/db_queries/batch_{batch_id}_pipeline.log\"\r\n\u001b[?2004l\r"]
[52.328284, "o", "\u001b[?2004h"]
[52.328331, "o", ">     \r\n"]
[52.328373, "o", "\u001b[?2004l\r\u001b[?2004h"]
[52.32842, "o", "> "]
[52.328525, "o", "    # Read input file\r\n\u001b[?2004l\r"]
[52.328623, "o", "\u001b[?2004h>     try:\r\n\u001b[?2004l\r"]
[52.328655, "o", "\u001b[?2004h> "]
[52.32888, "o", "        with open(input_file, 'r') as f:\r\n\u001b[?2004l\r"]
[52.328912, "o", "\u001b[?2004h"]
[52.328941, "o", "> "]
[52.329098, "o", "            raw_sql = f.read()\r\n\u001b[?2004l\r"]
[52.32913, "o", "\u001b[?2004h"]
[52.329161, "o", "> "]
[52.329308, "o", "    except FileNotFoundError:\r\n\u001b[?2004l\r"]
[52.329339, "o", "\u001b[?2004h"]
[52.329367, "o", "> "]
[52.329623, "o", "        print(f\"Input file {input_file} not found\")\r\n\u001b[?2004l\r"]
[52.329665, "o", "\u001b[?2004h"]
[52.329695, "o", "> "]
[52.329775, "o", "        return\r\n\u001b[?2004l\r"]
[52.329806, "o", "\u001b[?2004h"]
[52.329836, "o", "> "]
[52.329868, "o", "    \r\n\u001b[?2004l\r"]
[52.329898, "o", "\u001b[?2004h"]
[52.329927, "o", "> "]
[52.330033, "o", "    # Create backup\r\n"]
[52.330069, "o", "\u001b[?2004l\r\u001b[?2004h"]
[52.330098, "o", "> "]
[52.330284, "o", "    with open(backup_file, 'w') as f:\r\n\u001b[?2004l\r"]
[52.330326, "o", "\u001b[?2004h"]
[52.330355, "o", "> "]
[52.330477, "o", "        f.write(raw_sql)\r\n\u001b[?2004l\r"]
[52.330507, "o", "\u001b[?2004h"]
[52.330537, "o", "> "]
[52.330568, "o", "    \r\n\u001b[?2004l\r"]
[52.330599, "o", "\u001b[?2004h"]
[52.330629, "o", "> "]
[52.330757, "o", "    # Initialize variables\r\n\u001b[?2004l\r"]
[52.330809, "o", "\u001b[?2004h"]
[52.330844, "o", "> "]
[52.33102, "o", "    queries = sqlparse.split(raw_sql)\r\n\u001b[?2004l\r"]
[52.331052, "o", "\u001b[?2004h"]
[52.331082, "o", "> "]
[52.331243, "o", "    total_queries = len(queries)\r\n\u001b[?2004l\r"]
[52.331285, "o", "\u001b[?2004h> "]
[52.33141, "o", "    read_queries = []\r\n\u001b[?2004l\r"]
[52.33145, "o", "\u001b[?2004h"]
[52.33148, "o", "> "]
[52.331593, "o", "    write_queries = []\r\n\u001b[?2004l\r"]
[52.331627, "o", "\u001b[?2004h"]
[52.331657, "o", "> "]
[52.331687, "o", "    \r\n\u001b[?2004l\r"]
[52.331718, "o", "\u001b[?2004h"]
[52.331748, "o", "> "]
[52.331877, "o", "    # Process each query\r\n\u001b[?2004l\r"]
[52.331913, "o", "\u001b[?2004h"]
[52.331947, "o", "> "]
[52.332072, "o", "    for query in queries:\r\n\u001b[?2004l\r"]
[52.332111, "o", "\u001b[?2004h> "]
[52.332273, "o", "        # Skip empty queries\r\n\u001b[?2004l\r"]
[52.332306, "o", "\u001b[?2004h"]
[52.332337, "o", "> "]
[52.332484, "o", "        if not query.strip():\r\n\u001b[?2004l\r"]
[52.33252, "o", "\u001b[?2004h"]
[52.332558, "o", "> "]
[52.332658, "o", "            continue\r\n\u001b[?2004l\r"]
[52.332689, "o", "\u001b[?2004h"]
[52.33272, "o", "> "]
[52.332795, "o", "            \r\n\u001b[?2004l\r"]
[52.332829, "o", "\u001b[?2004h"]
[52.332858, "o", "> "]
[52.333047, "o", "        original_query = query.strip()\r\n\u001b[?2004l\r"]
[52.33308, "o", "\u001b[?2004h"]
[52.33311, "o", "> "]
[52.333434, "o", "        md5_hash = hashlib.md5(original_query.encode()).hexdigest()\r\n\u001b[?2004l\r"]
[52.333465, "o", "\u001b[?2004h"]
[52.333494, "o", "> "]
[52.333545, "o", "        \r\n\u001b[?2004l\r"]
[52.333577, "o", "\u001b[?2004h"]
[52.333606, "o", "> "]
[52.333772, "o", "        # Parse and format query\r\n\u001b[?2004l\r"]
[52.333802, "o", "\u001b[?2004h"]
[52.333832, "o", "> "]
[52.33409, "o", "        parsed = sqlparse.parse(original_query)[0]\r\n\u001b[?2004l\r"]
[52.334127, "o", "\u001b[?2004h"]
[52.334151, "o", "> "]
[52.334368, "o", "        formatted = sqlparse.format(parsed, \r\n\u001b[?2004l\r"]
[52.334399, "o", "\u001b[?2004h"]
[52.33443, "o", "> "]
[52.334715, "o", "                                    keyword_case='upper', \r\n\u001b[?2004l\r"]
[52.334747, "o", "\u001b[?2004h"]
[52.334803, "o", "> "]
[52.33507, "o", "                                    indent_columns=False, \r\n\u001b[?2004l\r"]
[52.335103, "o", "\u001b[?2004h"]
[52.335133, "o", "> "]
[52.335415, "o", "                                    strip_comments=False,\r\n\u001b[?2004l\r"]
[52.335452, "o", "\u001b[?2004h"]
[52.335482, "o", "> "]
[52.33573, "o", "                                    reindent=False,\r\n\u001b[?2004l\r"]
[52.335777, "o", "\u001b[?2004h"]
[52.33582, "o", "> "]
[52.336081, "o", "                                    wrap_after=None,\r\n\u001b[?2004l\r"]
[52.33612, "o", "\u001b[?2004h"]
[52.336155, "o", "> "]
[52.336416, "o", "                                    indent_tabs=False)\r\n\u001b[?2004l\r"]
[52.336457, "o", "\u001b[?2004h"]
[52.336489, "o", "> "]
[52.336534, "o", "        \r\n\u001b[?2004l\r"]
[52.336567, "o", "\u001b[?2004h"]
[52.336597, "o", "> "]
[52.336871, "o", "        # Replace newlines with spaces and add comment\r\n\u001b[?2004l\r"]
[52.336903, "o", "\u001b[?2004h"]
[52.336933, "o", "> "]
[52.337316, "o", "        optimized = formatted.replace('\\n', ' ').strip() + f' -- id={md5_hash}'\r\n\u001b[?2004l\r"]
[52.337348, "o", "\u001b[?2004h"]
[52.337377, "o", "> "]
[52.337426, "o", "        \r\n\u001b[?2004l\r"]
[52.337457, "o", "\u001b[?2004h"]
[52.337487, "o", "> "]
[52.337612, "o", "        # Classify query\r\n\u001b[?2004l\r"]
[52.33765, "o", "\u001b[?2004h"]
[52.337681, "o", "> "]
[52.338126, "o", "        first_token = sqlparse.sql.IdentifierList(parsed.tokens).get_identifiers()[0].value\r\n\u001b[?2004l\r"]
[52.338178, "o", "\u001b[?2004h> "]
[52.338401, "o", "        if first_token.lower() == 'select':\r\n\u001b[?2004l\r"]
[52.338444, "o", "\u001b[?2004h> "]
[52.338704, "o", "            read_queries.append(f\"{optimized};\\n\")\r\n\u001b[?2004l\r"]
[52.338742, "o", "\u001b[?2004h"]
[52.338778, "o", "> "]
[52.338851, "o", "        else:\r\n\u001b[?2004l\r"]
[52.338886, "o", "\u001b[?2004h"]
[52.338915, "o", "> "]
[52.339168, "o", "            write_queries.append(f\"{optimized};\\n\")\r\n\u001b[?2004l\r"]
[52.339199, "o", "\u001b[?2004h"]
[52.339229, "o", "> "]
[52.33926, "o", "    \r\n\u001b[?2004l\r"]
[52.339284, "o", "\u001b[?2004h"]
[52.339314, "o", "> "]
[52.339438, "o", "    # Write output files\r\n\u001b[?2004l\r"]
[52.339469, "o", "\u001b[?2004h"]
[52.339499, "o", "> "]
[52.339685, "o", "    with open(read_output, 'w') as f:\r\n\u001b[?2004l\r"]
[52.339716, "o", "\u001b[?2004h"]
[52.33974, "o", "> "]
[52.339922, "o", "        f.writelines(read_queries)\r\n\u001b[?2004l\r"]
[52.339953, "o", "\u001b[?2004h"]
[52.339983, "o", "> "]
[52.34001, "o", "    \r\n\u001b[?2004l\r"]
[52.340049, "o", "\u001b[?2004h> "]
[52.340254, "o", "    with open(write_output, 'w') as f:\r\n\u001b[?2004l\r"]
[52.340285, "o", "\u001b[?2004h"]
[52.340315, "o", "> "]
[52.340497, "o", "        f.writelines(write_queries)\r\n\u001b[?2004l\r"]
[52.340529, "o", "\u001b[?2004h"]
[52.340559, "o", "> "]
[52.34059, "o", "    \r\n\u001b[?2004l\r"]
[52.34062, "o", "\u001b[?2004h> "]
[52.340747, "o", "    # Create manifest\r\n\u001b[?2004l\r"]
[52.340786, "o", "\u001b[?2004h"]
[52.340811, "o", "> "]
[52.340902, "o", "    manifest = {\r\n\u001b[?2004l\r"]
[52.340932, "o", "\u001b[?2004h"]
[52.340957, "o", "> "]
[52.341111, "o", "        \"batch_id\": batch_id,\r\n\u001b[?2004l\r"]
[52.341144, "o", "\u001b[?2004h"]
[52.341167, "o", "> "]
[52.34137, "o", "        \"read_count\": len(read_queries),\r\n\u001b[?2004l\r"]
[52.341401, "o", "\u001b[?2004h"]
[52.341425, "o", "> "]
[52.341634, "o", "        \"write_count\": len(write_queries)\r\n\u001b[?2004l\r"]
[52.341666, "o", "\u001b[?2004h"]
[52.341696, "o", "> "]
[52.341721, "o", "    }\r\n\u001b[?2004l\r"]
[52.341773, "o", "\u001b[?2004h"]
[52.341797, "o", "> "]
[52.341993, "o", "    with open(manifest_file, 'w') as f:\r\n\u001b[?2004l\r"]
[52.342024, "o", "\u001b[?2004h"]
[52.342048, "o", "> "]
[52.342252, "o", "        json.dump(manifest, f, indent=2)\r\n\u001b[?2004l\r"]
[52.342287, "o", "\u001b[?2004h"]
[52.342317, "o", "> "]
[52.342348, "o", "    \r\n\u001b[?2004l\r"]
[52.342378, "o", "\u001b[?2004h> "]
[52.342479, "o", "    # Create log\r\n\u001b[?2004l\r"]
[52.342514, "o", "\u001b[?2004h"]
[52.342537, "o", "> "]
[52.342713, "o", "    with open(log_file, 'w') as f:\r\n\u001b[?2004l\r"]
[52.342744, "o", "\u001b[?2004h"]
[52.342781, "o", "> "]
[52.342959, "o", "        f.write(\"PIPELINE START\\n\")\r\n\u001b[?2004l\r"]
[52.342991, "o", "\u001b[?2004h"]
[52.343022, "o", "> "]
[52.343227, "o", "        f.write(f\"Batch ID: {batch_id}\\n\")\r\n\u001b[?2004l\r"]
[52.343267, "o", "\u001b[?2004h"]
[52.34329, "o", "> "]
[52.343553, "o", "        f.write(f\"Input: raw_batch_{batch_id}.sql\\n\")\r\n\u001b[?2004l\r"]
[52.343585, "o", "\u001b[?2004h"]
[52.343615, "o", "> "]
[52.343863, "o", "        f.write(f\"Processed: {total_queries}\\n\")\r\n\u001b[?2004l\r"]
[52.343895, "o", "\u001b[?2004h"]
[52.343925, "o", "> "]
[52.344102, "o", "        f.write(\"PIPELINE END\\n\")\r\n\u001b[?2004l\r"]
[52.344132, "o", "\u001b[?2004h"]
[52.344163, "o", "> \r\n\u001b[?2004l\r"]
[52.344195, "o", "\u001b[?2004h"]
[52.344218, "o", "> "]
[52.344356, "o", "if __name__ == \"__main__\":\r\n\u001b[?2004l\r"]
[52.344387, "o", "\u001b[?2004h"]
[52.344418, "o", "> "]
[52.344532, "o", "    process_queries()\r\n\u001b[?2004l\r"]
[52.344563, "o", "\u001b[?2004h"]
[52.344587, "o", "> "]
[52.344612, "o", "EOF\r\n\u001b[?2004l\r"]
[52.346376, "o", "\u001b[?2004hroot@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[52.719514, "i", "chmod +x /home/user/db_queries/process_batch.py\n"]
[52.719903, "o", "chmod +x /home/user/db_queries/process_batch.py\r\n\u001b[?2004l\r"]
[52.72168, "o", "\u001b[?2004hroot@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[57.410028, "i", "export DB_BATCH_ID=42\n"]
[57.410179, "o", "export DB_BATCH_ID=42\r\n\u001b[?2004l\r"]
[57.410234, "o", "\u001b[?2004hroot@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[57.538258, "i", "/home/user/.venvs/opt_queries/bin/python /home/user/db_queries/process_batch.py\n"]
[57.53877, "o", "/home/user/.venvs/opt_queries/bin/python /home/user/db_queries/process_batch.py\r\n"]
[57.538797, "o", "\u001b[?2004l\r"]
[57.560272, "o", "Traceback (most recent call last):\r\n  File \"/home/user/.venvs/opt_queries/lib/python3.10/site-packages/sqlparse/formatter.py\", line 107, in validate_options\r\n"]
[57.560351, "o", "    wrap_after = int(wrap_after)\r\nTypeError: int() argument must be a string, a bytes-like object or a real number, not 'NoneType'\r\n\r\nDuring handling of the above exception, another exception occurred:\r\n\r\nTraceback (most recent call last):\r\n  File \"/home/user/db_queries/process_batch.py\", line 93, in <module>\r\n"]
[57.56039, "o", "    process_queries()\r\n  File \"/home/user/db_queries/process_batch.py\", line 50, in process_queries\r\n"]
[57.560407, "o", "    formatted = sqlparse.format(parsed, \r\n  File \"/home/user/.venvs/opt_queries/lib/python3.10/site-packages/sqlparse/__init__.py\", line 56, in format\r\n"]
[57.560425, "o", "    options = formatter.validate_options(options)\r\n  File \"/home/user/.venvs/opt_queries/lib/python3.10/site-packages/sqlparse/formatter.py\", line 109, in validate_options\r\n"]
[57.560456, "o", "    raise SQLParseError('wrap_after requires an integer')\r\nsqlparse.exceptions.SQLParseError: wrap_after requires an integer\r\n"]
[57.563135, "o", "\u001b[?2004h"]
[57.563182, "o", "root@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[62.743467, "i", "sed -i 's/wrap_after=None/reindent=True/g' /home/user/db_queries/process_batch.py\n"]
[62.743808, "o", "sed -i 's/wrap_after=None/reindent=True/g' /home/user/db_queries/process_batch.py\r\n\u001b[?2004l\r"]
[62.745175, "o", "\u001b[?2004hroot@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[62.891737, "i", "/home/user/.venvs/opt_queries/bin/python /home/user/db_queries/process_batch.py\n"]
[62.891989, "o", "/home/user/.venvs/opt_queries/bin/python /home/user/db_queries/process_batch.py\r\n\u001b[?2004l\r"]
[62.899285, "o", "  File \"/home/user/db_queries/process_batch.py\", line 55\r\n    reindent=True,\r\n    ^^^^^^^^^^^^^\r\nSyntaxError: keyword argument repeated: reindent\r\n"]
[62.900661, "o", "\u001b[?2004hroot@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[68.249893, "i", "sed -i 's/wrap_after=None,//g' /home/user/db_queries/process_batch.py\n"]
[68.250117, "o", "sed -i 's/wrap_after=None,//g' /home/user/db_queries/process_batch.py\r\n\u001b[?2004l\r"]
[68.251452, "o", "\u001b[?2004hroot@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[68.417143, "i", "/home/user/.venvs/opt_queries/bin/python /home/user/db_queries/process_batch.py\n"]
[68.417731, "o", "/home/user/.venvs/opt_queries/bin/python /home/user/db_queries/process_batch.py\r\n\u001b[?2004l\r"]
[68.425232, "o", "  File \"/home/user/db_queries/process_batch.py\", line 55\r\n    reindent=True,\r\n    ^^^^^^^^^^^^^\r\nSyntaxError: keyword argument repeated: reindent\r\n"]
[68.426631, "o", "\u001b[?2004h"]
[68.426651, "o", "root@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[74.927248, "i", "sed -i 's/sqlparse.format(parsed, /sqlparse.format(parsed)/g' /home/user/db_queries/process_batch.py\n"]
[74.927585, "o", "sed -i 's/sqlparse.format(parsed, /sqlparse.format(parsed)/g' /home/user/db_queries/process_batch.py\r\n\u001b[?2004l\r"]
[74.929121, "o", "\u001b[?2004hroot@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[75.761484, "i", "sed -i 's/keyword_case='upper',/keyword_case='upper'/g' /home/user/db_queries/process_batch.py\n"]
[75.761799, "o", "sed -i 's/keyword_case='upper',/keyword_case='upper'/g' /home/user/db_queries/process_batch.py\r\n\u001b[?2004l\r"]
[75.763919, "o", "\u001b[?2004h"]
[75.763966, "o", "root@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[76.151996, "i", "/home/user/.venvs/opt_queries/bin/python /home/user/db_queries/process_batch.py\n"]
[76.152248, "o", "/home/user/.venvs/opt_queries/bin/python /home/user/db_queries/process_batch.py\r\n\u001b[?2004l\r"]
[76.159674, "o", "  File \"/home/user/db_queries/process_batch.py\", line 51\r\n    keyword_case='upper', \r\n"]
[76.159737, "o", "IndentationError: unexpected indent\r\n"]
[76.161027, "o", "\u001b[?2004hroot@36b070fb-d075-422d-b207-f735c3f0b34d:~# "]
[133.205685, "i", "sed -i '/formatted = sqlparse.format/a\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\"]
[133.205728, "i", "t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t"]
[133.205913, "i", "\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\"]
[133.205929, "i", "\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t●●●●t\\\\t●●●●t\\\\t●●●●t\\\\t●●●●t\\\\t●●●●t\\\\t●●●●t\\\\t●●●●t●●●●t\\\\t●●●●t●●●●t\\\\t●●●●t●●●●t\\\\t●●●●t●●●●t\\\\t●●●●t●●●●t\\\\t●●●●t●●●●t●●\n"]
[133.213769, "o", "sed -i '/formatted = sqlparse.format/a\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\"]
[133.213795, "o", "t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t"]
[133.213872, "o", "\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\"]
[133.213886, "o", "\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t\\\\t●●●●t\\\\t●●●●t\\\\t●●●●t\\\\t●●●●t\\\\t●●●●t\\\\t●●●●t\\\\t●●●●t●●●●t\\\\t●●●●t●●●●t\\\\t●●●●t●●●●t\\\\t●●●●t●●●●t\\\\t●●●●t●●●●t\\\\t●●●●t●●●●t●●\r\n\u001b[?2004l\r\u001b[?2004h> "]
[133.30047, "i", "/home/user/.venvs/opt_queries/bin/python /home/user/db_queries/process_batch.py\n"]
[133.300718, "o", "/home/user/.venvs/opt_queries/bin/python /home/user/db_queries/process_batch.py\r\n\u001b[?2004l\r"]
[133.30077, "o", "\u001b[?2004h> "]
[159.229441, "i", "cat > /home/user/db_queries/process_batch.py << 'EOF'\n#!/usr/bin/env python3\n\nimport os\nimport hashlib\nimport sqlparse\nimport json\n\ndef process_queries():\n    batch_id = os.environ.get('DB_BATCH_ID', '42')\n    \n    input_file = f\"/home/user/db_queries/raw_batch_{batch_id}.sql\"\n    backup_file = f\"/home/user/db_queries/raw_batch_{batch_id}_backup.sql\"\n    read_output = f\"/home/user/db_queries/batch_{batch_id}_optimized_read.sql\"\n    write_output = f\"/home/user/db_queries/batch_{batch_id}_optimized_write.sql\"\n    manifest_file = f\"/home/user/db_queries/batch_{batch_id}_manifest.json\"\n    log_file = f\"/home/user/db_queries/batch_{batch_id}_pipeline.log\"\n    \n    with open(input_file, 'r') as f:\n        raw_sql = f.read()\n    \n    with open(backup_file, 'w') as f:\n        f.write(raw_sql)\n    \n    queries = sqlparse.split(raw_sql)\n    total_queries = len(queries)\n    read_queries = []\n    write_queries = []\n    \n    for query in queries:\n        if not query.strip():\n            continue\n            \n        orig"]
[159.229558, "i", "inal_query = query.strip()\n        md5_hash = hashlib.md5(original_query.encode()).hexdigest()\n        \n        parsed = sqlparse.parse(original_query)[0]\n        formatted = sqlparse.format(parsed, keyword_case='upper')\n        \n        optimized = formatted.replace('\\n', ' ').strip() + f' -- id={md5_hash}'\n        \n        first_token = str(parsed.tokens[0]).upper()\n        if first_token.startswith('SELECT'):\n            read_queries.append(f\"{optimized};\\n\")\n        else:\n            write_queries.append(f\"{optimized};\\n\")\n    \n    with open(read_output, 'w') as f:\n        f.writelines(read_queries)\n    \n    with open(write_output, 'w') as f:\n        f.writelines(write_queries)\n    \n    manifest = {\n        \"batch_id\": batch_id,\n        \"read_count\": len(read_queries),\n        \"write_count\": len(write_queries)\n    }\n    with open(manifest_file, 'w') as f:\n        json.dump(manifest, f, indent=2)\n    \n    with open(log_file, 'w') as f:\n        f.write(\"PIPELINE START\\n\")\n        f.write(f\"Batch ID: {batch_"]
[159.229601, "i", "id}\\n\")\n        f.write(f\"Input: raw_batch_{batch_id}.sql\\n\")\n        f.write(f\"Processed: {total_queries}\\n\")\n        f.write(\"PIPELINE END\\n\")\n\nif __name__ == \"__main__\":\n    process_queries()\nEOF\n"]
[159.229771, "o", "cat > /home/user/db_queries/process_batch.py << 'EOF'\r\n"]
[159.229799, "o", "\u001b[?2004l\r"]
[159.229891, "o", "\u001b[?2004h> "]
[159.229984, "o", "#!/usr/bin/env python3\r\n\u001b[?2004l\r"]
[159.230026, "o", "\u001b[?2004h"]
[159.230051, "o", "> \r\n\u001b[?2004l\r"]
[159.230073, "o", "\u001b[?2004h"]
[159.230104, "o", "> "]
[159.230137, "o", "import os\r\n\u001b[?2004l\r"]
[159.230168, "o", "\u001b[?2004h"]
[159.230192, "o", "> "]
[159.230256, "o", "import hashlib\r\n\u001b[?2004l\r"]
[159.230285, "o", "\u001b[?2004h"]
[159.230299, "o", "> "]
[159.230379, "o", "import sqlparse\r\n\u001b[?2004l\r"]
[159.230408, "o", "\u001b[?2004h"]
[159.230431, "o", "> "]
[159.230481, "o", "import json\r\n\u001b[?2004l\r"]
[159.230509, "o", "\u001b[?2004h"]
[159.230535, "o", "> \r\n\u001b[?2004l\r"]
[159.230561, "o", "\u001b[?2004h> "]
[159.230679, "o", "def process_queries():\r\n\u001b[?2004l\r"]
[159.230707, "o", "\u001b[?2004h"]
[159.230733, "o", "> "]
[159.230977, "o", "    batch_id = os.environ.get('DB_BATCH_ID', '42')\r\n\u001b[?2004l\r"]
[159.231006, "o", "\u001b[?2004h"]
[159.231031, "o", "> "]
[159.231051, "o", "    \r\n\u001b[?2004l\r"]
[159.231074, "o", "\u001b[?2004h"]
[159.2311, "o", "> "]
[159.231408, "o", "    input_file = f\"/home/user/db_queries/raw_batch_{batch_id}.sql\"\r\n\u001b[?2004l\r"]
[159.231438, "o", "\u001b[?2004h"]
[159.231464, "o", "> "]
[159.231813, "o", "    backup_file = f\"/home/user/db_queries/raw_batch_{batch_id}_backup.sql\"\r\n\u001b[?2004l\r"]
[159.231842, "o", "\u001b[?2004h"]
[159.231867, "o", "> "]
[159.232227, "o", "    read_output = f\"/home/user/db_queries/batch_{batch_id}_optimized_read.sql\"\r\n\u001b[?2004l\r"]
[159.232256, "o", "\u001b[?2004h"]
[159.232283, "o", "> "]
[159.232649, "o", "    write_output = f\"/home/user/db_queries/batch_{batch_id}_optimized_write.sql\"\r\n\u001b[?2004l\r"]
[159.232678, "o", "\u001b[?2004h"]
[159.232701, "o", "> "]
[159.233055, "o", "    manifest_file = f\"/home/user/db_queries/batch_{batch_id}_manifest.json\"\r\n\u001b[?2004l\r"]
[159.23308, "o", "\u001b[?2004h"]
[159.233106, "o", "> "]
[159.233429, "o", "    log_file = f\"/home/user/db_queries/batch_{batch_id}_pipeline.log\"\r\n\u001b[?2004l\r"]
[159.233465, "o", "\u001b[?2004h"]
[159.233492, "o", "> "]
[159.233515, "o", "    \r\n\u001b[?2004l\r"]
[159.233542, "o", "\u001b[?2004h> "]
[159.233721, "o", "    with open(input_file, 'r') as f:\r\n"]
[159.233744, "o", "\u001b[?2004l\r"]
[159.233777, "o", "\u001b[?2004h> "]
[159.233903, "o", "        raw_sql = f.read()\r\n\u001b[?2004l\r"]
[159.233931, "o", "\u001b[?2004h"]
[159.233954, "o", "> "]
[159.233979, "o", "    \r\n\u001b[?2004l\r"]
[159.234, "o", "\u001b[?2004h"]
[159.234022, "o", "> "]
[159.234194, "o", "    with open(backup_file, 'w') as f:\r\n\u001b[?2004l\r"]
[159.234223, "o", "\u001b[?2004h"]
[159.234245, "o", "> "]
[159.234357, "o", "        f.write(raw_sql)\r\n\u001b[?2004l\r"]
[159.234385, "o", "\u001b[?2004h"]
[159.234409, "o", "> "]
[159.234429, "o", "    \r\n\u001b[?2004l\r"]
[159.234452, "o", "\u001b[?2004h"]
[159.23448, "o", "> "]
[159.23465, "o", "    queries = sqlparse.split(raw_sql)\r\n\u001b[?2004l\r"]
[159.234677, "o", "\u001b[?2004h"]
[159.234702, "o", "> "]
[159.234857, "o", "    total_queries = len(queries)\r\n\u001b[?2004l\r"]
[159.234886, "o", "\u001b[?2004h"]
[159.234912, "o", "> "]
[159.235006, "o", "    read_queries = []\r\n\u001b[?2004l\r"]
[159.235035, "o", "\u001b[?2004h"]
[159.235057, "o", "> "]
[159.23516, "o", "    write_queries = []\r\n\u001b[?2004l\r"]
[159.235188, "o", "\u001b[?2004h"]
[159.235219, "o", "> "]
[159.235245, "o", "    \r\n\u001b[?2004l\r"]
[159.235268, "o", "\u001b[?2004h> "]
[159.235397, "o", "    for query in queries:\r\n\u001b[?2004l\r"]
[159.235426, "o", "\u001b[?2004h"]
[159.235449, "o", "> "]
[159.235584, "o", "        if not query.strip():\r\n\u001b[?2004l\r"]
[159.235613, "o", "\u001b[?2004h"]
[159.235636, "o", "> "]
[159.235727, "o", "            continue\r\n"]
[159.235751, "o", "\u001b[?2004l\r\u001b[?2004h"]
[159.235777, "o", "> "]
[159.235843, "o", "            \r\n\u001b[?2004l\r"]
[159.235869, "o", "\u001b[?2004h"]
[159.235891, "o", "> "]
[159.236067, "o", "        original_query = query.strip()\r\n\u001b[?2004l\r"]
[159.236096, "o", "\u001b[?2004h"]
[159.236119, "o", "> "]
[159.236437, "o", "        md5_hash = hashlib.md5(original_query.encode()).hexdigest()\r\n"]
[159.236459, "o", "\u001b[?2004l\r"]
[159.236481, "o", "\u001b[?2004h> "]
[159.236531, "o", "        \r\n"]
[159.236553, "o", "\u001b[?2004l\r\u001b[?2004h"]
[159.236579, "o", "> "]
[159.236821, "o", "        parsed = sqlparse.parse(original_query)[0]\r\n\u001b[?2004l\r"]
[159.236856, "o", "\u001b[?2004h"]
[159.236878, "o", "> "]
[159.237183, "o", "        formatted = sqlparse.format(parsed, keyword_case='upper')\r\n\u001b[?2004l\r"]
[159.237214, "o", "\u001b[?2004h"]
[159.237236, "o", "> "]
[159.237274, "o", "        \r\n\u001b[?2004l\r"]
[159.237302, "o", "\u001b[?2004h"]
[159.237331, "o", "> "]
[159.237691, "o", "        optimized = formatted.replace('\\n', ' ').strip() + f' -- id={md5_hash}'\r\n\u001b[?2004l\r"]
[159.237725, "o", "\u001b[?2004h"]
[159.237746, "o", "> "]
[159.237789, "o", "        \r\n\u001b[?2004l\r"]
[159.237816, "o", "\u001b[?2004h"]
[159.237838, "o", "> "]
[159.238075, "o", "        first_token = str(parsed.tokens[0]).upper()\r\n\u001b[?2004l\r"]
[159.238107, "o", "\u001b[?2004h"]
[159.238131, "o", "> "]
[159.238345, "o", "        if first_token.startswith('SELECT'):\r\n\u001b[?2004l\r"]
[159.238373, "o", "\u001b[?2004h"]
[159.238396, "o", "> "]
[159.238647, "o", "            read_queries.append(f\"{optimized};\\n\")\r\n\u001b[?2004l\r"]
[159.238711, "o", "\u001b[?2004h> "]
[159.238768, "o", "        else:\r\n\u001b[?2004l\r"]
[159.238823, "o", "\u001b[?2004h> "]
[159.239055, "o", "            write_queries.append(f\"{optimized};\\n\")\r\n\u001b[?2004l\r"]
[159.239101, "o", "\u001b[?2004h> "]
[159.239137, "o", "    \r\n\u001b[?2004l\r"]
[159.239172, "o", "\u001b[?2004h> "]
[159.239392, "o", "    with open(read_output, 'w') as f:\r\n\u001b[?2004l\r"]
[159.23943, "o", "\u001b[?2004h"]
[159.239458, "o", "> "]
[159.239625, "o", "        f.writelines(read_queries)\r\n\u001b[?2004l\r"]
[159.239662, "o", "\u001b[?2004h> "]
[159.239696, "o", "    \r\n\u001b[?2004l\r"]
[159.239731, "o", "\u001b[?2004h"]
[159.239777, "o", "> "]
[159.23993, "o", "    with open(write_output, 'w') as f:\r\n\u001b[?2004l\r"]
[159.239958, "o", "\u001b[?2004h"]
[159.239992, "o", "> "]
[159.240142, "o", "        f.writelines(write_queries)\r\n\u001b[?2004l\r"]
[159.240176, "o", "\u001b[?2004h"]
[159.240206, "o", "> "]
[159.240245, "o", "    \r\n\u001b[?2004l\r"]
[159.240281, "o", "\u001b[?2004h> "]
[159.240334, "o", "    manifest = {\r\n\u001b[?2004l\r"]
[159.24037, "o", "\u001b[?2004h> "]
[159.240518, "o", "        \"batch_id\": batch_id,\r\n\u001b[?2004l\r"]
[159.240545, "o", "\u001b[?2004h"]
[159.240577, "o", "> "]
[159.240755, "o", "        \"read_count\": len(read_queries),\r\n\u001b[?2004l\r"]
[159.240793, "o", "\u001b[?2004h"]
[159.240827, "o", "> "]
[159.241005, "o", "        \"write_count\": len(write_queries)\r\n\u001b[?2004l\r"]
[159.241033, "o", "\u001b[?2004h"]
[159.241066, "o", "> "]
[159.241098, "o", "    }\r\n"]
[159.241132, "o", "\u001b[?2004l\r\u001b[?2004h> "]
[159.241312, "o", "    with open(manifest_file, 'w') as f:\r\n\u001b[?2004l\r"]
[159.24134, "o", "\u001b[?2004h"]
[159.241373, "o", "> "]
[159.241549, "o", "        json.dump(manifest, f, indent=2)\r\n\u001b[?2004l\r"]
[159.241578, "o", "\u001b[?2004h"]
[159.241603, "o", "> "]
[159.241623, "o", "    \r\n\u001b[?2004l\r"]
[159.241645, "o", "\u001b[?2004h"]
[159.241668, "o", "> "]
[159.241843, "o", "    with open(log_file, 'w') as f:\r\n"]
[159.241867, "o", "\u001b[?2004l\r"]
[159.241889, "o", "\u001b[?2004h> "]
[159.242071, "o", "        f.write(\"PIPELINE START\\n\")\r\n\u001b[?2004l\r"]
[159.242102, "o", "\u001b[?2004h"]
[159.242127, "o", "> "]
[159.242327, "o", "        f.write(f\"Batch ID: {batch_id}\\n\")\r\n"]
[159.242351, "o", "\u001b[?2004l\r"]
[159.242374, "o", "\u001b[?2004h> "]
[159.242641, "o", "        f.write(f\"Input: raw_batch_{batch_id}.sql\\n\")\r\n\u001b[?2004l\r"]
[159.242671, "o", "\u001b[?2004h"]
[159.242695, "o", "> "]
[159.242949, "o", "        f.write(f\"Processed: {total_queries}\\n\")\r\n\u001b[?2004l\r"]
[159.242977, "o", "\u001b[?2004h"]
[159.243, "o", "> "]
[159.243166, "o", "        f.write(\"PIPELINE END\\n\")\r\n"]
[159.24319, "o", "\u001b[?2004l\r"]
[159.243214, "o", "\u001b[?2004h> \r\n"]
[159.243238, "o", "\u001b[?2004l\r\u001b[?2004h"]
[159.243259, "o", "> "]
[159.243399, "o", "if __name__ == \"__main__\":\r\n\u001b[?2004l\r"]
[159.24343, "o", "\u001b[?2004h"]
[159.243453, "o", "> "]
[159.243561, "o", "    process_queries()\r\n\u001b[?2004l\r"]
[159.24359, "o", "\u001b[?2004h"]
[159.243613, "o", "> "]
[159.243635, "o", "EOF\r\n\u001b[?2004l\r"]
[159.243655, "o", "\u001b[?2004h"]
[159.243678, "o", "> "]
[159.655335, "i", "chmod +x /home/user/db_queries/process_batch.py\n"]
[159.655515, "o", "chmod +x /home/user/db_queries/process_batch.py\r\n\u001b[?2004l\r"]
[159.65556, "o", "\u001b[?2004h> "]
[159.807384, "i", "/home/user/.venvs/opt_queries/bin/python /home/user/db_queries/process_batch.py\n"]
[159.807945, "o", "/home/user/.venvs/opt_queries/bin/python /home/user/db_queries/process_batch.py\r\n\u001b[?2004l\r"]
[159.808, "o", "\u001b[?2004h"]
[159.808024, "o", "> "]
[169.62925, "i", "head -2 /home/user/.venvs/opt_queries/requirements.txt\n"]
[169.629438, "o", "head -2 /home/user/.venvs/opt_queries/requirements.txt\r\n\u001b[?2004l\r"]
[169.629486, "o", "\u001b[?2004h> "]
[169.808785, "i", "cat /home/user/db_queries/batch_42_manifest.json\n"]
[169.809257, "o", "cat /home/user/db_queries/batch_42_manifest.json\r\n\u001b[?2004l\r"]
[169.809878, "o", "\u001b[?2004h> "]
[170.23721, "i", "cat /home/user/db_queries/batch_42_pipeline.log\n"]
[170.237514, "o", "cat /home/user/db_queries/batch_42_pipeline.log\r\n\u001b[?2004l\r"]
[170.237576, "o", "\u001b[?2004h> "]
[183.668285, "i", "ls -la /home/user/.venvs/opt_queries/requirements.txt\n"]
[183.668485, "o", "ls -la /home/user/.venvs/opt_queries/requirements.txt\r\n\u001b[?2004l\r"]
[183.668547, "o", "\u001b[?2004h> "]
[183.896039, "i", "ls -la /home/user/db_queries/batch_42_*.json\n"]
[183.896412, "o", "ls -la /home/user/db_queries/batch_42_*.json\r\n"]
[183.896456, "o", "\u001b[?2004l\r"]
[183.896484, "o", "\u001b[?2004h"]
[183.896509, "o", "> "]
[184.010895, "i", "ls -la /home/user/db_queries/batch_42_*.log\n"]
[184.01106, "o", "ls -la /home/user/db_queries/batch_42_*.log\r\n"]
[184.011088, "o", "\u001b[?2004l\r"]
[184.011109, "o", "\u001b[?2004h> "]
[184.216865, "i", "cat /home/user/.venvs/opt_queries/requirements.txt\n"]
[184.217073, "o", "cat /home/user/.venvs/opt_queries/requirements.txt\r\n\u001b[?2004l\r"]
[184.217132, "o", "\u001b[?2004h> "]
[184.356486, "i", "cat /home/user/db_queries/batch_42_manifest.json\n"]
[184.356926, "o", "cat /home/user/db_queries/batch_42_manifest.json\r\n\u001b[?2004l\r"]
[184.357, "o", "\u001b[?2004h> "]
[184.514623, "i", "cat /home/user/db_queries/batch_42_pipeline.log\n"]
[184.515048, "o", "cat /home/user/db_queries/batch_42_pipeline.log\r\n\u001b[?2004l\r"]
[184.515124, "o", "\u001b[?2004h"]
[184.515164, "o", "> "]
[193.520227, "i", "exit\n"]
[193.520401, "o", "exit\r\n\u001b[?2004l\r"]
[193.520453, "o", "\u001b[?2004h> "]
[193.61287, "i", "cat /home/user/.venvs/opt_queries/requirements.txt\n"]
[193.613218, "o", "cat /home/user/.venvs/opt_queries/requirements.txt\r\n\u001b[?2004l\r"]
[193.613271, "o", "\u001b[?2004h"]
[193.613311, "o", "> "]
[193.818844, "i", "cat /home/user/db_queries/batch_42_manifest.json\n"]
[193.819189, "o", "cat /home/user/db_queries/batch_42_manifest.json\r\n\u001b[?2004l\r"]
[193.819269, "o", "\u001b[?2004h> "]
[193.912182, "i", "cat /home/user/db_queries/batch_42_pipeline.log\n"]
[193.912351, "o", "cat /home/user/db_queries/batch_42_pipeline.log\r\n\u001b[?2004l\r"]
[193.912403, "o", "\u001b[?2004h> "]
[206.743467, "i", "pwd\n"]
[206.743563, "o", "pwd\r\n\u001b[?2004l\r"]
[206.743595, "o", "\u001b[?2004h> "]
[206.890917, "i", "ls -la /home/user/.venvs/opt_queries/requirements.txt\n"]
[206.891137, "o", "ls -la /home/user/.venvs/opt_queries/requirements.txt\r\n"]
[206.891171, "o", "\u001b[?2004l\r"]
[206.891197, "o", "\u001b[?2004h> "]
[206.992532, "i", "cat /home/user/.venvs/opt_queries/requirements.txt\n"]
[206.992738, "o", "cat /home/user/.venvs/opt_queries/requirements.txt\r\n\u001b[?2004l\r"]
[206.99279, "o", "\u001b[?2004h"]
[206.992813, "o", "> "]
[207.095381, "i", "ls -la /home/user/db_queries/batch_42_manifest.json\n"]
[207.095544, "o", "ls -la /home/user/db_queries/batch_42_manifest.json\r\n"]
[207.095556, "o", "\u001b[?2004l\r"]
[207.095607, "o", "\u001b[?2004h> "]
[207.212937, "i", "cat /home/user/db_queries/batch_42_manifest.json\n"]
[207.213096, "o", "cat /home/user/db_queries/batch_42_manifest.json\r\n"]
[207.213123, "o", "\u001b[?2004l\r"]
[207.213144, "o", "\u001b[?2004h> "]
[207.376368, "i", "ls -la /home/user/db_queries/batch_42_pipeline.log\n"]
[207.376539, "o", "ls -la /home/user/db_queries/batch_42_pipeline.log\r\n"]
[207.376574, "o", "\u001b[?2004l\r\u001b[?2004h"]
[207.376601, "o", "> "]
[207.589716, "i", "cat /home/user/db_queries/batch_42_pipeline.log\n"]
[207.590043, "o", "cat /home/user/db_queries/batch_42_pipeline.log\r\n\u001b[?2004l\r"]
[207.590117, "o", "\u001b[?2004h> "]
[213.923229, "i", "echo \"Test shell\"\n"]
[213.923407, "o", "echo \"Test shell\"\r\n"]
[213.92347, "o", "\u001b[?2004l\r\u001b[?2004h"]
[213.923503, "o", "> "]
