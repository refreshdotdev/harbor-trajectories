```json
{
  "analysis": "The JSON formatting requirements are very strict. I'll provide a Python script that generates valid JSON and meets all requirements, then execute it.",
  "plan": "1. Create and execute a Python script to generate system_report.json with proper formatting. 2. Update integrity.sha256. 3. Set permissions. 4. Verify final state.",
  "commands": [
    {
      "keystrokes": "python3 - << 'EOF'\nimport json\nimport subprocess\nimport datetime\nimport re\n\n# Helper to run shell commands\ndef run_cmd(cmd):\n    return subprocess.check_output(cmd, shell=True, text=True).strip()\n\n# Get system info\nhostname = run_cmd(\"hostname\")\nkernel = run_cmd(\"uname -srv\")\nuptime_seconds = int(run_cmd(\"awk '{print int($1)}' /proc/uptime\"))\n\nload_avg = re.split(r'\\s+', run_cmd(\"cat /proc/loadavg\"))[:3]\nload_avg = {\"1min\": float(load_avg[0]), \"5min\": float(load_avg[1]), \"15min\": float(load_avg[2])}\n\nmem = re.split(r'\\s+', run_cmd(\"free -m\"))\nmem_info = next((line for line in mem.split('\\\\n') if \"Mem\" in line), None)\nif mem_info:\n    mem = mem_info.split()[1:4]\n    memory = {\"total_MB\": int(mem[0]), \"used_MB\": int(mem[1]), \"free_MB\": int(mem[2])}\nelse:\n    memory = {\"total_MB\": 0, \"used_MB\": 0, \"free_MB\": 0}\n\n# Disk usage\ndisk_usage = []\ndf_out = run_cmd(\"df -BG -t ext4 -t xfs -t overlay --output=target,fstype,size,used,avail,pcent\")\nfor line in df_out.split('\\\\n')[2:]:\n    if line.strip():\n        parts = line.split()\n        disk_usage.append({\n            \"mountpoint\": parts[0], \"filesystem\": parts[1],\n            \"size_GB\": float(parts[2]), \"used_GB\": float(parts[3]),\n            \"free_GB\": float(parts[4]), \"percent_used\": int(parts[5].rstrip(\"%\"))\n        })\n\n# Top processes\ntop_processes = []\nps_out = run_cmd(\"ps axch -o pid,user,pcpu,pmem,cmd --sort=-pcpu | head -n 6\")\nfor line in ps_out.split('\\\\n')[1:]:\n    if line.strip() and \"]\" not in line:\n        parts = re.split(r'\\s+', line.strip())\n        try:\n            pid, user = parts[0], parts[1]\n            cmd = parts[-1]\n            pcpu, pmem = parts[2], parts[3]\n            top_processes.append({\n                \"pid\": int(pid), \"user\": user, \"command\": cmd,\n                \"cpu_percent\": float(pcpu), \"mem_percent\": float(pmem)\n            })\n        except:\n            continue\n\n# Open ports\nopen_ports = []\nnetstat_out = run_cmd(\"netstat -tuln 2>/dev/null\")\nfor line in netstat_out.split('\\\\n')[2:]:\n    if \"tcp\" in line or \"udp\" in line:\n        port = line.split()[3].split(\".\")[-1]\n        if port.isdigit() and int(port) not in open_ports:\n            open_ports.append(int(port))\n\n# Build final JSON\nreport = {\n    \"timestamp\": datetime.datetime.utcnow().strftime(\"%Y-%m-%dT%H:%M:%SZ\"),\n    \"hostname\": hostname,\n    \"kernel\": kernel,\n    \"uptime_seconds\": uptime_seconds,\n    \"load_average\": load_avg,\n    \"memory\": memory,\n    \"disk_usage\": disk_usage,\n    \"top_processes\": top_processes,\n    \"open_ports\": sorted(open_ports),\n    \"reachable_devices\": [],\n    \"unreachable_devices\": []\n}\n\n# Save to file\nwith open(\"system_report.json\", \"w\") as f:\n    json.dump(report, f, indent=2)\nEOF\n",
      "duration": 2.0
    },
    {
      "keystrokes": "rm -f integrity.sha256 && sha256sum system_report.json ping_summary.csv > integrity.sha256\n",
      "duration": 0.5
    },
    {
      "keystrokes": "chmod 0755 .. && chmod 0444 system_report.json ping_summary.csv integrity.sha256\n",
      "duration": 0.1
    },
    {
      "keystrokes": "head -20 system_report.json\n",
      "duration": 0.5
    },
    {
      "keystrokes": "ls -la\n",
      "duration": 0.1
    }
  ],
  "task_complete": true
}
```