{"version": 2, "width": 160, "height": 40, "timestamp": 1771009564, "env": {"SHELL": "/bin/bash", "TERM": "screen"}}
[0.005969, "o", "\u001b[?2004hroot@4284dd59-e5ec-4b38-a78c-499a22b0095e:~# "]
[1.011852, "i", "clear\r"]
[1.011987, "o", "clear\r\n\u001b[?2004l\r"]
[1.012949, "o", "\u001b[H\u001b[J"]
[1.013142, "o", "\u001b[?2004h"]
[1.013174, "o", "root@4284dd59-e5ec-4b38-a78c-499a22b0095e:~# "]
[14.479068, "i", "cd /home/user\n"]
[14.479237, "o", "cd /home/user\r\n\u001b[?2004l\r"]
[14.479294, "o", "\u001b[?2004hroot@4284dd59-e5ec-4b38-a78c-499a22b0095e:/home/user# "]
[14.646152, "i", "mkdir -p diag\n"]
[14.646299, "o", "mkdir -p diag\r\n\u001b[?2004l\r"]
[14.647545, "o", "\u001b[?2004h"]
[14.647567, "o", "root@4284dd59-e5ec-4b38-a78c-499a22b0095e:/home/user# "]
[14.723534, "i", "grep -oP 'current_badge_id[^=]*=\\s*\\K[^#]+' app/config/system_settings.conf | tr -d ' \r\n'\n"]
[14.723861, "o", "grep -oP 'current_badge_id[^=]*=\\s*\\K[^#]+' app/config/system_settings.conf | tr -d ' \r\n"]
[14.723888, "o", "\u001b[?2004l\r"]
[14.723951, "o", "\u001b[?2004h"]
[14.72397, "o", "> \r\n\u001b[?2004l\r"]
[14.723992, "o", "\u001b[?2004h> "]
[14.72401, "o", "'\r\n\u001b[?2004l\r"]
[14.72591, "o", "OMEGA-99-XRAY"]
[14.726121, "o", "\u001b[?2004h"]
[14.726169, "o", "root@4284dd59-e5ec-4b38-a78c-499a22b0095e:/home/user# "]
[28.189422, "i", "export DAILY_BADGE_ID=\"OMEGA-99-XRAY\"\n"]
[28.189839, "o", "export DAILY_BADGE_ID=\"OMEGA-99-XRAY\"\r\n\u001b[?2004l\r"]
[28.190001, "o", "\u001b[?2004h"]
[28.190033, "o", "root@4284dd59-e5ec-4b38-a78c-499a22b0095e:/home/user# "]
[28.331414, "i", "find app/logs -type f -size +512c -mtime -7 ! -path \"*/test/*\" ! -path \"*/mock/*\" ! -path \"*/staging/*\" -print0 > diag/files_to_scan.txt\n"]
[28.332434, "o", "find app/logs -type f -size +512c -mtime -7 ! -path \"*/test/*\" ! -path \"*/mock/*\" ! -path \"*/staging/*\" -print0 > diag/files_to_scan.txt\r\n\u001b[?2004l\r"]
[28.335629, "o", "\u001b[?2004h"]
[28.33566, "o", "root@4284dd59-e5ec-4b38-a78c-499a22b0095e:/home/user# "]
[68.786256, "i", "cd /home/user/app/logs\n"]
[68.786531, "o", "cd /home/user/app/logs\r\n\u001b[?2004l\r"]
[68.78671, "o", "\u001b[?2004h"]
[68.786753, "o", "root@4284dd59-e5ec-4b38-a78c-499a22b0095e:/home/user/app/logs# "]
[68.905584, "i", "manifest=(); tar_args=(); while IFS= read -r -d '' filepath; do if grep -q \"[SECURITY-AUDIT-FAIL]\" \"$filepath\" 2>/dev/null; then filename=$(basename -- \"$filepath\"); relative_path=\"${filepath#/home/user/app/logs/}\"; file_size=$(stat -c%s \"$filepath\"); hmac_signature=$(printf '%s' \"\\$(cat -- \"$filepath\")\" | hmac_sha256=\"${DAILY_BADGE_ID}\" sha256sum -b | cut -d' ' -f1); manifest+=\"{\\\"filepath\\\":\\\"$filepath\\\",\\\"size\\\":$file_size,\\\"signature\\\":\\\"$hmac_signature\\\"},\"; tar_args+=(\"-C\" \".\" \"$relative_path\"); fi; done < ../../diag/files_to_scan.txt\n"]
[68.909132, "o", "manifest=(); tar_args=(); while IFS= read -r -d '' filepath; do if grep -q \"[SECURITY-AUDIT-FAIL]\" \"$filepath\" 2>/dev/null; then filename=$(basename -- \"$filepath\"); relative_path=\"${filepath#/home/user/app/logs/}\"; file_size=$(stat -c%s \"$filepath\"); hmac_signature=$(printf '%s' \"\\$(cat -- \"$filepath\")\" | hmac_sha256=\"${DAILY_BADGE_ID}\" sha256sum -b | cut -d' ' -f1); manifest+=\"{\\\"filepath\\\":\\\"$filepath\\\",\\\"size\\\":$file_size,\\\"signature\\\":\\\"$hmac_signature\\\"},\"; tar_args+=(\"-C\" \".\" \"$relative_path\"); fi; done < ../../diag/files_to_scan.txt\r\n\u001b[?2004l\r"]
[68.915838, "o", "\u001b[?2004h"]
[68.915894, "o", "root@4284dd59-e5ec-4b38-a78c-499a22b0095e:/home/user/app/logs# "]
[86.120723, "i", "if [ ${#tar_args[@]} -gt 0 ]; then tar -czf ../../diag/forensic_bundle.tar.gz \"${tar_args[@]}\"; else touch ../../diag/forensic_bundle.tar.gz; fi\n"]
[86.12124, "o", "if [ ${#tar_args[@]} -gt 0 ]; then tar -czf ../../diag/forensic_bundle.tar.gz \"${tar_args[@]}\"; else touch ../../diag/forensic_bundle.tar.gz; fi\r\n\u001b[?2004l\r"]
[86.12272, "o", "\u001b[?2004hroot@4284dd59-e5ec-4b38-a78c-499a22b0095e:/home/user/app/logs# "]
[88.044329, "i", "IFS=',' sorted_manifest=($(printf '%s' \"${manifest%,}\" | sort)); printf '%s\n' \"[${sorted_manifest[*]}]\" > ../../diag/custody_manifest.json\n"]
[88.044644, "o", "IFS=',' sorted_manifest=($(printf '%s' \"${manifest%,}\" | sort)); printf '%s\r\n\u001b[?2004l\r"]
[88.044667, "o", "\u001b[?2004h> "]
[88.044846, "o", "' \"[${sorted_manifest[*]}]\" > ../../diag/custody_manifest.json\r\n\u001b[?2004l\r"]
[88.046937, "o", "\u001b[?2004hroot@4284dd59-e5ec-4b38-a78c-499a22b0095e:/home/user/app/logs# "]
[89.053785, "i", "ls -la ../../diag/\n"]
[89.053902, "o", "ls -la ../../diag/\r\n\u001b[?2004l\r"]
[89.055761, "o", "total 8\r\n"]
[89.055822, "o", "drwxr-xr-x 1 root root 106 Feb 13 19:07 \u001b[0m\u001b[01;34m.\u001b[0m\r\ndrwxr-xr-x 1 root root  26 Feb 13 00:03 \u001b[01;34m..\u001b[0m\r\n"]
[89.055862, "o", "-rw-r--r-- 1 root root   3 Feb 13 19:07 custody_manifest.json\r\n-rw-r--r-- 1 root root  93 Feb 13 19:06 files_to_scan.txt\r\n-rw-r--r-- 1 root root   0 Feb 13 19:07 \u001b[01;31mforensic_bundle.tar.gz\u001b[0m\r\n"]
[89.056257, "o", "\u001b[?2004hroot@4284dd59-e5ec-4b38-a78c-499a22b0095e:/home/user/app/logs# "]
