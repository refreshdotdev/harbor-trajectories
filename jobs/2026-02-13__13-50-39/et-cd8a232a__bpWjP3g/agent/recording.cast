{"version": 2, "width": 160, "height": 40, "timestamp": 1771008649, "env": {"SHELL": "/bin/bash", "TERM": "screen"}}
[0.00511, "o", "\u001b[?2004hroot@a6c8e3be-6726-4ee5-9f78-2c5dba1b4482:/home/user# "]
[0.93106, "i", "clear\r"]
[0.93116, "o", "clear\r\n\u001b[?2004l\r"]
[0.932173, "o", "\u001b[H\u001b[J"]
[0.932371, "o", "\u001b[?2004hroot@a6c8e3be-6726-4ee5-9f78-2c5dba1b4482:/home/user# "]
[49.494105, "i", "mkdir -p /home/user/scripts\n"]
[49.494231, "o", "mkdir -p /home/user/scripts\r\n\u001b[?2004l\r"]
[49.495564, "o", "\u001b[?2004hroot@a6c8e3be-6726-4ee5-9f78-2c5dba1b4482:/home/user# "]
[49.631893, "i", "cd /home/user/scripts\n"]
[49.632025, "o", "cd /home/user/scripts\r\n\u001b[?2004l\r"]
[49.632063, "o", "\u001b[?2004h"]
[49.632089, "o", "root@a6c8e3be-6726-4ee5-9f78-2c5dba1b4482:/home/user/scripts# "]
[49.798911, "i", "cat > filter_errors.sh << 'EOF'\n#!/bin/bash\n\n# Validate arguments\nif [ \"$#\" -ne 2 ]; then\n    echo \"Usage: $0 <input_log> <output_dir>\" >&2\n    exit 1\nfi\n\ninput_log=\"$1\"\noutput_dir=\"$2\"\n\n# Create output directory\nmkdir -p \"$output_dir\"\n\n# Get absolute paths\ntarget_log=$(realpath \"$input_log\")\ntarget_dir=$(realpath \"$output_dir\")\n\n# Initialize variables\ncategories=()\nentries=()\n\n# Process log file\nawk -v target_log=\"$target_log\" -v output_dir=\"$output_dir\" '\nBEGIN {\n    in_entry=0\n    current_entry=\"\"\n    current_category=\"\"\n    category_found=0\n    email_regex=\"[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}\"\n}\n/^[0-9]{4}-[0-9]{2}-[0-9]{2}/ {\n    if (in_entry == 1) {\n        if (category_found == 1) {\n            entries[length(entries)+1] = current_entry\n            categories[length(categories)+1] = current_category\n        }\n        current_entry = $0\n        in_entry = 1\n        category_found = 0\n        current_category = \"\"\n    } else {\n        current_entry = $0\n        in_entry = 1\n        category_fo"]
[49.79895, "i", "und = 0\n        current_category = \"\"\n    }\n    \n    # Check for matching patterns\n    if ($0 ~ /^ERROR/) {\n        current_category = \"FATAL\"\n        category_found = 1\n    }\n    if ($0 ~ /Payment failed/ && current_category == \"\") {\n        current_category = \"PAYMENT_FAILURE\"\n        category_found = 1\n    }\n    if ($0 ~ /^HTTP\\/1\\.1 5[0-9]{2}/ && current_category == \"\") {\n        current_category = \"HTTP_5XX\"\n        category_found = 1\n    }\n    if ($0 ~ /^FATAL/ && current_category == \"\") {\n        current_category = \"FATAL\"\n        category_found = 1\n    }\n} \n!/^([0-9]{4}-[0-9]{2}-[0-9]{2})/ && in_entry == 1 {\n    current_entry = current_entry \"\\n\" $0\n}\nEND {\n    if (in_entry == 1 && category_found == 1) {\n        entries[length(entries)+1] = current_entry\n        categories[length(categories)+1] = current_category\n    }\n    \n    # Write redacted content to file\n    printf \"# Source: %s\\n\", target_log > \"output_dir/critical_errors.log\"\n    for (i=1; i<=length(entries); i++) {\n        # Redact emails\n   "]
[49.798976, "i", "     gsub(email_regex, \"<REDACTED>\", entries[i])\n        print entries[i] >> \"output_dir/critical_errors.log\"\n    }\n    \n    # Count categories\n    counts[\"PAYMENT_FAILURE\"] = 0\n    counts[\"HTTP_5XX\"] = 0\n    counts[\"FATAL\"] = 0\n    for (i=1; i<=length(categories); i++) {\n        counts[categories[i]]++\n    }\n    \n    # Write CSV\n    printf \"error_category,count\\n\" > \"output_dir/error_summary.csv\"\n    for (cat in counts) {\n        if (counts[cat] > 0) {\n            print cat \",\" counts[cat] >> \"output_dir/error_summary.csv\"\n        }\n    }\n    \n    # Sort CSV\n    system(\"sort -t, -k2,2nr -k1,1 output_dir/error_summary.csv -o output_dir/error_summary.csv\")\n}' \"${target_log}\"\n\n# Log execution\ndate +\"%Y-%m-%d|%H:%M:%S\" | awk -v input=\"${target_log}\" -v output=\"${target_dir}\" '{print $0 \"|input=\" input \"|output_dir=\" output \"|status=OK\"}' >> /home/user/filter_run.log\nEOF"]
[49.79907, "o", "cat > filter_errors.sh << 'EOF'\r\n\u001b[?2004l\r"]
[49.799187, "o", "\u001b[?2004h> #!/bin/bash\r\n\u001b[?2004l\r\u001b[?2004h> \r\n\u001b[?2004l\r"]
[49.799203, "o", "\u001b[?2004h> "]
[49.799281, "o", "# Validate arguments\r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.799352, "o", "if [ \"$#\" -ne 2 ]; then\r\n\u001b[?2004l\r"]
[49.799367, "o", "\u001b[?2004h> "]
[49.7995, "o", "    echo \"Usage: $0 <input_log> <output_dir>\" >&2\r\n\u001b[?2004l\r"]
[49.799565, "o", "\u001b[?2004h> "]
[49.799579, "o", "    exit 1\r\n\u001b[?2004l\r"]
[49.799638, "o", "\u001b[?2004h> fi\r\n\u001b[?2004l\r\u001b[?2004h> \r\n\u001b[?2004l\r\u001b[?2004h"]
[49.799651, "o", "> "]
[49.799712, "o", "input_log=\"$1\"\r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.799763, "o", "output_dir=\"$2\"\r\n\u001b[?2004l\r"]
[49.799782, "o", "\u001b[?2004h> \r\n"]
[49.79979, "o", "\u001b[?2004l\r"]
[49.799867, "o", "\u001b[?2004h> "]
[49.79988, "o", "# Create output directory\r\n\u001b[?2004l\r"]
[49.79994, "o", "\u001b[?2004h> "]
[49.799987, "o", "mkdir -p \"$output_dir\"\r\n\u001b[?2004l\r\u001b[?2004h"]
[49.8, "o", "> \r\n\u001b[?2004l\r"]
[49.800059, "o", "\u001b[?2004h> "]
[49.800117, "o", "# Get absolute paths\r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.800201, "o", "target_log=$(realpath \"$input_log\")\r\n\u001b[?2004l\r"]
[49.800219, "o", "\u001b[?2004h> "]
[49.800317, "o", "target_dir=$(realpath \"$output_dir\")\r\n\u001b[?2004l\r"]
[49.800361, "o", "\u001b[?2004h"]
[49.800376, "o", "> \r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.800438, "o", "# Initialize variables\r\n\u001b[?2004l\r\u001b[?2004h"]
[49.800485, "o", "> "]
[49.8005, "o", "categories=()\r\n\u001b[?2004l\r"]
[49.800515, "o", "\u001b[?2004h> "]
[49.800598, "o", "entries=()\r\n\u001b[?2004l\r\u001b[?2004h> \r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.800655, "o", "# Process log file\r\n\u001b[?2004l\r"]
[49.800669, "o", "\u001b[?2004h> "]
[49.800831, "o", "awk -v target_log=\"$target_log\" -v output_dir=\"$output_dir\" '\r\n\u001b[?2004l\r"]
[49.800853, "o", "\u001b[?2004h> "]
[49.80092, "o", "BEGIN {\r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.80097, "o", "    in_entry=0\r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.801033, "o", "    current_entry=\"\"\r\n\u001b[?2004l\r"]
[49.801083, "o", "\u001b[?2004h> "]
[49.801123, "o", "    current_category=\"\"\r\n\u001b[?2004l\r"]
[49.801144, "o", "\u001b[?2004h> "]
[49.801201, "o", "    category_found=0\r\n\u001b[?2004l\r"]
[49.801251, "o", "\u001b[?2004h"]
[49.801273, "o", "> "]
[49.80139, "o", "    email_regex=\"[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}\"\r\n\u001b[?2004l\r"]
[49.801439, "o", "\u001b[?2004h> "]
[49.801454, "o", "}\r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.801542, "o", "/^[0-9]{4}-[0-9]{2}-[0-9]{2}/ {\r\n\u001b[?2004l\r"]
[49.801555, "o", "\u001b[?2004h"]
[49.801565, "o", "> "]
[49.801631, "o", "    if (in_entry == 1) {\r\n\u001b[?2004l\r"]
[49.801677, "o", "\u001b[?2004h"]
[49.801691, "o", "> "]
[49.80175, "o", "        if (category_found == 1) {\r\n\u001b[?2004l\r"]
[49.801776, "o", "\u001b[?2004h> "]
[49.80191, "o", "            entries[length(entries)+1] = current_entry\r\n\u001b[?2004l\r"]
[49.80196, "o", "\u001b[?2004h> "]
[49.802104, "o", "            categories[length(categories)+1] = current_category\r\n\u001b[?2004l\r\u001b[?2004h"]
[49.80218, "o", ">         }\r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.802233, "o", "        current_entry = $0\r\n\u001b[?2004l\r"]
[49.802247, "o", "\u001b[?2004h> "]
[49.802312, "o", "        in_entry = 1\r\n\u001b[?2004l\r\u001b[?2004h"]
[49.802324, "o", "> "]
[49.802385, "o", "        category_found = 0\r\n\u001b[?2004l\r"]
[49.802405, "o", "\u001b[?2004h> "]
[49.802477, "o", "        current_category = \"\"\r\n\u001b[?2004l\r"]
[49.802489, "o", "\u001b[?2004h"]
[49.80255, "o", ">     } else {\r\n\u001b[?2004l\r\u001b[?2004h"]
[49.802562, "o", "> "]
[49.802622, "o", "        current_entry = $0\r\n\u001b[?2004l\r"]
[49.802666, "o", "\u001b[?2004h"]
[49.802679, "o", "> "]
[49.802735, "o", "        in_entry = 1\r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.802776, "o", "        category_found = 0\r\n\u001b[?2004l\r"]
[49.802788, "o", "\u001b[?2004h"]
[49.802843, "o", "> "]
[49.802891, "o", "        current_category = \"\"\r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.802902, "o", "    }\r\n\u001b[?2004l\r"]
[49.802965, "o", "\u001b[?2004h>     \r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.803037, "o", "    # Check for matching patterns\r\n\u001b[?2004l\r"]
[49.803048, "o", "\u001b[?2004h"]
[49.803107, "o", "> "]
[49.803118, "o", "    if ($0 ~ /^ERROR/) {\r\n\u001b[?2004l\r"]
[49.803176, "o", "\u001b[?2004h> "]
[49.803223, "o", "        current_category = \"FATAL\"\r\n\u001b[?2004l\r"]
[49.803236, "o", "\u001b[?2004h"]
[49.803293, "o", "> "]
[49.803343, "o", "        category_found = 1\r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.803387, "o", "    }\r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.803539, "o", "    if ($0 ~ /Payment failed/ && current_category == \"\") {\r\n\u001b[?2004l\r\u001b[?2004h"]
[49.803593, "o", "> "]
[49.803656, "o", "        current_category = \"PAYMENT_FAILURE\"\r\n\u001b[?2004l\r"]
[49.803707, "o", "\u001b[?2004h> "]
[49.803738, "o", "        category_found = 1\r\n\u001b[?2004l\r"]
[49.803753, "o", "\u001b[?2004h"]
[49.803811, "o", ">     }\r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.803953, "o", "    if ($0 ~ /^HTTP\\/1\\.1 5[0-9]{2}/ && current_category == \"\") {\r\n\u001b[?2004l\r"]
[49.803964, "o", "\u001b[?2004h"]
[49.80402, "o", "> "]
[49.804061, "o", "        current_category = \"HTTP_5XX\"\r\n\u001b[?2004l\r"]
[49.804073, "o", "\u001b[?2004h"]
[49.804127, "o", "> "]
[49.804173, "o", "        category_found = 1\r\n\u001b[?2004l\r\u001b[?2004h>     }\r\n\u001b[?2004l\r"]
[49.804219, "o", "\u001b[?2004h> "]
[49.804319, "o", "    if ($0 ~ /^FATAL/ && current_category == \"\") {\r\n\u001b[?2004l\r"]
[49.804329, "o", "\u001b[?2004h"]
[49.804384, "o", "> "]
[49.804429, "o", "        current_category = \"FATAL\"\r\n\u001b[?2004l\r\u001b[?2004h"]
[49.80444, "o", "> "]
[49.80451, "o", "        category_found = 1\r\n\u001b[?2004l\r"]
[49.804529, "o", "\u001b[?2004h"]
[49.804588, "o", ">     }\r\n\u001b[?2004l\r\u001b[?2004h> } \r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.804716, "o", "!/^([0-9]{4}-[0-9]{2}-[0-9]{2})/ && in_entry == 1 {\r\n\u001b[?2004l\r"]
[49.804727, "o", "\u001b[?2004h"]
[49.804784, "o", "> "]
[49.804836, "o", "    current_entry = current_entry \"\\n\" $0\r\n\u001b[?2004l\r"]
[49.804883, "o", "\u001b[?2004h> "]
[49.804931, "o", "}\r\n\u001b[?2004l\r\u001b[?2004h> END {\r\n\u001b[?2004l\r"]
[49.804944, "o", "\u001b[?2004h> "]
[49.80503, "o", "    if (in_entry == 1 && category_found == 1) {\r\n\u001b[?2004l\r"]
[49.805042, "o", "\u001b[?2004h"]
[49.805095, "o", "> "]
[49.80517, "o", "        entries[length(entries)+1] = current_entry\r\n\u001b[?2004l\r"]
[49.805181, "o", "\u001b[?2004h"]
[49.805239, "o", "> "]
[49.805329, "o", "        categories[length(categories)+1] = current_category\r\n\u001b[?2004l\r"]
[49.80534, "o", "\u001b[?2004h"]
[49.805395, "o", ">     }\r\n\u001b[?2004l\r\u001b[?2004h>     \r\n\u001b[?2004l\r"]
[49.805439, "o", "\u001b[?2004h"]
[49.805451, "o", "> "]
[49.805506, "o", "    # Write redacted content to file\r\n\u001b[?2004l\r"]
[49.805517, "o", "\u001b[?2004h"]
[49.805584, "o", "> "]
[49.805707, "o", "    printf \"# Source: %s\\n\", target_log > \"output_dir/critical_errors.log\"\r\n\u001b[?2004l\r"]
[49.805742, "o", "\u001b[?2004h> "]
[49.805824, "o", "    for (i=1; i<=length(entries); i++) {\r\n\u001b[?2004l\r"]
[49.805835, "o", "\u001b[?2004h"]
[49.805891, "o", "> "]
[49.805903, "o", "        # Redact emails\r\n\u001b[?2004l\r"]
[49.805959, "o", "\u001b[?2004h> "]
[49.806043, "o", "        gsub(email_regex, \"<REDACTED>\", entries[i])\r\n\u001b[?2004l\r"]
[49.806054, "o", "\u001b[?2004h"]
[49.806109, "o", "> "]
[49.806205, "o", "        print entries[i] >> \"output_dir/critical_errors.log\"\r\n\u001b[?2004l\r"]
[49.806218, "o", "\u001b[?2004h"]
[49.806229, "o", "> "]
[49.806303, "o", "    }\r\n\u001b[?2004l\r\u001b[?2004h>     \r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.806349, "o", "    # Count categories\r\n\u001b[?2004l\r"]
[49.806362, "o", "\u001b[?2004h> "]
[49.806445, "o", "    counts[\"PAYMENT_FAILURE\"] = 0\r\n\u001b[?2004l\r"]
[49.806457, "o", "\u001b[?2004h"]
[49.806514, "o", "> "]
[49.80654, "o", "    counts[\"HTTP_5XX\"] = 0\r\n\u001b[?2004l\r"]
[49.8066, "o", "\u001b[?2004h> "]
[49.806648, "o", "    counts[\"FATAL\"] = 0\r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.80675, "o", "    for (i=1; i<=length(categories); i++) {\r\n\u001b[?2004l\r"]
[49.806762, "o", "\u001b[?2004h"]
[49.806819, "o", "> "]
[49.806857, "o", "        counts[categories[i]]++\r\n\u001b[?2004l\r\u001b[?2004h"]
[49.806867, "o", "> "]
[49.806926, "o", "    }\r\n\u001b[?2004l\r\u001b[?2004h>     \r\n\u001b[?2004l\r\u001b[?2004h"]
[49.806937, "o", "> "]
[49.806993, "o", "    # Write CSV\r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.807155, "o", "    printf \"error_category,count\\n\" > \"output_dir/error_summary.csv\"\r\n\u001b[?2004l\r"]
[49.807169, "o", "\u001b[?2004h> "]
[49.807247, "o", "    for (cat in counts) {\r\n\u001b[?2004l\r\u001b[?2004h"]
[49.8073, "o", "> "]
[49.807349, "o", "        if (counts[cat] > 0) {\r\n\u001b[?2004l\r"]
[49.807395, "o", "\u001b[?2004h"]
[49.80741, "o", "> "]
[49.807567, "o", "            print cat \",\" counts[cat] >> \"output_dir/error_summary.csv\"\r\n\u001b[?2004l\r"]
[49.80758, "o", "\u001b[?2004h"]
[49.807636, "o", ">         }\r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.807686, "o", "    }\r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.807736, "o", "    \r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.807786, "o", "    # Sort CSV\r\n\u001b[?2004l\r"]
[49.807832, "o", "\u001b[?2004h> "]
[49.808032, "o", "    system(\"sort -t, -k2,2nr -k1,1 output_dir/error_summary.csv -o output_dir/error_summary.csv\")\r\n\u001b[?2004l\r"]
[49.808078, "o", "\u001b[?2004h"]
[49.808094, "o", "> "]
[49.808104, "o", "}' \"${target_log}\"\r\n\u001b[?2004l\r"]
[49.808175, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r\u001b[?2004h> "]
[49.808221, "o", "# Log execution\r\n\u001b[?2004l\r\u001b[?2004h"]
[49.808235, "o", "> "]
[49.808676, "o", "date +\"%Y-%m-%d|%H:%M:%S\" | awk -v input=\"${target_log}\" -v output=\"${target_dir}\" '{print $0 \"|input=\" input \"|output_dir=\" output \"|status=OK\"}' >> /home/user/filter_run.log\r\n\u001b[?2004l\r"]
[49.808702, "o", "\u001b[?2004h> "]
[49.808764, "o", "EOF"]
[50.291257, "i", "chmod +x filter_errors.sh\n"]
[50.291445, "o", "chmod +x filter_errors.sh\r\n\u001b[?2004l\r"]
[50.291502, "o", "\u001b[?2004h> "]
[50.413294, "i", "ls -la filter_errors.sh\n"]
[50.413474, "o", "ls -la filter_errors.sh\r\n"]
[50.413559, "o", "\u001b[?2004l\r\u001b[?2004h> "]
[54.85155, "i", "ls -la filter_errors.sh\n"]
[54.851729, "o", "ls -la filter_errors.sh\r\n\u001b[?2004l\r"]
[54.851778, "o", "\u001b[?2004h"]
[54.851835, "o", "> "]
[54.945801, "i", "head -5 filter_errors.sh\n"]
[54.945938, "o", "head -5 filter_errors.sh\r\n\u001b[?2004l\r"]
[54.945979, "o", "\u001b[?2004h> "]
