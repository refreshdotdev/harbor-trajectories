{"version": 2, "width": 160, "height": 40, "timestamp": 1771009538, "env": {"SHELL": "/bin/bash", "TERM": "screen"}}
[0.005482, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[0.919894, "i", "clear\r"]
[0.919997, "o", "clear\r\n\u001b[?2004l\r"]
[0.921054, "o", "\u001b[H\u001b[J"]
[0.921234, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[23.652487, "i", "ls -la /home/user/source_files/\n"]
[23.652703, "o", "ls -la /home/user/source_files/\r\n\u001b[?2004l\r"]
[23.654715, "o", "total 20\r\n"]
[23.654765, "o", "drwxr-xr-x 1 root root  159 Feb 12 23:59  \u001b[0m\u001b[01;34m.\u001b[0m\r\ndrwxr-xr-x 1 root root   34 Feb 12 23:59  \u001b[01;34m..\u001b[0m\r\n-rw------- 1 root root    7 Feb 12 23:59  .secret\r\nlrwxrwxrwx 1 root root   15 Feb 12 23:59  \u001b[40;31;01mbroken_link\u001b[0m -> \u001b[40;31;01m/does/not/exist\u001b[0m\r\n-rw-r--r-- 1 root root   28 Feb 12 23:59  cafÃ©_notes.txt\r\n"]
[23.654802, "o", "-rw-r--r-- 1 root root 2048 Feb 12 23:59 'financials Q4.csv'\r\n-rw-r--r-- 1 root root  500 Feb 12 23:59  ignored_binary.dat\r\nlrwxrwxrwx 1 root root   17 Feb 12 23:59  \u001b[01;36mlink_to_financials.csv\u001b[0m -> 'financials Q4.csv'\r\n-rw-r--r-- 1 root root   27 Feb 12 23:59  policy_doc.txt\r\ndrwxr-xr-x 1 root root   33 Feb 12 23:59  \u001b[01;34msubdir\u001b[0m\r\n"]
[23.655071, "o", "\u001b[?2004h"]
[23.655094, "o", "root@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[24.628714, "i", "mkdir -m 0700 /home/user/audit_2023Q4\n"]
[24.629344, "o", "mkdir -m 0700 /home/user/audit_2023Q4"]
[24.629436, "o", "\r\n\u001b[?2004l\r"]
[24.653588, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[24.739393, "i", "export AUDIT_START_TS=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\n"]
[24.739962, "o", "export AUDIT_START_TS=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\r\n"]
[24.740011, "o", "\u001b[?2004l\r"]
[24.741692, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[24.877627, "i", "echo \"START       : 2023-Q4 checksum verification\" > /home/user/audit_2023Q4/checksum_audit.log\n"]
[24.877994, "o", "echo \"START       : 2023-Q4 checksum verification\" > /home/user/audit_2023Q4/checksum_audit.log\r\n\u001b[?2004l\r"]
[24.878168, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[24.962409, "i", "echo \"START_TIME  : ${AUDIT_START_TS}\" >> /home/user/audit_2023Q4/checksum_audit.log\n"]
[24.962707, "o", "echo \"START_TIME  : ${AUDIT_START_TS}\" >> /home/user/audit_2023Q4/checksum_audit.log\r\n\u001b[?2004l\r"]
[24.962833, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[25.184503, "i", "echo \"FILE_RECORDS\" >> /home/user/audit_2023Q4/checksum_audit.log\n"]
[25.185017, "o", "echo \"FILE_RECORDS\" >> /home/user/audit_2023Q4/checksum_audit.log\r\n\u001b[?2004l\r"]
[25.185226, "o", "\u001b[?2004h"]
[25.185269, "o", "root@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[75.386832, "i", "export SECRET_KEY_CONTENT=$(cat /home/user/source_files/.secret | tr -d '[:space:]')\n"]
[75.38734, "o", "export SECRET_KEY_CONTENT=$(cat /home/user/source_files/.secret | tr -d '[:space:]')\r\n\u001b[?2004l\r"]
[75.390815, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[75.599712, "i", "export AUDIT_FILE_RECORDS=\"\"\n"]
[75.599863, "o", "export AUDIT_FILE_RECORDS=\"\"\r\n\u001b[?2004l\r"]
[75.599944, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[75.671232, "i", "export CURRENT_UTC_DATE=$(date -u +'%Y%m%d')\n"]
[75.671397, "o", "export CURRENT_UTC_DATE=$(date -u +'%Y%m%d')\r\n\u001b[?2004l\r"]
[75.672994, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[75.819351, "i", "export HMAC_KEY_FOR_JSON=\"${SECRET_KEY_CONTENT}${CURRENT_UTC_DATE}\"\n"]
[75.819603, "o", "export HMAC_KEY_FOR_JSON=\"${SECRET_KEY_CONTENT}${CURRENT_UTC_DATE}\"\r\n\u001b[?2004l\r"]
[75.819697, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[75.902159, "i", "unset CONFIG_FILE\n"]
[75.902364, "o", "unset CONFIG_FILE\r\n\u001b[?2004l\r"]
[75.902521, "o", "\u001b[?2004h"]
[75.902575, "o", "root@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[75.999329, "i", "export CONFIG_FILE=\"/home/user/audit_2023Q4/checksum_audit.log\"\n"]
[75.999549, "o", "export CONFIG_FILE=\"/home/user/audit_2023Q4/checksum_audit.log\"\r\n\u001b[?2004l\r"]
[75.999641, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[76.199803, "i", "export AUDIT_FILE_COUNT=0\n"]
[76.199924, "o", "export AUDIT_FILE_COUNT=0\r\n\u001b[?2004l\r"]
[76.200004, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[76.279029, "i", "export TOTAL_BYTES=0\n"]
[76.279221, "o", "export TOTAL_BYTES=0\r\n"]
[76.27926, "o", "\u001b[?2004l\r"]
[76.279367, "o", "\u001b[?2004h"]
[76.279388, "o", "root@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[76.401022, "i", "find /home/user/source_files/ -maxdepth 1 -type f -not -name '.*' -print0 | while IFS= read -r -d '' file_path; do\n  orig_filename=$(basename \"$file_path\")\n  file_size=$(stat -c%s \"$file_path\")\n  if [[ \"${orig_filename##*.}\" == \"txt\" || \"${file_size}\" -ge 1024 ]]; then\n    if [[ -L \"$file_path\" && ! -e \"$file_path\" ]]; then\n      continue\n    fi\n    sha256_hash=$(sha256sum \"$file_path\" | cut -d' ' -f1)\n    md5_hash=$(md5sum \"$file_path\" | cut -d' ' -f1)\n    AUDIT_FILE_RECORDS+=\"${orig_filename} SHA256=${sha256_hash}  MD5=${md5_hash}\\n\"\n    AUDIT_FILE_COUNT=$((AUDIT_FILE_COUNT + 1))\n    TOTAL_BYTES=$((TOTAL_BYTES + file_size))\n  fi\ndone\n"]
[76.40146, "o", "find /home/user/source_files/ -maxdepth 1 -type f -not -name '.*' -print0 | while IFS= read -r -d '' file_path; do\r\n\u001b[?2004l\r"]
[76.401526, "o", "\u001b[?2004h> "]
[76.401673, "o", "  orig_filename=$(basename \"$file_path\")\r\n\u001b[?2004l\r"]
[76.401703, "o", "\u001b[?2004h"]
[76.401738, "o", "> "]
[76.401853, "o", "  file_size=$(stat -c%s \"$file_path\")\r\n\u001b[?2004l\r"]
[76.401877, "o", "\u001b[?2004h"]
[76.401898, "o", "> "]
[76.402137, "o", "  if [[ \"${orig_filename##*.}\" == \"txt\" || \"${file_size}\" -ge 1024 ]]; then\r\n\u001b[?2004l\r"]
[76.402174, "o", "\u001b[?2004h> "]
[76.402332, "o", "    if [[ -L \"$file_path\" && ! -e \"$file_path\" ]]; then\r\n\u001b[?2004l\r"]
[76.402353, "o", "\u001b[?2004h"]
[76.402374, "o", "> "]
[76.402401, "o", "      continue\r\n\u001b[?2004l\r"]
[76.402423, "o", "\u001b[?2004h> "]
[76.402444, "o", "    fi\r\n\u001b[?2004l\r"]
[76.402467, "o", "\u001b[?2004h> "]
[76.402616, "o", "    sha256_hash=$(sha256sum \"$file_path\" | cut -d' ' -f1)\r\n\u001b[?2004l\r"]
[76.402633, "o", "\u001b[?2004h"]
[76.402653, "o", "> "]
[76.402782, "o", "    md5_hash=$(md5sum \"$file_path\" | cut -d' ' -f1)\r\n\u001b[?2004l\r"]
[76.402813, "o", "\u001b[?2004h> "]
[76.403017, "o", "    AUDIT_FILE_RECORDS+=\"${orig_filename} SHA256=${sha256_hash}  MD5=${md5_hash}\\n\"\r\n\u001b[?2004l\r"]
[76.403036, "o", "\u001b[?2004h"]
[76.403057, "o", "> "]
[76.403165, "o", "    AUDIT_FILE_COUNT=$((AUDIT_FILE_COUNT + 1))\r\n\u001b[?2004l\r"]
[76.403187, "o", "\u001b[?2004h> "]
[76.403311, "o", "    TOTAL_BYTES=$((TOTAL_BYTES + file_size))\r\n\u001b[?2004l\r"]
[76.40333, "o", "\u001b[?2004h> "]
[76.403353, "o", "  fi\r\n\u001b[?2004l\r"]
[76.403375, "o", "\u001b[?2004h> "]
[76.403395, "o", "done\r\n\u001b[?2004l\r"]
[76.42759, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[78.545944, "i", "export SORTED_FILE_RECORDS=$(echo -n \"$AUDIT_FILE_RECORDS\" | LC_ALL=C sort)\n"]
[78.546195, "o", "export SORTED_FILE_RECORDS=$(echo -n \"$AUDIT_FILE_RECORDS\" | LC_ALL=C sort)\r\n\u001b[?2004l\r"]
[78.54802, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[79.558367, "i", "echo -n \"$SORTED_FILE_RECORDS\" | iconv -t ISO-8859-1 >> \"$CONFIG_FILE\"\n"]
[79.558765, "o", "echo -n \"$SORTED_FILE_RECORDS\" | iconv -t ISO-8859-1 >> \"$CONFIG_FILE\"\r\n\u001b[?2004l\r"]
[79.560766, "o", "\u001b[?2004h"]
[79.560781, "o", "root@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[80.591612, "i", "export LOG_CONTENT_BEFORE_END_TIME=$(cat \"$CONFIG_FILE\")\n"]
[80.592107, "o", "export LOG_CONTENT_BEFORE_END_TIME=$(cat \"$CONFIG_FILE\")\r\n\u001b[?2004l\r"]
[80.593898, "o", "\u001b[?2004h"]
[80.59394, "o", "root@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[81.133018, "i", "export LOG_CHECKSUM=$(echo -n \"$LOG_CONTENT_BEFORE_END_TIME\" | sha256sum -b | cut -d' ' -f1)\n"]
[81.13371, "o", "export LOG_CHECKSUM=$(echo -n \"$LOG_CONTENT_BEFORE_END_TIME\" | sha256sum -b | cut -d' ' -f1)\r\n\u001b[?2004l\r"]
[81.137163, "o", "\u001b[?2004h"]
[81.137218, "o", "root@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[82.098208, "i", "export LOG_SIG=$(echo -n \"$LOG_CONTENT_BEFORE_END_TIME\" | hmac_sha256 \"${HMAC_KEY_FOR_JSON}\")\n"]
[82.098901, "o", "export LOG_SIG=$(echo -n \"$LOG_CONTENT_BEFORE_END_TIME\" | hmac_sha256 \"${HMAC_KEY_FOR_JSON}\")\r\n\u001b[?2004l\r"]
[82.099967, "o", "bash: hmac_sha256: command not found\r\n"]
[82.100465, "o", "\u001b[?2004h"]
[82.100498, "o", "root@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[83.102566, "i", "export AUDIT_END_TS=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\n"]
[83.102777, "o", "export AUDIT_END_TS=$(date -u +'%Y-%m-%dT%H:%M:%SZ')\r\n\u001b[?2004l\r"]
[83.10424, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[83.195343, "i", "cat > /home/user/audit_2023Q4/summary.json << EOF_JSON\n{\n  \"period\": \"2023-Q4\",\n  \"file_count\": ${AUDIT_FILE_COUNT},\n  \"total_bytes\": ${TOTAL_BYTES},\n  \"start_time\": \"${AUDIT_START_TS}\",\n  \"end_time\": \"${AUDIT_END_TS}\",\n  \"status\": \"COMPLETED\",\n  \"log_checksum\": \"${LOG_CHECKSUM}\",\n  \"signature\": \"${LOG_SIG}\"\n}\nEOF_JSON\n"]
[83.195532, "o", "cat > /home/user/audit_2023Q4/summary.json << EOF_JSON\r\n\u001b[?2004l\r"]
[83.195606, "o", "\u001b[?2004h> {\r\n\u001b[?2004l\r\u001b[?2004h> "]
[83.195673, "o", "  \"period\": \"2023-Q4\",\r\n\u001b[?2004l\r"]
[83.195686, "o", "\u001b[?2004h"]
[83.19576, "o", "> "]
[83.195808, "o", "  \"file_count\": ${AUDIT_FILE_COUNT},\r\n\u001b[?2004l\r"]
[83.195821, "o", "\u001b[?2004h> "]
[83.195908, "o", "  \"total_bytes\": ${TOTAL_BYTES},\r\n\u001b[?2004l\r"]
[83.19592, "o", "\u001b[?2004h"]
[83.195939, "o", "> "]
[83.19603, "o", "  \"start_time\": \"${AUDIT_START_TS}\",\r\n\u001b[?2004l\r"]
[83.196075, "o", "\u001b[?2004h> "]
[83.196148, "o", "  \"end_time\": \"${AUDIT_END_TS}\",\r\n\u001b[?2004l\r"]
[83.19616, "o", "\u001b[?2004h"]
[83.196213, "o", "> "]
[83.196255, "o", "  \"status\": \"COMPLETED\",\r\n\u001b[?2004l\r\u001b[?2004h> "]
[83.196357, "o", "  \"log_checksum\": \"${LOG_CHECKSUM}\",\r\n\u001b[?2004l\r"]
[83.196369, "o", "\u001b[?2004h"]
[83.196421, "o", "> "]
[83.196457, "o", "  \"signature\": \"${LOG_SIG}\"\r\n\u001b[?2004l\r"]
[83.196469, "o", "\u001b[?2004h"]
[83.196516, "o", "> }\r\n\u001b[?2004l\r\u001b[?2004h> "]
[83.196558, "o", "EOF_JSON\r\n\u001b[?2004l\r"]
[83.198319, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[84.191515, "i", "echo \"END_TIME    : ${AUDIT_END_TS}\" >> \"$CONFIG_FILE\"\n"]
[84.191905, "o", "echo \"END_TIME    : ${AUDIT_END_TS}\" >> \"$CONFIG_FILE\"\r\n\u001b[?2004l\r"]
[84.192024, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[84.32543, "i", "echo \"END         : 2023-Q4 checksum verification\" >> \"$CONFIG_FILE\"\n"]
[84.326002, "o", "echo \"END         : 2023-Q4 checksum verification\" >> \"$CONFIG_FILE\"\r\n\u001b[?2004l\r"]
[84.326219, "o", "\u001b[?2004h"]
[84.32628, "o", "root@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[84.427336, "i", "echo \"VERIFICATION_PENDING\" >> \"$CONFIG_FILE\"\n"]
[84.427553, "o", "echo \"VERIFICATION_PENDING\" >> \"$CONFIG_FILE\"\r\n\u001b[?2004l\r"]
[84.427664, "o", "\u001b[?2004h"]
[84.427682, "o", "root@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[252.694777, "i", "which hmac_sha256 || which openssl\n"]
[252.695014, "o", "which hmac_sha256 || which openssl\r\n\u001b[?2004l\r"]
[252.698323, "o", "/usr/bin/openssl\r\n"]
[252.698555, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[253.096591, "i", "export LOG_CONTENT_BEFORE_END_TIME_FINAL=$(cat \"$CONFIG_FILE\" | head -n -1)\n"]
[253.09725, "o", "export LOG_CONTENT_BEFORE_END_TIME_FINAL=$(cat \"$CONFIG_FILE\" | head -n -1)\r\n\u001b[?2004l\r"]
[253.100752, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[253.631664, "i", "export LOG_CHECKSUM_FINAL=$(echo -n \"$LOG_CONTENT_BEFORE_END_TIME_FINAL\" | sha256sum -b | cut -d' ' -f1)\n"]
[253.632012, "o", "export LOG_CHECKSUM_FINAL=$(echo -n \"$LOG_CONTENT_BEFORE_END_TIME_FINAL\" | sha256sum -b | cut -d' ' -f1)\r\n\u001b[?2004l\r"]
[253.634558, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[254.186074, "i", "export LOG_SIG_FINAL=\"\"\n"]
[254.186236, "o", "export LOG_SIG_FINAL=\"\"\r\n\u001b[?2004l\r"]
[254.186297, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[254.328233, "i", "if command -v openssl &> /dev/null; then\n  export LOG_SIG_FINAL=$(echo -n \"$LOG_CONTENT_BEFORE_END_TIME_FINAL\" | openssl dgst -sha256 -hmac \"${HMAC_KEY_FOR_JSON}\" | sed 's/^.* //')\nfi\n"]
[254.328407, "o", "if command -v openssl &> /dev/null; then\r\n\u001b[?2004l\r"]
[254.328467, "o", "\u001b[?2004h> "]
[254.328813, "o", "  export LOG_SIG_FINAL=$(echo -n \"$LOG_CONTENT_BEFORE_END_TIME_FINAL\" | openssl dgst -sha256 -hmac \"${HMAC_KEY_FOR_JSON}\" | sed 's/^.* //')\r\n\u001b[?2004l\r"]
[254.328864, "o", "\u001b[?2004h> fi\r\n\u001b[?2004l\r"]
[254.335931, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[255.352968, "i", "export VERIFICATION_STATUS=\"VERIFICATION_FAILED\"\n"]
[255.353392, "o", "export VERIFICATION_STATUS=\"VERIFICATION_FAILED\"\r\n"]
[255.353487, "o", "\u001b[?2004l\r"]
[255.353544, "o", "\u001b[?2004h"]
[255.353592, "o", "root@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[255.448578, "i", "export ALL_HASHES_MATCH=true\n"]
[255.448901, "o", "export ALL_HASHES_MATCH=true\r\n\u001b[?2004l\r"]
[255.449038, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[255.54294, "i", "export AUDIT_LOG_FILE_PATH=\"/home/user/audit_2023Q4/checksum_audit.log\"\n"]
[255.543589, "o", "export AUDIT_LOG_FILE_PATH=\"/home/user/audit_2023Q4/checksum_audit.log\"\r\n\u001b[?2004l\r"]
[255.543683, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[255.647992, "i", "# Read lines 3 to -2 from the log file (actual file records)\n# Line 1: START, Line 2: START_TIME, Line 3: FILE_RECORDS\n# Lines -2: END_TIME, -1: END (verification status is on new line after these in current state)\nawk -v total_lines=$(wc -l < \"$AUDIT_LOG_FILE_PATH\") 'NR>=3 && NR<=(total_lines-2) {print $0}' \"$AUDIT_LOG_FILE_PATH\" | while IFS= read -r record_line; do\n  filename=$(echo \"$record_line\" | awk '{print $1}')\n  sha256_on_disk=$(sha256sum \"${AUDIT_LOG_FILE_PATH%/*}/../source_files/${filename//\\047\\\\\\047/\\\\\\047}\" 2>/dev/null | cut -d' ' -f1)\n  if [ -z \"$sha256_on_disk\" ]; then\n    export ALL_HASHES_MATCH=false\n  elif [ \"$sha256_on_disk\" != \"${filename#*=}\" ]; then\n    export ALL_HASHES_MATCH=false\n  fi\ndone\n"]
[255.648498, "o", "# Read lines 3 to -2 from the log file (actual file records)\r\n"]
[255.648572, "o", "\u001b[?2004l\r"]
[255.648614, "o", "\u001b[?2004h"]
[255.648658, "o", "root@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[255.64905, "o", "# Line 1: START, Line 2: START_TIME, Line 3: FILE_RECORDS\r\n\u001b[?2004l\r"]
[255.649115, "o", "\u001b[?2004h"]
[255.64915, "o", "root@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[255.649733, "o", "# Lines -2: END_TIME, -1: END (verification status is on new line after these in current state)\r\n\u001b[?2004l\r"]
[255.649794, "o", "\u001b[?2004h"]
[255.649827, "o", "root@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[255.650805, "o", "awk -v total_lines=$(wc -l < \"$AUDIT_LOG_FILE_PATH\") 'NR>=3 && NR<=(total_lines-2) {print $0}' \"$AUDIT_LOG_FILE_PATH\" | while IFS= read -r record_line; do\r\n"]
[255.650846, "o", "\u001b[?2004l\r"]
[255.650904, "o", "\u001b[?2004h"]
[255.650937, "o", "> "]
[255.651264, "o", "  filename=$(echo \"$record_line\" | awk '{print $1}')\r\n\u001b[?2004l\r"]
[255.651318, "o", "\u001b[?2004h"]
[255.651356, "o", "> "]
[255.652181, "o", "  sha256_on_disk=$(sha256sum \"${AUDIT_LOG_FILE_PATH%/*}/../source_files/${filename//\\047\\\\\\047/\\\\\\047}\" 2>/dev/null | cut -d' ' -f1)\r\n\u001b[?2004l\r"]
[255.65225, "o", "\u001b[?2004h"]
[255.652287, "o", "> "]
[255.6525, "o", "  if [ -z \"$sha256_on_disk\" ]; then\r\n\u001b[?2004l\r"]
[255.652563, "o", "\u001b[?2004h"]
[255.652604, "o", "> "]
[255.652833, "o", "    export ALL_HASHES_MATCH=false\r\n\u001b[?2004l\r"]
[255.652881, "o", "\u001b[?2004h"]
[255.65292, "o", "> "]
[255.653263, "o", "  elif [ \"$sha256_on_disk\" != \"${filename#*=}\" ]; then\r\n"]
[255.653299, "o", "\u001b[?2004l\r"]
[255.653328, "o", "\u001b[?2004h"]
[255.65337, "o", "> "]
[255.653569, "o", "    export ALL_HASHES_MATCH=false\r\n\u001b[?2004l\r"]
[255.65361, "o", "\u001b[?2004h"]
[255.653648, "o", "> "]
[255.653688, "o", "  fi\r\n\u001b[?2004l\r"]
[255.653734, "o", "\u001b[?2004h> "]
[255.653774, "o", "done\r\n"]
[255.653816, "o", "\u001b[?2004l\r"]
[255.6703, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[257.63461, "i", "if [ \"$ALL_HASHES_MATCH\" = true ]; then\n  export VERIFICATION_STATUS=\"VERIFICATION_PASSED\"\nelse\n  export VERIFICATION_STATUS=\"VERIFICATION_FAILED\"\nfi\n"]
[257.635054, "o", "if [ \"$ALL_HASHES_MATCH\" = true ]; then\r\n\u001b[?2004l\r"]
[257.635137, "o", "\u001b[?2004h"]
[257.635163, "o", "> "]
[257.635562, "o", "  export VERIFICATION_STATUS=\"VERIFICATION_PASSED\"\r\n"]
[257.635585, "o", "\u001b[?2004l\r"]
[257.635619, "o", "\u001b[?2004h"]
[257.635637, "o", "> "]
[257.635673, "o", "else\r\n"]
[257.635692, "o", "\u001b[?2004l\r"]
[257.635713, "o", "\u001b[?2004h"]
[257.635737, "o", "> "]
[257.636074, "o", "  export VERIFICATION_STATUS=\"VERIFICATION_FAILED\"\r\n"]
[257.636093, "o", "\u001b[?2004l\r"]
[257.636122, "o", "\u001b[?2004h"]
[257.636141, "o", "> "]
[257.63616, "o", "fi\r\n"]
[257.636179, "o", "\u001b[?2004l\r"]
[257.636269, "o", "\u001b[?2004h"]
[257.636286, "o", "root@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[257.796142, "i", "sed -i '$ d' \"$CONFIG_FILE\" || sed -i '' '$ d' \"$CONFIG_FILE\"\n"]
[257.796619, "o", "sed -i '$ d' \"$CONFIG_FILE\" || sed -i '' '$ d' \"$CONFIG_FILE\"\r\n\u001b[?2004l\r"]
[257.7988, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[258.289843, "i", "echo \"${VERIFICATION_STATUS}\" >> \"$CONFIG_FILE\"\n"]
[258.290297, "o", "echo \"${VERIFICATION_STATUS}\" >> \"$CONFIG_FILE\"\r\n\u001b[?2004l\r"]
[258.290575, "o", "\u001b[?2004hroot@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
[258.394909, "i", "cat > /home/user/audit_2023Q4/summary.json << EOF_JSON\n{\n  \"period\": \"2023-Q4\",\n  \"file_count\": ${AUDIT_FILE_COUNT},\n  \"total_bytes\": ${TOTAL_BYTES},\n  \"start_time\": \"${AUDIT_START_TS}\",\n  \"end_time\": \"${AUDIT_END_TS}\",\n  \"status\": \"COMPLETED\",\n  \"log_checksum\": \"${LOG_CHECKSUM_FINAL}\",\n  \"signature\": \"${LOG_SIG_FINAL}\"\n}\nEOF_JSON\n"]
[258.395454, "o", "cat > /home/user/audit_2023Q4/summary.json << EOF_JSON\r\n\u001b[?2004l\r"]
[258.395568, "o", "\u001b[?2004h> {\r\n\u001b[?2004l\r"]
[258.395631, "o", "\u001b[?2004h> "]
[258.395834, "o", "  \"period\": \"2023-Q4\",\r\n\u001b[?2004l\r"]
[258.395928, "o", "\u001b[?2004h> "]
[258.396185, "o", "  \"file_count\": ${AUDIT_FILE_COUNT},\r\n\u001b[?2004l\r"]
[258.396245, "o", "\u001b[?2004h"]
[258.396304, "o", "> "]
[258.396494, "o", "  \"total_bytes\": ${TOTAL_BYTES},\r\n\u001b[?2004l\r"]
[258.39655, "o", "\u001b[?2004h"]
[258.396611, "o", "> "]
[258.396871, "o", "  \"start_time\": \"${AUDIT_START_TS}\",\r\n\u001b[?2004l\r"]
[258.396982, "o", "\u001b[?2004h> "]
[258.397282, "o", "  \"end_time\": \"${AUDIT_END_TS}\",\r\n\u001b[?2004l\r"]
[258.397373, "o", "\u001b[?2004h> "]
[258.397546, "o", "  \"status\": \"COMPLETED\",\r\n\u001b[?2004l\r"]
[258.397617, "o", "\u001b[?2004h"]
[258.39768, "o", "> "]
[258.398067, "o", "  \"log_checksum\": \"${LOG_CHECKSUM_FINAL}\",\r\n\u001b[?2004l\r"]
[258.398131, "o", "\u001b[?2004h"]
[258.398193, "o", "> "]
[258.398414, "o", "  \"signature\": \"${LOG_SIG_FINAL}\"\r\n\u001b[?2004l\r"]
[258.398489, "o", "\u001b[?2004h"]
[258.398548, "o", "> }\r\n\u001b[?2004l\r"]
[258.398607, "o", "\u001b[?2004h> "]
[258.3987, "o", "EOF_JSON\r\n\u001b[?2004l\r"]
[258.401252, "o", "\u001b[?2004h"]
[258.401359, "o", "root@34f88313-0823-4ada-8ebe-7f4137319728:/home/user# "]
