{"version": 2, "width": 160, "height": 40, "timestamp": 1771009786, "env": {"SHELL": "/bin/bash", "TERM": "screen"}}
[0.005526, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:~# "]
[0.944521, "i", "clear\r"]
[0.944673, "o", "clear\r\n\u001b[?2004l\r"]
[0.945985, "o", "\u001b[H\u001b[J"]
[0.946233, "o", "\u001b[?2004h"]
[0.946269, "o", "root@d323ce65-3413-48f9-acdf-628c9fe1faa0:~# "]
[13.239811, "i", "cd /home/user/storage\n"]
[13.239943, "o", "cd /home/user/storage\r\n\u001b[?2004l\r"]
[13.240062, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[13.32644, "i", "cat params.conf\n"]
[13.326548, "o", "cat params.conf\r\n\u001b[?2004l\r"]
[13.327599, "o", "# Storage Maintenance Configuration\r\n# Created by Admin on 2023-01-15\r\n\r\ncutoff_days = 12\r\n# Size limit in KB\r\nmax_bak_kb = 2048\r\n\r\n# ignore_prefix = _\r\n"]
[13.327788, "o", "\u001b[?2004h"]
[13.327826, "o", "root@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[27.246084, "i", "grep -v '^#' params.conf | tr -d ' ' | grep -E 'cutoff_days|max_bak_kb' | cut -d'=' -f2 > extracted_params.txt\n"]
[27.246936, "o", "grep -v '^#' params.conf | tr -d ' ' | grep -E 'cutoff_days|max_bak_kb' | cut -d'=' -f2 > extracted_params.txt\r\n\u001b[?2004l\r"]
[27.251683, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[27.36474, "i", "cat extracted_params.txt\n"]
[27.364932, "o", "cat extracted_params.txt\r\n\u001b[?2004l\r"]
[27.366204, "o", "12\r\n2048\r\n"]
[27.366503, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[38.694571, "i", "cutoff_days=12\n"]
[38.694764, "o", "cutoff_days=12\r\n\u001b[?2004l\r"]
[38.694862, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[38.818631, "i", "max_bak_kb=2048\n"]
[38.81874, "o", "max_bak_kb=2048\r\n\u001b[?2004l\r"]
[38.818817, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[38.919959, "i", "touch maintenance.log\n"]
[38.920204, "o", "touch maintenance.log\r\n\u001b[?2004l\r"]
[38.921979, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[52.46842, "i", "find incoming/ -type f -name \"*.bak\" ! -name \"_*.bak\" -size +${max_bak_kb}k -print -delete | tee -a maintenance.log\n"]
[52.468794, "o", "find incoming/ -type f -name \"*.bak\" ! -name \"_*.bak\" -size +${max_bak_kb}k -print -delete | tee -a maintenance.log\r\n\u001b[?2004l\r"]
[52.471124, "o", "incoming/project1/delete_me.bak\r\n"]
[52.471349, "o", "\u001b[?2004h"]
[52.471382, "o", "root@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[68.798881, "i", "total_deleted_bytes=$(find incoming/ -type f -name \"*.bak\" ! -name \"_*.bak\" -size +${max_bak_kb}k -printf '%s' 2>/dev/null || echo 0)\n"]
[68.799765, "o", "total_deleted_bytes=$(find incoming/ -type f -name \"*.bak\" ! -name \"_*.bak\" -size +${max_bak_kb}k -printf '%s' 2>/dev/null || echo 0)\r\n\u001b[?2004l\r"]
[68.802037, "o", "\u001b[?2004h"]
[68.802079, "o", "root@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[68.924289, "i", "echo \"Total deleted bytes: ${total_deleted_bytes}\" >> maintenance.log\n"]
[68.924596, "o", "echo \"Total deleted bytes: ${total_deleted_bytes}\" >> maintenance.log\r\n\u001b[?2004l\r"]
[68.924712, "o", "\u001b[?2004h"]
[68.924737, "o", "root@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[90.255781, "i", "mkdir -p archive\n"]
[90.256014, "o", "mkdir -p archive\r\n\u001b[?2004l\r"]
[90.258669, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[90.375473, "i", "find incoming/ -type f -name \"*.txt\" -mtime +${cutoff_days} | while read file; do\n"]
[90.375733, "o", "find incoming/ -type f -name \"*.txt\" -mtime +${cutoff_days} | while read file; do\r\n\u001b[?2004l\r"]
[90.375806, "o", "\u001b[?2004h> "]
[90.471705, "i", "  if ! iconv -f utf-8 -t utf-8 \"$file\" >/dev/null 2>&1; then\n"]
[90.471908, "o", "  if ! iconv -f utf-8 -t utf-8 \"$file\" >/dev/null 2>&1; then\r\n\u001b[?2004l\r"]
[90.471967, "o", "\u001b[?2004h> "]
[90.650914, "i", "    corrupt_file=\"${file}.corrupt\"\n"]
[90.651241, "o", "    corrupt_file=\"${file}.corrupt\"\r\n\u001b[?2004l\r"]
[90.651326, "o", "\u001b[?2004h"]
[90.651345, "o", "> "]
[90.742617, "i", "    mv \"$file\" \"$corrupt_file\"\n"]
[90.742883, "o", "    mv \"$file\" \"$corrupt_file\"\r\n"]
[90.74291, "o", "\u001b[?2004l\r"]
[90.742979, "o", "\u001b[?2004h"]
[90.743021, "o", "> "]
[90.865525, "i", "    echo \"Renamed corrupt file: $file\" >> maintenance.log\n"]
[90.865759, "o", "    echo \"Renamed corrupt file: $file\" >> maintenance.log\r\n\u001b[?2004l\r"]
[90.865805, "o", "\u001b[?2004h> "]
[91.073912, "i", "    ((corrupt_count++))\n"]
[91.07407, "o", "    ((corrupt_count++))\r\n\u001b[?2004l\r"]
[91.074105, "o", "\u001b[?2004h> "]
[91.148826, "i", "  else\n"]
[91.148929, "o", "  else\r\n\u001b[?2004l\r"]
[91.148957, "o", "\u001b[?2004h> "]
[91.332771, "i", "    mv \"$file\" \"./archive/\"\n"]
[91.332967, "o", "    mv \"$file\" \"./archive/\"\r\n"]
[91.333026, "o", "\u001b[?2004l\r"]
[91.333067, "o", "\u001b[?2004h"]
[91.333139, "o", "> "]
[91.467677, "i", "    echo \"Archived valid file: $file\" >> maintenance.log\n"]
[91.467898, "o", "    echo \"Archived valid file: $file\" >> maintenance.log\r\n\u001b[?2004l\r"]
[91.467941, "o", "\u001b[?2004h> "]
[91.564503, "i", "  fi\ndone\n"]
[91.564629, "o", "  fi\r\n\u001b[?2004l\r"]
[91.564716, "o", "\u001b[?2004h"]
[91.564735, "o", "> "]
[91.564778, "o", "done\r\n\u001b[?2004l\r"]
[91.592193, "o", "mv: cannot stat 'incoming/space dir/file': No such file or directory\r\n"]
[91.594588, "o", "mv: cannot stat 'name.txt'"]
[91.594633, "o", ": No such file or directory\r\n"]
[91.595171, "o", "\u001b[?2004h"]
[91.595204, "o", "root@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[105.651361, "i", "corrupt_count=0\n"]
[105.651523, "o", "corrupt_count=0\r\n\u001b[?2004l\r"]
[105.651582, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[105.771009, "i", "grep \"Renamed corrupt file:\" maintenance.log | wc -l > corrupt_count.txt\n"]
[105.771254, "o", "grep \"Renamed corrupt file:\" maintenance.log | wc -l > corrupt_count.txt\r\n\u001b[?2004l\r"]
[105.77296, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[105.91805, "i", "corrupt_files=$(cat corrupt_count.txt)\n"]
[105.918236, "o", "corrupt_files=$(cat corrupt_count.txt)\r\n\u001b[?2004l\r"]
[105.919478, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[106.049926, "i", "echo \"Total corrupt files: ${corrupt_files}\" >> maintenance.log\n"]
[106.050182, "o", "echo \"Total corrupt files: ${corrupt_files}\" >> maintenance.log\r\n\u001b[?2004l\r"]
[106.050291, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[118.323626, "i", "cd archive\n"]
[118.323801, "o", "cd archive\r\n\u001b[?2004l\r"]
[118.323875, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage/archive# "]
[118.40857, "i", "find . -type f -exec sh -c 'md5sum \"$1\" | awk '{print $2 \"\\t\" $1 \"\\t\" $3}' | tr -d \".\"' _ {} \\; | sort -k3 | awk -F'\\t' 'BEGIN {print \"Filename\\tSize\\tMD5\"} {print $1 \"\\t\" $2 \"\\t\" $3}' > manifest.csv\n"]
[118.409283, "o", "find . -type f -exec sh -c 'md5sum \"$1\" | awk '{print $2 \"\\t\" $1 \"\\t\" $3}' | tr -d \".\"' _ {} \\; | sort -k3 | awk -F'\\t' 'BEGIN {print \"Filename\\tSize\\tMD5\"} {print $1 \"\\t\" $2 \"\\t\" $3}' > manifest.csv\r\n\u001b[?2004l\r"]
[118.413388, "o", "md5sum: '\\t'"]
[118.413514, "o", ": No such file or directory\r\n"]
[118.413649, "o", "awk: line 2: missing } near end of file\r\n"]
[118.415833, "o", "md5sum: '\\t'"]
[118.415892, "o", ": No such file or directory\r\n"]
[118.416161, "o", "awk: line 2: missing } near end of file\r\n"]
[118.418329, "o", "awk: line 2: missing } near end of file\r\n"]
[118.418393, "o", "md5sum: '\\t'"]
[118.418569, "o", ": No such file or directory\r\n"]
[118.419187, "o", "\u001b[?2004h"]
[118.419228, "o", "root@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage/archive# "]
[120.416219, "i", "unix2dos manifest.csv\n"]
[120.416443, "o", "unix2dos manifest.csv\r\n\u001b[?2004l\r"]
[120.417177, "o", "bash: unix2dos: command not found\r\n"]
[120.417499, "o", "\u001b[?2004h"]
[120.417549, "o", "root@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage/archive# "]
[120.516319, "i", "cd ..\n"]
[120.516432, "o", "cd ..\r\n\u001b[?2004l\r"]
[120.516505, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[131.394174, "i", "cd archive\n"]
[131.394325, "o", "cd archive\r\n\u001b[?2004l\r"]
[131.394546, "o", "\u001b[?2004h"]
[131.3946, "o", "root@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage/archive# "]
[131.507231, "i", "find . -type f -exec sh -c 'md5sum \"$1\" | awk \"{print \\$2 \\\"\\\\t\\\" \\$1 \\\"\\\\t\\\" \\$3}\" | tr -d \".\"' _ {} \\; | sort -k3 | awk -F'\\\\t' 'BEGIN {print \"Filename\\\\tSize\\\\tMD5\"} {print \\$1 \"\\\\t\" \\$2 \"\\\\t\" \\$3}' > manifest.csv\n"]
[131.508878, "o", "find . -type f -exec sh -c 'md5sum \"$1\" | awk \"{print \\$2 \\\"\\\\t\\\" \\$1 \\\"\\\\t\\\" \\$3}\" | tr -d \".\"' _ {} \\; | sort -k3 | awk -F'\\\\t' 'BEGIN {print \"Filename\\\\tSize\\\\tMD5\"} {print \\$1 \"\\\\t\" \\$2 \"\\\\t\" \\$3}' > manifest.csv\r\n\u001b[?2004l\r"]
[131.510699, "o", "awk: 1: unexpected character '\\'\r\n"]
[131.518757, "o", "sort: fflush failed: 'standard output'"]
[131.518836, "o", ": Broken pipe\r\nsort: write error\r\n"]
[131.519094, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage/archive# "]
[132.512317, "i", "sed -i 's/$/\\r/' manifest.csv\n"]
[132.512469, "o", "sed -i 's/$/\\r/' manifest.csv"]
[132.512498, "o", "\r\n\u001b[?2004l\r"]
[132.51398, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage/archive# "]
[132.60915, "i", "cd ..\n"]
[132.609281, "o", "cd ..\r\n\u001b[?2004l\r"]
[132.609345, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[144.051123, "i", "cd archive\n"]
[144.051229, "o", "cd archive\r\n\u001b[?2004l\r"]
[144.051295, "o", "\u001b[?2004h"]
[144.051315, "o", "root@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage/archive# "]
[144.121755, "i", "find . -type f -exec md5sum {} \\; | awk '{print $2 \"\\t\" $1 \"\\t\" $3}' | tr -d \".\" | sort -k3 > temp_manifest.txt\n"]
[144.122152, "o", "find . -type f -exec md5sum {} \\; | awk '{print $2 \"\\t\" $1 \"\\t\" $3}' | tr -d \".\" | sort -k3 > temp_manifest.txt\r\n\u001b[?2004l\r"]
[144.126947, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage/archive# "]
[145.162077, "i", "awk -F'\\\\t' 'BEGIN {print \"Filename\\\\tSize\\\\tMD5\"} {print $1 \"\\\\t\" $2 \"\\\\t\" $3}' temp_manifest.txt > manifest.csv\n"]
[145.162431, "o", "awk -F'\\\\t' 'BEGIN {print \"Filename\\\\tSize\\\\tMD5\"} {print $1 \"\\\\t\" $2 \"\\\\t\" $3}' temp_manifest.txt > manifest.csv\r\n\u001b[?2004l\r"]
[145.163749, "o", "\u001b[?2004h"]
[145.16381, "o", "root@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage/archive# "]
[145.280733, "i", "sed -i -e 's/$/\\r/' manifest.csv\n"]
[145.281427, "o", "sed -i -e 's/$/\\r/' manifest.csv\r\n\u001b[?2004l\r"]
[145.282908, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage/archive# "]
[145.345694, "i", "rm temp_manifest.txt\n"]
[145.345814, "o", "rm temp_manifest.txt\r\n\u001b[?2004l\r"]
[145.346848, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage/archive# "]
[145.443844, "i", "cd ..\n"]
[145.443963, "o", "cd ..\r\n\u001b[?2004l\r"]
[145.444069, "o", "\u001b[?2004h"]
[145.444097, "o", "root@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[155.249108, "i", "manifest_sha1=$(sha1sum archive/manifest.csv | awk '{print $1}')\n"]
[155.24945, "o", "manifest_sha1=$(sha1sum archive/manifest.csv | awk '{print $1}')\r\n\u001b[?2004l\r"]
[155.252372, "o", "\u001b[?2004h"]
[155.252388, "o", "root@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[155.391495, "i", "cat > summary.xml <<EOF\n<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\n<audit>\n    <deleted_bytes>${total_deleted_bytes:-0}</deleted_bytes>\n    <corrupt_files>${corrupt_files:-0}</corrupt_files>\n    <manifest_sha1>${manifest_sha1}</manifest_sha1>\n</audit>\nEOF\n"]
[155.391685, "o", "cat > summary.xml <<EOF\r\n\u001b[?2004l\r\u001b[?2004h> "]
[155.39178, "o", "<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?>\r\n\u001b[?2004l\r"]
[155.391856, "o", "\u001b[?2004h> <audit>\r\n\u001b[?2004l\r\u001b[?2004h> "]
[155.392031, "o", "    <deleted_bytes>${total_deleted_bytes:-0}</deleted_bytes>\r\n\u001b[?2004l\r"]
[155.392098, "o", "\u001b[?2004h> "]
[155.392441, "o", "    <corrupt_files>${corrupt_files:-0}</corrupt_files>\r\n\u001b[?2004l\r"]
[155.392504, "o", "\u001b[?2004h"]
[155.392522, "o", "> "]
[155.392858, "o", "    <manifest_sha1>${manifest_sha1}</manifest_sha1>\r\n\u001b[?2004l\r"]
[155.392909, "o", "\u001b[?2004h> "]
[155.392976, "o", "</audit>\r\n\u001b[?2004l\r"]
[155.393024, "o", "\u001b[?2004h"]
[155.393038, "o", "> "]
[155.393098, "o", "EOF\r\n\u001b[?2004l\r"]
[155.394321, "o", "\u001b[?2004h"]
[155.394335, "o", "root@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[155.491819, "i", "iconv -f utf-8 -t iso-8859-1 summary.xml -o summary_iso.xml && mv summary_iso.xml summary.xml\n"]
[155.492114, "o", "iconv -f utf-8 -t iso-8859-1 summary.xml -o summary_iso.xml && mv summary_iso.xml summary.xml\r\n\u001b[?2004l\r"]
[155.494672, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[161.825118, "i", "find incoming/ -type d -empty -delete\n"]
[161.825495, "o", "find incoming/ -type d -empty -delete\r\n\u001b[?2004l\r"]
[161.828023, "o", "\u001b[?2004hroot@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
[161.888128, "i", "echo \"Maintenance routine completed successfully.\" >> maintenance.log\n"]
[161.888678, "o", "echo \"Maintenance routine completed successfully.\" >> maintenance.log\r\n\u001b[?2004l\r"]
[161.888907, "o", "\u001b[?2004h"]
[161.888945, "o", "root@d323ce65-3413-48f9-acdf-628c9fe1faa0:/home/user/storage# "]
