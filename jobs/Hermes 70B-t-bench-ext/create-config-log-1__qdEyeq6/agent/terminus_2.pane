[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:~# asciinema rec --stdin /logs/agent/recording.cast
[?2004l[0;32masciinema: recording asciicast to /logs/agent/recording.cast[0m
[0;32masciinema: press <ctrl-d> or type "exit" when you're done[0m
[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:~# clear
[?2004l[H[J[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:~# export NET_CONF_DIR=/home/user/network_ops
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:~# mkdir -p $NET_CONF_DIR/{baseline,current,backups,patches,logs}
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:~# cat > $NET_CONF_DIR/baseline/router.conf << EOF
[?2004l[?2004h> interface GigabitEthernet0/1
[?2004l[?2004h>  ip address 10.0.0.1/24
[?2004l[?2004h>  no shutdown
[?2004l[?2004h> !
[?2004l[?2004h> router ospf 1
[?2004l[?2004h>  network 192.168.1.0 0.0.0.255 area 0
[?2004l[?2004h> !
[?2004l[?2004h> EOF
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:~# cat > $NET_CONF_DIR/current/router.conf << EOF
[?2004l[?2004h> interface GigabitEthernet0/1
[?2004l[?2004h> 
[?2004l[?2004h>  ip address 10.0.0.2/24
[?2004l[?2004h> 
[?2004l[?2004h>  shutdown
[?2004l[?2004h> 
[?2004l[?2004h> !
[?2004l[?2004h> 
[?2004l[?2004h> EOF
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:~# cd $NET_CONF_DIR
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# pwd
[?2004l/home/user/network_ops
[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# ls -la
[?2004ltotal 0
drwxr-xr-x 1 root root 49 Feb 12 23:58 [0m[01;34m.[0m
drwxr-xr-x 1 root root 33 Feb 12 23:58 [01;34m..[0m
drwxr-xr-x 1 root root 10 Feb 12 23:58 [01;34mbackups[0m
drwxr-xr-x 1 root root 33 Feb 12 23:58 [01;34mbaseline[0m
drwxr-xr-x 1 root root 33 Feb 12 23:58 [01;34mcurrent[0m
drwxr-xr-x 1 root root 10 Feb 12 23:58 [01;34mlogs[0m
drwxr-xr-x 1 root root 10 Feb 12 23:58 [01;34mpatches[0m
[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# ls -la baseline/
[?2004ltotal 4
drwxr-xr-x 1 root root  33 Feb 12 23:58 [0m[01;34m.[0m
drwxr-xr-x 1 root root  49 Feb 12 23:58 [01;34m..[0m
-rw-r--r-- 1 root root 122 Feb 13 19:00 router.conf
[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# ls -la current/
[?2004ltotal 4
drwxr-xr-x 1 root root 33 Feb 12 23:58 [0m[01;34m.[0m
drwxr-xr-x 1 root root 49 Feb 12 23:58 [01;34m..[0m
-rw-r--r-- 1 root root 69 Feb 13 19:00 router.conf
[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ') - INITIAL_SETUP - OK" > logs/patch_application.log
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ') - BACKED_UP - OK" >> logs/patch_application.log
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# gzip -c current/router.conf > backups/router.conf.orig.gz
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# dos2unix current/router.conf
[?2004ldos2unix: converting file current/router.conf to Unix format...
[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ') - NORMALIZED_LF - OK" >> logs/patch_application.log
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# diff -u current/router.conf baseline/router.conf > patches/router_fix.patch
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ') - CREATED_PATCH - OK" >> logs/patch_application.log
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# ORIGINAL_SIZE=$(stat --printf="%s" current/router.conf.orig)
[?2004lstat: cannot statx 'current/router.conf.orig': No such file or directory
[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# PATCH_SIZE=$(stat --printf="%s" patches/router_fix.patch)
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# echo "{\"original_size_bytes\": $ORIGINAL_SIZE, \"patch_size_bytes\": $PATCH_SIZE}" > logs/metrics.json
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ') - METRICS_LOGGED - OK" >> logs/patch_application.log
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# patch -s -p0 < patches/router_fix.patch
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ') - APPLIED_PATCH - OK" >> logs/patch_application.log
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# diff -q current/router.conf baseline/router.conf
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# if [ $? -eq 0 ]; then echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ') - VERIFIED_CONFIG - OK" >> logs/patch_application.log; else echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ') - VERIFIED_CONFIG - FAILED" >> logs/patch_application.log; fi
[?2004l[?2004hroot@9672fd17-afa1-40f1-8fe6-e49b2636f6b6:/home/user/network_ops# 