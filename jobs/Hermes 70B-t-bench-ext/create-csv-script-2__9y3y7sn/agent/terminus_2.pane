[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:~# asciinema rec --stdin /logs/agent/recording.cast
[?2004l[0;32masciinema: recording asciicast to /logs/agent/recording.cast[0m
[0;32masciinema: press <ctrl-d> or type "exit" when you're done[0m
[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:~# clear
[?2004l[H[J[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:~# cd /home/user/inventory
[?2004l[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# ls -la
[?2004ltotal 4
drwxr-xr-x 1 user user  62 Feb 13 18:51 [0m[01;34m.[0m
drwxr-xr-x 1 user user  94 Feb 13 18:50 [01;34m..[0m
-rw-r--r-- 1 user user   0 Feb 13 18:51 legacy_map.conf
-rw-r--r-- 1 user user 285 Oct 25  2023 ssh_audit.csv
[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# file ssh_audit.csv
[?2004lbash: file: command not found
[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# file legacy_map.conf
[?2004lbash: file: command not found
[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# head -5 ssh_audit.csv
[?2004lserverName,port,permitRootLogin,protocol,owner,extra
alpha,22,yes,2,admin,none
beta,2222,no,1,rené,deprecated
  # This is a indented comment
gamma,22,prohibit-password,2,müller,ok
[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# head -5 legacy_map.conf
[?2004l[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# stat --format=%y ssh_audit.csv
[?2004l2023-10-25 12:00:00.000000000 +0000
[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# stat --format=%Y ssh_audit.csv
[?2004l1698235200
[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# ls --full-time ssh_audit.csv
[?2004l-rw-r--r-- 1 user user 285 2023-10-25 12:00:00.000000000 +0000 ssh_audit.csv
[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# grep -v '^ *#' ssh_audit.csv | sed 's|prohibit-password|without-password|; s|forced-commands-only|no|' | grep -E '^([^,]*,){3}(2),.*' | iconv -f ISO-8859-1 -t UTF-8 > processed_data.tmp
[?2004lgrep: ssh_audit.csv: binary file matches
[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# wc -l processed_data.tmp
[?2004l3 processed_data.tmp
[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# awk -F, '{print $1 " | " $3}' processed_data.tmp | sort | tr -d '
[?2004l[?2004h> ' | xargs -I {} echo "{}" | sed 's/$/\\r/' | tr '\\r' '\015' > ssh_root_status.txt
[?2004l[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# echo -n "\xEF\xBB\xBF#PRIORITY_LIST"$(awk -F, '{print $2""$1""$5}' processed_data.tmp | sort -k1,1n -k2,2r | iconv -f UTF-8 -t UTF-16LE | tr -d '\n') > ssh_priority.tsv
[?2004lbash: warning: command substitution: ignored null byte in input
[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# awk -F, '{print $1}' processed_data.tmp | sort | uniq -c | wc -l > valid_records_count.txt
[?2004l[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# awk -F, '{print $1}' processed_data.tmp | sort | uniq -c | wc -l > valid_records_count.txt
[?2004l[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# echo "{"valid_records":$(cat valid_records_count.txt),"legacy_nodes_detected":0}" > audit_manifest.json
[?2004l[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# echo "2023-10-25T12:00:00Z | grep -v '^ *#' ssh_audit.csv | sed 's|prohibit-password|without-password|; s|forced-commands-only|no|' | grep -E '^([^,]*,){3}(2),.*' | iconv -f ISO-8859-1 -t UTF-8 > processed_data.tmp"
[?2004l2023-10-25T12:00:00Z | grep -v '^ *#' ssh_audit.csv | sed 's|prohibit-password|without-password|; s|forced-commands-only|no|' | grep -E '^([^,]*,){3}(2),.*' | iconv -f ISO-8859-1 -t UTF-8 > processed_data.tmp
[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# echo "2023-10-25T12:00:00Z | awk -F, '{print $1 " | " $3}' processed_data.tmp | sort | tr -d '\n' | xargs -I {} echo \"{}\" | sed 's/$/\\r/' | tr '\\r' '\015' > ssh_root_status.txt"
[?2004lbash:  }' processed_data.tmp | sort | tr -d '\n' | xargs -I {} echo "{}" | sed 's/$/\r/' | tr '\r' '\015' > ssh_root_status.txt: No such file or directory
[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# echo "2023-10-25T12:00:00Z | echo -n \"\\xEF\\xBB\\xBF#PRIORITY_LIST\"\$(awk -F, '{print $2"\\t"$1"\\t"$5}' processed_data.tmp | sort -k1,1n -k2,2r | iconv -f UTF-8 -t UTF-16LE | tr -d '\n') > ssh_priority.tsv" > column_manipulation.log
[?2004l[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# rm -f ssh_priority.tsv
[?2004l[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# echo -n "\xEF\xBB\xBF#PRIORITY_LIST" > ssh_priority.tsv
[?2004l[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# awk -F, '{print $2"\t"$1"\t"$5}' processed_data.tmp | sort -k1,1n -k2,2r | iconv -f UTF-8 -t UTF-16LE >> ssh_priority.tsv
[?2004l[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# rm -f column_manipulation.log
[?2004l[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# echo "2023-10-25T12:00:00Z | grep -v '^ *#' ssh_audit.csv | sed 's|prohibit-password|without-password|; s|forced-commands-only|no|' | grep -E '^([^,]*,){3}(2),.*' | iconv -f ISO-8859-1 -t UTF-8 > processed_data.tmp" >> column_manipulation.log
[?2004l[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# echo "2023-10-25T12:00:00Z | awk -F, '{print \$1 \" | \" \$3}' processed_data.tmp | sort > /tmp/awk_out.txt && tr -d '\n' < /tmp/awk_out.txt | xargs -I {} echo {} > ssh_root_status.txt && sed -i 's/\$/\\r/' ssh_root_status.txt && tr -d '\n' < ssh_root_status.txt > /tmp/tmp_crlf && tr '\\r' '\015' < /tmp/tmp_crlf > ssh_root_status.txt" >> column_manipulation.log
[?2004l[?2004hroot@8e12451d-ab8a-464f-a9c8-8d4d63a06f8b:/home/user/inventory# echo "2023-10-25T12:00:00Z | echo -n '\\xEF\\xBB\\xBF#PRIORITY_LIST' > ssh_priority.tsv && awk -F, '{print \$2'\\t\\"\$1\\"\\t\\"\$5}' processed_data.tmp | sort -k1,1n -k2,2r | iconv -f UTF-8 -t UTF-16LE >> ssh_priority.tsv" >> column_manipulation.log
[?2004l[?2004h> hexdump -C ssh_root_status.txt | head -10
[?2004l[?2004h> sort -c ssh_root_status.txt
[?2004l[?2004h> cat audit_manifest.json
[?2004l[?2004h> wc -l audit_manifest.json
[?2004l[?2004h> hexdump -C ssh_priority.tsv | head -15
[?2004l[?2004h> od -tx1 -c ssh_priority.tsv | head -20
[?2004l[?2004h> cat column_manipulation.log
[?2004l[?2004h> ls -la *.txt *.tsv *.json *.log
[?2004l[?2004h> cat ssh_root_status.txt
[?2004l[?2004h> sort -c ssh_root_status.txt
[?2004l[?2004h> od -c ssh_root_status.txt
[?2004l[?2004h> cat audit_manifest.json
[?2004l[?2004h> cat column_manipulation.log
[?2004l[?2004h> od -tx1 -c ssh_priority.tsv | head -20
[?2004l[?2004h> wc -l ssh_root_status.txt
[?2004l[?2004h> cat ssh_root_status.txt
[?2004l[?2004h> sort -c ssh_root_status.txt
[?2004l[?2004h> od -c ssh_root_status.txt | tail -2
[?2004l[?2004h> cat audit_manifest.json
[?2004l[?2004h> echo $(cat valid_records_count.txt)
[?2004l[?2004h> cat column_manipulation.log | head -3
[?2004l[?2004h> od -tx1 -c ssh_priority.tsv | head -20
[?2004l[?2004h> 