{"version": 2, "width": 160, "height": 40, "timestamp": 1771009686, "env": {"SHELL": "/bin/bash", "TERM": "screen"}}
[0.006202, "o", "\u001b[?2004hroot@d7c403a5-81da-4214-a1f2-4e537365267b:~# "]
[0.949967, "i", "clear\r"]
[0.950195, "o", "clear\r\n\u001b[?2004l\r"]
[0.951151, "o", "\u001b[H\u001b[J"]
[0.95128, "o", "\u001b[?2004h"]
[0.951302, "o", "root@d7c403a5-81da-4214-a1f2-4e537365267b:~# "]
[57.532135, "i", "cd /home/user\n"]
[57.532334, "o", "cd /home/user\r\n\u001b[?2004l\r"]
[57.532582, "o", "\u001b[?2004h"]
[57.532671, "o", "root@d7c403a5-81da-4214-a1f2-4e537365267b:/home/user# "]
[57.70378, "i", "ls -la db_backups/ .config/\n"]
[57.703978, "o", "ls -la db_backups/ .config/\r\n\u001b[?2004l\r"]
[57.705952, "o", ".config/:\r\n"]
[57.706054, "o", "total 4\r\n"]
[57.706101, "o", "drwxrwxrwx 1 root root 40 Feb 12 23:59 \u001b[0m\u001b[34;42m.\u001b[0m\r\n"]
[57.706253, "o", "drwxr-xr-x 1 root root 51 Feb 12 23:59 \u001b[01;34m..\u001b[0m\r\n-rwxrwxrwx 1 root root 14 Feb 12 23:59 \u001b[01;32mbackup_system.conf\u001b[0m\r\n\r\ndb_backups/:\r\n"]
[57.706377, "o", "total 24\r\ndrwxrwxrwx 1 root root 10 Feb 12 23:59  \u001b[34;42m.\u001b[0m\r\ndrwxr-xr-x 1 root root 51 Feb 12 23:59  \u001b[01;34m..\u001b[0m\r\n"]
[57.706425, "o", "-r--r--r-- 1 root root 12 Feb 12 23:59  archived.sql\r\n-rw-r--r-- 1 root root 15 Feb 12 23:59  batch_config.txt\r\n-rw-r--r-- 1 root root 71 Feb 12 23:59  customers.sql\r\n-rw-r--r-- 1 root root  9 Feb 12 23:59  inventory-2023.sql\r\n-rw-r--r-- 1 root root  9 Feb 12 23:59  inventory_2023.sql\r\n-rw-r--r-- 1 root root 50 Feb 12 23:59 ' orders.sql'\r\n"]
[57.706831, "o", "\u001b[?2004h"]
[57.706882, "o", "root@d7c403a5-81da-4214-a1f2-4e537365267b:/home/user# "]
[58.725502, "i", "mkdir -p backup_logs\n"]
[58.725666, "o", "mkdir -p backup_logs\r\n\u001b[?2004l\r"]
[58.728544, "o", "\u001b[?2004h"]
[58.728561, "o", "root@d7c403a5-81da-4214-a1f2-4e537365267b:/home/user# "]
[58.838354, "i", "cat .config/backup_system.conf\n"]
[58.838564, "o", "cat .config/backup_system.conf\r\n\u001b[?2004l\r"]
[58.839677, "o", "BID-PROD-8821\r\n"]
[58.839945, "o", "\u001b[?2004h"]
[58.839991, "o", "root@d7c403a5-81da-4214-a1f2-4e537365267b:/home/user# "]
[58.976316, "i", "python3 - <<'EOF'\n#!/usr/bin/env python3\nimport os\nimport sys\nimport gzip\nimport shutil\nimport hashlib\nimport json\nimport re\n\n# Step 1: Read Batch ID from config file\nbatch_id = None\ntry:\n    with open('/home/user/.config/backup_system.conf', 'r', encoding='utf-8') as f:\n        config_content = f.read().strip()\n        # Extract Batch ID (assume it's a simple value, trim newlines)\n        batch_id = config_content.strip()\n    if not batch_id:\n        raise FileNotFoundError(\"Batch ID not found\")\nexcept FileNotFoundError:\n    print(f\"Error: Cannot find or read batch_system.conf\", file=sys.stderr)\n    sys.exit(1)\nexcept Exception as e:\n    print(f\"Error reading batch_system.conf: {e}\", file=sys.stderr)\n    sys.exit(1)\n\nprint(f\"Batch ID: {batch_id}\")\n\n# Step 2: Process SQL files in backup directory\nbackup_dir = '/home/user/db_backups'\nmanifest_data = {}\nfile_records = []\nprocessed_files = []\n\n# Find all .sql files (case-insensitive)\nfor item in os.listdir(backup_dir):\n    if item.lower().endswith('.sql'):\n     "]
[58.976362, "i", "   file_path = os.path.join(backup_dir, item)\n        if os.path.isfile(file_path):\n            processed_files.append(item)\n\nprint(f\"Found {len(processed_files)} .sql files to process\")\n\nfor filename in sorted(processed_files, key=lambda x: re.sub(r'[\\_\\-]', '', x, flags=re.IGNORECASE)):\n    file_path = os.path.join(backup_dir, filename)\n    print(f\"Processing: {filename}\")\n    \n    # Read file content\n    try:\n        with open(file_path, 'rb') as f:\n            content_bytes = f.read()\n    except Exception as e:\n        print(f\"Error reading {filename}: {e}\", file=sys.stderr)\n        continue\n    \n    # Remove UTF-8 BOM (if present)\n    normalized_content = content_bytes\n    if normalized_content.startswith(b'\\xef\\xbb\\xbf'):\n        normalized_content = normalized_content[3:]\n    \n    # Trim trailing whitespace from each line\n    lines = normalized_content.splitlines()\n    trimmed_lines = [line.rstrip() for line in lines]\n    normalized_content = b'\\n'.join(trimmed_lines) + b'\\n'\n    \n    # Get normalized "]
[58.976375, "i", "size\n    n_size = len(normalized_content)\n    manifest_data[filename] = n_size\n    \n    # Generate MD5 hash of normalized content\n    md5_hash = hashlib.md5(normalized_content).hexdigest()\n    \n    # Compress normalized content\n    output_file = filename + '.gz'\n    output_path = os.path.join(backup_dir, output_file)\n    \n    try:\n        with gzip.open(output_path, 'wb') as f_out:\n            f_out.write(normalized_content)\n    except Exception as e:\n        print(f\"Error compressing {filename}: {e}\", file=sys.stderr)\n        continue\n    \n    # Get compressed file size\n    gz_size = os.path.getsize(output_path)\n    \n    # Set modification time to current time\n    current_time = os.path.getmtime(file_path)\n    os.utime(output_path, (current_time, current_time))\n    \n    # Remove original .sql file\n    try:\n        os.remove(file_path)\n    except Exception as e:\n        print(f\"Error removing {filename}: {e}\", file=sys.stderr)\n        continue\n    \n    # Store record for compliance report\n    file_records.app"]
[58.976522, "i", "end({\n        'filename': filename,\n        'n_size': n_size,\n        'gz_size': gz_size,\n        'md5': md5_hash\n    })\n    print(f\"Processed: {filename} -> {output_file}\")\n\n# Step 3: Generate manifest.json\nmanifest_path = '/home/user/backup_logs/manifest.json'\ntry:\n    with open(manifest_path, 'w', encoding='utf-8') as f:\n        json.dump(manifest_data, f, indent=2)\n    print(f\"Generated manifest: {manifest_path}\")\nexcept Exception as e:\n    print(f\"Error generating manifest.json: {e}\", file=sys.stderr)\n    sys.exit(1)\n\n# Step 4: Generate compliance_report.log\nreport_path = '/home/user/backup_logs/compliance_report.log'\ntry:\n    # Generate manifest SHA256 for footer\n    with open(manifest_path, 'rb') as f:\n        manifest_sha256 = hashlib.sha256(f.read()).hexdigest()\n    \n    # Prepare report lines (Unicode strings)\n    header = f\"BATCH: {batch_id}\"\n    \n    file_lines = []\n    for record in file_records:\n        line = f\"FILE: {record['filename']} | N_SIZE: {record['n_size']} | GZ_SIZE: {record['gz_size'"]
[58.976532, "o", "python3 - <<'EOF'\r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.976587, "i", "]} | MD5: {record['md5']}\"\n        file_lines.append(line)\n    \n    footer = f\"MANIFEST_SHA256: {manifest_sha256}\"\n    \n    # Encode and join with CRLF\n    report_content = (header + '\\r\\n') + \\\n        ( '\\r\\n'.join(file_lines) + '\\r\\n' ) + footer\n    \n    # Write to file with Latin-1 encoding\n    with open(report_path, 'w', encoding='iso-8859-1') as f:\n        f.write(report_content)\n    \n    print(f\"Generated compliance report: {report_path}\")\n    \nexcept Exception as e:\n    print(f\"Error generating compliance_report.log: {e}\", file=sys.stderr)\n    sys.exit(1)\n\nprint(\"Backup processing complete\")\nEOF\n"]
[58.976597, "o", "#!/usr/bin/env python3\r\n\u001b[?2004l\r]} | MD5: {record['md5']}\"\r\n        file_"]
[58.976654, "o", "\u001b[?2004h> import os\r\n\u001b[?2004l\r"]
[58.976727, "o", "\u001b[?2004h> import sys\r\n\u001b[?2004l\r"]
[58.976767, "o", "\u001b[?2004h> "]
[58.976816, "o", "import gzip\r\n\u001b[?2004l\r\u001b[?2004h"]
[58.97685, "o", "> "]
[58.976881, "o", "import shutil\r\n\u001b[?2004l\r"]
[58.976911, "o", "\u001b[?2004h> "]
[58.976963, "o", "import hashlib\r\n\u001b[?2004l\r"]
[58.976994, "o", "\u001b[?2004h> "]
[58.977034, "o", "import json\r\n\u001b[?2004l\r"]
[58.977065, "o", "\u001b[?2004h> "]
[58.977103, "o", "import re\r\n\u001b[?2004l\r"]
[58.977136, "o", "\u001b[?2004h"]
[58.977216, "o", "> \r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.977319, "o", "# Step 1: Read Batch ID from config file\r\n\u001b[?2004l\r"]
[58.977355, "o", "\u001b[?2004h> "]
[58.977395, "o", "batch_id = None\r\n\u001b[?2004l\r"]
[58.977424, "o", "\u001b[?2004h> try:\r\n\u001b[?2004l\r"]
[58.977459, "o", "\u001b[?2004h> "]
[58.977709, "o", "    with open('/home/user/.config/backup_system.conf', 'r', encoding='utf-8') as f:\r\n\u001b[?2004l\r"]
[58.977759, "o", "\u001b[?2004h> "]
[58.977864, "o", "        config_content = f.read().strip()\r\n\u001b[?2004l\r"]
[58.977894, "o", "\u001b[?2004h> "]
[58.978176, "o", "        # Extract Batch ID (assume it's a simple value, trim newlines)\r\n\u001b[?2004l\r"]
[58.978207, "o", "\u001b[?2004h> "]
[58.978366, "o", "        batch_id = config_content.strip()\r\n\u001b[?2004l\r"]
[58.978406, "o", "\u001b[?2004h> "]
[58.978462, "o", "    if not batch_id:\r\n\u001b[?2004l\r"]
[58.978493, "o", "\u001b[?2004h> "]
[58.978695, "o", "        raise FileNotFoundError(\"Batch ID not found\")\r\n\u001b[?2004l\r"]
[58.978719, "o", "\u001b[?2004h> "]
[58.978812, "o", "except FileNotFoundError:\r\n\u001b[?2004l\r"]
[58.978836, "o", "\u001b[?2004h> "]
[58.979132, "o", "    print(f\"Error: Cannot find or read batch_system.conf\", file=sys.stderr)\r\n\u001b[?2004l\r"]
[58.979171, "o", "\u001b[?2004h> "]
[58.979223, "o", "    sys.exit(1)\r\n\u001b[?2004l\r"]
[58.97925, "o", "\u001b[?2004h> "]
[58.979308, "o", "except Exception as e:\r\n\u001b[?2004l\r"]
[58.979333, "o", "\u001b[?2004h> "]
[58.979503, "o", "    print(f\"Error reading batch_system.conf: {e}\", file=sys.stderr)\r\n\u001b[?2004l\r"]
[58.979529, "o", "\u001b[?2004h> "]
[58.979567, "o", "    sys.exit(1)\r\n\u001b[?2004l\r"]
[58.979599, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[58.979624, "o", "\u001b[?2004h> "]
[58.979701, "o", "print(f\"Batch ID: {batch_id}\")\r\n\u001b[?2004l\r"]
[58.979725, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[58.979749, "o", "\u001b[?2004h> "]
[58.979869, "o", "# Step 2: Process SQL files in backup directory\r\n\u001b[?2004l\r"]
[58.979898, "o", "\u001b[?2004h> "]
[58.979986, "o", "backup_dir = '/home/user/db_backups'\r\n\u001b[?2004l\r"]
[58.980014, "o", "\u001b[?2004h> "]
[58.980062, "o", "manifest_data = {}\r\n\u001b[?2004l\r"]
[58.980099, "o", "\u001b[?2004h> "]
[58.980135, "o", "file_records = []\r\n\u001b[?2004l\r"]
[58.980183, "o", "\u001b[?2004h> "]
[58.98024, "o", "processed_files = []\r\n\u001b[?2004l\r\u001b[?2004h"]
[58.980278, "o", "> \r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.980382, "o", "# Find all .sql files (case-insensitive)\r\n\u001b[?2004l\r"]
[58.98041, "o", "\u001b[?2004h> "]
[58.980501, "o", "for item in os.listdir(backup_dir):\r\n\u001b[?2004l\r"]
[58.980528, "o", "\u001b[?2004h> "]
[58.980619, "o", "    if item.lower().endswith('.sql'):\r\n\u001b[?2004l\r"]
[58.980646, "o", "\u001b[?2004h> "]
[58.980771, "o", "        file_path = os.path.join(backup_dir, item)\r\n\u001b[?2004l\r"]
[58.980801, "o", "\u001b[?2004h> "]
[58.980897, "o", "        if os.path.isfile(file_path):\r\n\u001b[?2004l\r"]
[58.980924, "o", "\u001b[?2004h> "]
[58.981022, "o", "            processed_files.append(item)\r\n\u001b[?2004l\r"]
[58.981049, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[58.98109, "o", "\u001b[?2004h> "]
[58.981229, "o", "print(f\"Found {len(processed_files)} .sql files to process\")\r\n\u001b[?2004l\r"]
[58.981259, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r\u001b[?2004h"]
[58.981301, "o", "> "]
[58.981527, "o", "for filename in sorted(processed_files, key=lambda x: re.sub(r'[\\_\\-]', '', x, flags=re.IGNORECASE)):\r\n\u001b[?2004l\r"]
[58.981555, "o", "\u001b[?2004h> "]
[58.981677, "o", "    file_path = os.path.join(backup_dir, filename)\r\n\u001b[?2004l\r"]
[58.981704, "o", "\u001b[?2004h> "]
[58.981793, "o", "    print(f\"Processing: {filename}\")\r\n\u001b[?2004l\r"]
[58.98182, "o", "\u001b[?2004h>     \r\n\u001b[?2004l\r"]
[58.981854, "o", "\u001b[?2004h> "]
[58.98192, "o", "    # Read file content\r\n\u001b[?2004l\r\u001b[?2004h"]
[58.981951, "o", ">     try:\r\n\u001b[?2004l\r"]
[58.981991, "o", "\u001b[?2004h> "]
[58.98209, "o", "        with open(file_path, 'rb') as f:\r\n\u001b[?2004l\r"]
[58.982119, "o", "\u001b[?2004h> "]
[58.982213, "o", "            content_bytes = f.read()\r\n\u001b[?2004l\r"]
[58.982249, "o", "\u001b[?2004h> "]
[58.982307, "o", "    except Exception as e:\r\n\u001b[?2004l\r"]
[58.982336, "o", "\u001b[?2004h> "]
[58.982492, "o", "        print(f\"Error reading {filename}: {e}\", file=sys.stderr)\r\n\u001b[?2004l\r"]
[58.982519, "o", "\u001b[?2004h> "]
[58.982555, "o", "        continue\r\n\u001b[?2004l\r"]
[58.98259, "o", "\u001b[?2004h>     \r\n\u001b[?2004l\r"]
[58.982629, "o", "\u001b[?2004h> "]
[58.982709, "o", "    # Remove UTF-8 BOM (if present)\r\n\u001b[?2004l\r"]
[58.982736, "o", "\u001b[?2004h> "]
[58.98283, "o", "    normalized_content = content_bytes\r\n\u001b[?2004l\r"]
[58.982861, "o", "\u001b[?2004h> "]
[58.982992, "o", "    if normalized_content.startswith(b'\\xef\\xbb\\xbf'):\r\n\u001b[?2004l\r"]
[58.983023, "o", "\u001b[?2004h> "]
[58.983144, "o", "        normalized_content = normalized_content[3:]\r\n\u001b[?2004l\r"]
[58.983182, "o", "\u001b[?2004h"]
[58.983216, "o", ">     \r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.983327, "o", "    # Trim trailing whitespace from each line\r\n\u001b[?2004l\r"]
[58.983356, "o", "\u001b[?2004h> "]
[58.983465, "o", "    lines = normalized_content.splitlines()\r\n\u001b[?2004l\r"]
[58.983492, "o", "\u001b[?2004h> "]
[58.983625, "o", "    trimmed_lines = [line.rstrip() for line in lines]\r\n\u001b[?2004l\r"]
[58.983653, "o", "\u001b[?2004h> "]
[58.983795, "o", "    normalized_content = b'\\n'.join(trimmed_lines) + b'\\n'\r\n\u001b[?2004l\r"]
[58.983822, "o", "\u001b[?2004h> "]
[58.983855, "o", "    \r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.98392, "o", "    # Get normalized size\r\n\u001b[?2004l\r"]
[58.983948, "o", "\u001b[?2004h> "]
[58.984036, "o", "    n_size = len(normalized_content)\r\n\u001b[?2004l\r"]
[58.984064, "o", "\u001b[?2004h> "]
[58.984158, "o", "    manifest_data[filename] = n_size\r\n\u001b[?2004l\r"]
[58.984187, "o", "\u001b[?2004h>     \r\n\u001b[?2004l\r"]
[58.984221, "o", "\u001b[?2004h> "]
[58.984334, "o", "    # Generate MD5 hash of normalized content\r\n\u001b[?2004l\r"]
[58.984362, "o", "\u001b[?2004h> "]
[58.984505, "o", "    md5_hash = hashlib.md5(normalized_content).hexdigest()\r\n\u001b[?2004l\r"]
[58.984532, "o", "\u001b[?2004h>     \r\n\u001b[?2004l\r"]
[58.984565, "o", "\u001b[?2004h> "]
[58.984648, "o", "    # Compress normalized content\r\n\u001b[?2004l\r"]
[58.984675, "o", "\u001b[?2004h> "]
[58.984759, "o", "    output_file = filename + '.gz'\r\n\u001b[?2004l\r"]
[58.984786, "o", "\u001b[?2004h> "]
[58.984923, "o", "    output_path = os.path.join(backup_dir, output_file)\r\n\u001b[?2004l\r"]
[58.984951, "o", "\u001b[?2004h>     \r\n\u001b[?2004l\r"]
[58.984986, "o", "\u001b[?2004h> "]
[58.98502, "o", "    try:\r\n\u001b[?2004l\r\u001b[?2004h"]
[58.985055, "o", "> "]
[58.98517, "o", "        with gzip.open(output_path, 'wb') as f_out:\r\n\u001b[?2004l\r"]
[58.985207, "o", "\u001b[?2004h> "]
[58.985309, "o", "            f_out.write(normalized_content)\r\n\u001b[?2004l\r"]
[58.985342, "o", "\u001b[?2004h> "]
[58.9854, "o", "    except Exception as e:\r\n\u001b[?2004l\r"]
[58.985433, "o", "\u001b[?2004h> "]
[58.985595, "o", "        print(f\"Error compressing {filename}: {e}\", file=sys.stderr)\r\n\u001b[?2004l\r"]
[58.985625, "o", "\u001b[?2004h> "]
[58.985661, "o", "        continue\r\n\u001b[?2004l\r"]
[58.985697, "o", "\u001b[?2004h>     \r\n\u001b[?2004l\r"]
[58.985736, "o", "\u001b[?2004h> "]
[58.985804, "o", "    # Get compressed file size\r\n\u001b[?2004l\r"]
[58.985835, "o", "\u001b[?2004h> "]
[58.985935, "o", "    gz_size = os.path.getsize(output_path)\r\n\u001b[?2004l\r"]
[58.985963, "o", "\u001b[?2004h> "]
[58.985996, "o", "    \r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.98612, "o", "    # Set modification time to current time\r\n\u001b[?2004l\r"]
[58.98615, "o", "\u001b[?2004h> "]
[58.986268, "o", "    current_time = os.path.getmtime(file_path)\r\n\u001b[?2004l\r"]
[58.9863, "o", "\u001b[?2004h> "]
[58.986434, "o", "    os.utime(output_path, (current_time, current_time))\r\n\u001b[?2004l\r"]
[58.986466, "o", "\u001b[?2004h> "]
[58.986502, "o", "    \r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.986579, "o", "    # Remove original .sql file\r\n\u001b[?2004l\r"]
[58.98661, "o", "\u001b[?2004h> "]
[58.986645, "o", "    try:\r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.986729, "o", "        os.remove(file_path)\r\n\u001b[?2004l\r"]
[58.986759, "o", "\u001b[?2004h> "]
[58.986823, "o", "    except Exception as e:\r\n\u001b[?2004l\r"]
[58.98685, "o", "\u001b[?2004h> "]
[58.987016, "o", "        print(f\"Error removing {filename}: {e}\", file=sys.stderr)\r\n\u001b[?2004l\r"]
[58.987045, "o", "\u001b[?2004h> "]
[58.98709, "o", "        continue\r\n\u001b[?2004l\r"]
[58.987127, "o", "\u001b[?2004h>     \r\n\u001b[?2004l\r"]
[58.987172, "o", "\u001b[?2004h> "]
[58.987259, "o", "    # Store record for compliance report\r\n\u001b[?2004l\r"]
[58.987291, "o", "\u001b[?2004h> "]
[58.98735, "o", "    file_records.append({\r\n\u001b[?2004l\r"]
[58.987377, "o", "\u001b[?2004h> "]
[58.987453, "o", "        'filename': filename,\r\n\u001b[?2004l\r"]
[58.987481, "o", "\u001b[?2004h> "]
[58.987548, "o", "        'n_size': n_size,\r\n\u001b[?2004l\r"]
[58.987578, "o", "\u001b[?2004h> "]
[58.987645, "o", "        'gz_size': gz_size,\r\n\u001b[?2004l\r"]
[58.987677, "o", "\u001b[?2004h> "]
[58.987732, "o", "        'md5': md5_hash\r\n\u001b[?2004l\r"]
[58.987763, "o", "\u001b[?2004h>     })\r\n\u001b[?2004l\r"]
[58.987804, "o", "\u001b[?2004h> "]
[58.987927, "o", "    print(f\"Processed: {filename} -> {output_file}\")\r\n\u001b[?2004l\r"]
[58.987958, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r\u001b[?2004h"]
[58.987996, "o", "> "]
[58.988057, "o", "# Step 3: Generate manifest.json\r\n\u001b[?2004l\r"]
[58.988088, "o", "\u001b[?2004h> "]
[58.988225, "o", "manifest_path = '/home/user/backup_logs/manifest.json'\r\n\u001b[?2004l\r"]
[58.988271, "o", "\u001b[?2004h> try:\r\n\u001b[?2004l\r\u001b[?2004h"]
[58.988308, "o", "> "]
[58.988437, "o", "    with open(manifest_path, 'w', encoding='utf-8') as f:\r\n\u001b[?2004l\r\u001b[?2004h"]
[58.988474, "o", "> "]
[58.988594, "o", "        json.dump(manifest_data, f, indent=2)\r\n\u001b[?2004l\r"]
[58.988633, "o", "\u001b[?2004h> "]
[58.988782, "o", "    print(f\"Generated manifest: {manifest_path}\")\r\n\u001b[?2004l\r"]
[58.988816, "o", "\u001b[?2004h> "]
[58.988879, "o", "except Exception as e:\r\n\u001b[?2004l\r"]
[58.988919, "o", "\u001b[?2004h> "]
[58.989074, "o", "    print(f\"Error generating manifest.json: {e}\", file=sys.stderr)\r\n\u001b[?2004l\r"]
[58.989114, "o", "\u001b[?2004h"]
[58.989151, "o", ">     sys.exit(1)\r\n\u001b[?2004l\r"]
[58.989201, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.989316, "o", "# Step 4: Generate compliance_report.log\r\n\u001b[?2004l\r"]
[58.989353, "o", "\u001b[?2004h> "]
[58.989494, "o", "report_path = '/home/user/backup_logs/compliance_report.log'\r\n\u001b[?2004l\r"]
[58.989543, "o", "\u001b[?2004h> "]
[58.989582, "o", "try:\r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.989661, "o", "    # Generate manifest SHA256 for footer\r\n\u001b[?2004l\r\u001b[?2004h"]
[58.989696, "o", "> "]
[58.989783, "o", "    with open(manifest_path, 'rb') as f:\r\n\u001b[?2004l\r"]
[58.989817, "o", "\u001b[?2004h> "]
[58.989963, "o", "        manifest_sha256 = hashlib.sha256(f.read()).hexdigest()\r\n\u001b[?2004l\r"]
[58.990013, "o", "\u001b[?2004h> "]
[58.990051, "o", "    \r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.990133, "o", "    # Prepare report lines (Unicode strings)\r\n\u001b[?2004l\r"]
[58.990185, "o", "\u001b[?2004h> "]
[58.990251, "o", "    header = f\"BATCH: {batch_id}\"\r\n\u001b[?2004l\r"]
[58.990303, "o", "\u001b[?2004h>     \r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.990363, "o", "    file_lines = []\r\n\u001b[?2004l\r"]
[58.990399, "o", "\u001b[?2004h> "]
[58.990463, "o", "    for record in file_records:\r\n\u001b[?2004l\r"]
[58.9905, "o", "\u001b[?2004h> "]
[58.990803, "o", "        line = f\"FILE: {record['filename']} | N_SIZE: {record['n_size']} | GZ_SIZE: {record['gz_size']} | MD5: {record['md5']}\"\r\n\u001b[?2004l\r"]
[58.990839, "o", "\u001b[?2004h> "]
[58.990906, "o", "        file_lines.append(line)\r\n\u001b[?2004l\r"]
[58.990927, "o", "\u001b[?2004h> "]
[58.990973, "o", "    \r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.991091, "o", "    footer = f\"MANIFEST_SHA256: {manifest_sha256}\"\r\n\u001b[?2004l\r"]
[58.991144, "o", "\u001b[?2004h>     \r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.991237, "o", "    # Encode and join with CRLF\r\n\u001b[?2004l\r"]
[58.991274, "o", "\u001b[?2004h> "]
[58.991367, "o", "    report_content = (header + '\\r\\n') + \\\r\n\u001b[?2004l\r"]
[58.9914, "o", "\u001b[?2004h> "]
[58.991522, "o", "        ( '\\r\\n'.join(file_lines) + '\\r\\n' ) + footer\r\n\u001b[?2004l\r"]
[58.99156, "o", "\u001b[?2004h> "]
[58.991604, "o", "    \r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.991686, "o", "    # Write to file with Latin-1 encoding\r\n\u001b[?2004l\r"]
[58.991722, "o", "\u001b[?2004h> "]
[58.991862, "o", "    with open(report_path, 'w', encoding='iso-8859-1') as f:\r\n\u001b[?2004l\r"]
[58.991898, "o", "\u001b[?2004h> "]
[58.991964, "o", "        f.write(report_content)\r\n\u001b[?2004l\r"]
[58.991997, "o", "\u001b[?2004h> "]
[58.992035, "o", "    \r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.992172, "o", "    print(f\"Generated compliance report: {report_path}\")\r\n\u001b[?2004l\r"]
[58.992226, "o", "\u001b[?2004h>     \r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.992308, "o", "except Exception as e:\r\n\u001b[?2004l\r"]
[58.992341, "o", "\u001b[?2004h> "]
[58.992525, "o", "    print(f\"Error generating compliance_report.log: {e}\", file=sys.stderr)\r\n\u001b[?2004l\r"]
[58.992559, "o", "\u001b[?2004h> "]
[58.992609, "o", "    sys.exit(1)\r\n\u001b[?2004l\r"]
[58.992648, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r\u001b[?2004h> "]
[58.992731, "o", "print(\"Backup processing complete\")\r\n\u001b[?2004l\r"]
[58.99277, "o", "\u001b[?2004h> "]
[58.992811, "o", "EOF\r\n\u001b[?2004l\r"]
[59.014127, "o", "Batch ID: BID-PROD-8821\r\n"]
[59.014232, "o", "Found 5 .sql files to process\r\nProcessing:  orders.sql\r\n"]
[59.01598, "o", "Processed:  orders.sql ->  orders.sql.gz\r\nProcessing: archived.sql\r\n"]
[59.016315, "o", "Processed: archived.sql -> archived.sql.gz\r\nProcessing: customers.sql\r\n"]
[59.016509, "o", "Processed: customers.sql -> customers.sql.gz\r\nProcessing: inventory_2023.sql\r\n"]
[59.016768, "o", "Processed: inventory_2023.sql -> inventory_2023.sql.gz\r\nProcessing: inventory-2023.sql\r\n"]
[59.016965, "o", "Processed: inventory-2023.sql -> inventory-2023.sql.gz\r\n"]
[59.017049, "o", "Generated manifest: /home/user/backup_logs/manifest.json\r\n"]
[59.01778, "o", "Generated compliance report: /home/user/backup_logs/compliance_report.log\r\nBackup processing complete\r\n"]
[59.020452, "o", "\u001b[?2004h"]
[59.020531, "o", "root@d7c403a5-81da-4214-a1f2-4e537365267b:/home/user# "]
[62.075946, "i", "ls -la db_backups/ backup_logs/\n"]
[62.076293, "o", "ls -la db_backups/ backup_logs/\r\n\u001b[?2004l\r"]
[62.077692, "o", "backup_logs/:\r\n"]
[62.07778, "o", "total 8\r\n"]
[62.077824, "o", "drwxr-xr-x 2 root root  68 Feb 13 19:09 \u001b[0m\u001b[01;34m.\u001b[0m\r\ndrwxr-xr-x 1 root root  55 Feb 13 19:09 \u001b[01;34m..\u001b[0m\r\n-rw-r--r-- 1 root root 548 Feb 13 19:09 compliance_report.log\r\n-rw-r--r-- 1 root root 122 Feb 13 19:09 manifest.json\r\n\r\ndb_backups/:\r\n"]
[62.077929, "o", "total 28\r\ndrwxrwxrwx 1 root root 4096 Feb 13 19:09  \u001b[34;42m.\u001b[0m\r\ndrwxr-xr-x 1 root root   55 Feb 13 19:09  \u001b[01;34m..\u001b[0m\r\n-rw-r--r-- 1 root root   45 Feb 12 23:59  \u001b[01;31marchived.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root   15 Feb 12 23:59  batch_config.txt\r\n-rw-r--r-- 1 root root   90 Feb 12 23:59  \u001b[01;31mcustomers.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root   48 Feb 12 23:59  \u001b[01;31minventory-2023.sql.gz\u001b[0m\r\n"]
[62.077971, "o", "-rw-r--r-- 1 root root   48 Feb 12 23:59  \u001b[01;31minventory_2023.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root   78 Feb 12 23:59 \u001b[01;31m' orders.sql.gz'\u001b[0m\r\n"]
[62.078246, "o", "\u001b[?2004h"]
[62.078287, "o", "root@d7c403a5-81da-4214-a1f2-4e537365267b:/home/user# "]
[62.988436, "i", "wc -l backup_logs/manifest.json\n"]
[62.988689, "o", "wc -l backup_logs/manifest.json\r\n\u001b[?2004l\r"]
[62.989914, "o", "6 backup_logs/manifest.json\r\n"]
[62.990171, "o", "\u001b[?2004h"]
[62.990218, "o", "root@d7c403a5-81da-4214-a1f2-4e537365267b:/home/user# "]
[63.091554, "i", "head -3 backup_logs/compliance_report.log\n"]
[63.091765, "o", "head -3 backup_logs/compliance_report.log\r\n\u001b[?2004l\r"]
[63.093441, "o", "BATCH: BID-PROD-8821\r\r\nFILE:  orders.sql | N_SIZE: 50 | GZ_SIZE: 78 | MD5: 3e35d3ba594271c5b9bb8d636137d8d6\r\r\nFILE: archived.sql | N_SIZE: 12 | GZ_SIZE: 45 | MD5: 5409beca8d95e96d60fcfee12fdd5c10\r\r\n"]
[63.093698, "o", "\u001b[?2004h"]
[63.093713, "o", "root@d7c403a5-81da-4214-a1f2-4e537365267b:/home/user# "]
