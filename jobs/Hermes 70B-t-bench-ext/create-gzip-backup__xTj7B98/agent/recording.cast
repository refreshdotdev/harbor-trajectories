{"version": 2, "width": 160, "height": 40, "timestamp": 1771009001, "env": {"SHELL": "/bin/bash", "TERM": "screen"}}
[0.005617, "o", "\u001b[?2004hroot@65828d79-39a2-4a26-86c7-82bbffd02509:~# "]
[0.938651, "i", "clear\r"]
[0.938821, "o", "clear\r\n\u001b[?2004l\r"]
[0.939668, "o", "\u001b[H\u001b[J"]
[0.939811, "o", "\u001b[?2004h"]
[0.939849, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:~# "]
[6.842147, "i", "mkdir -p /home/user/db_backups\n"]
[6.842288, "o", "mkdir -p /home/user/db_backups\r\n\u001b[?2004l\r"]
[6.843658, "o", "\u001b[?2004h"]
[6.843674, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:~# "]
[6.931802, "i", "mkdir -p /home/user/backup_logs\n"]
[6.931964, "o", "mkdir -p /home/user/backup_logs\r\n\u001b[?2004l\r"]
[6.934691, "o", "\u001b[?2004hroot@65828d79-39a2-4a26-86c7-82bbffd02509:~# "]
[23.191134, "i", "cd /home/user/db_backups\n"]
[23.19124, "o", "cd /home/user/db_backups\r\n\u001b[?2004l\r"]
[23.191311, "o", "\u001b[?2004h"]
[23.191339, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[23.296752, "i", "cat > \"  test_file.sql\" << 'EOF'\nCREATE TABLE test (id INT);\nINSERT INTO test VALUES (1), (2), (3);\nEOF\n"]
[23.296879, "o", "cat > \"  test_file.sql\" << 'EOF'\r\n\u001b[?2004l\r"]
[23.296923, "o", "\u001b[?2004h> "]
[23.297016, "o", "CREATE TABLE test (id INT);\r\n\u001b[?2004l\r\u001b[?2004h> "]
[23.297121, "o", "INSERT INTO test VALUES (1), (2), (3);\r\n\u001b[?2004l\r"]
[23.297152, "o", "\u001b[?2004h> EOF\r\n\u001b[?2004l\r"]
[23.30709, "o", "\u001b[?2004hroot@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[23.478776, "i", "cat > \"data_v1.sql\" << 'EOF'\n-- Sample data v1\nSELECT * FROM users;\nSELECT * FROM orders;\nEOF\n"]
[23.478995, "o", "cat > \"data_v1.sql\" << 'EOF'\r\n\u001b[?2004l\r"]
[23.479049, "o", "\u001b[?2004h"]
[23.479071, "o", "> "]
[23.479152, "o", "-- Sample data v1\r\n\u001b[?2004l\r"]
[23.479185, "o", "\u001b[?2004h"]
[23.479204, "o", "> "]
[23.479304, "o", "SELECT * FROM users;\r\n\u001b[?2004l\r"]
[23.479333, "o", "\u001b[?2004h"]
[23.479347, "o", "> "]
[23.479452, "o", "SELECT * FROM orders;\r\n"]
[23.479467, "o", "\u001b[?2004l\r"]
[23.479487, "o", "\u001b[?2004h"]
[23.479503, "o", "> "]
[23.479521, "o", "EOF\r\n\u001b[?2004l\r"]
[23.481186, "o", "\u001b[?2004h"]
[23.481208, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[23.641931, "i", "cat > \"data-v1.sql\" << 'EOF'\n/* Data version 1 */\nUPDATE stats SET count = count + 1;\nDELETE FROM temp_table;\nEOF\n"]
[23.642059, "o", "cat > \"data-v1.sql\" << 'EOF'\r\n\u001b[?2004l\r"]
[23.642104, "o", "\u001b[?2004h> "]
[23.642164, "o", "/* Data version 1 */\r\n\u001b[?2004l\r"]
[23.64219, "o", "\u001b[?2004h> "]
[23.642285, "o", "UPDATE stats SET count = count + 1;\r\n\u001b[?2004l\r\u001b[?2004h"]
[23.64231, "o", "> "]
[23.642358, "o", "DELETE FROM temp_table;\r\n\u001b[?2004l\r"]
[23.64239, "o", "\u001b[?2004h> EOF\r\n\u001b[?2004l\r"]
[23.643956, "o", "\u001b[?2004hroot@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[23.745658, "i", "cat > \"readonly_file.sql\" << 'EOF'\nCREATE VIEW sensitive_data AS SELECT * FROM private_info;\nEOF\n"]
[23.745967, "o", "cat > \"readonly_file.sql\" << 'EOF'\r\n\u001b[?2004l\r"]
[23.74602, "o", "\u001b[?2004h"]
[23.746059, "o", "> "]
[23.746401, "o", "CREATE VIEW sensitive_data AS SELECT * FROM private_info;\r\n\u001b[?2004l\r"]
[23.746453, "o", "\u001b[?2004h> "]
[23.746503, "o", "EOF\r\n\u001b[?2004l\r"]
[23.748318, "o", "\u001b[?2004h"]
[23.748366, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[24.001396, "i", "chmod 444 readonly_file.sql\n"]
[24.001527, "o", "chmod 444 readonly_file.sql\r\n"]
[24.001546, "o", "\u001b[?2004l\r"]
[24.002558, "o", "\u001b[?2004h"]
[24.002597, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[24.129014, "i", "cat > \"batch_config.txt\" << 'EOF'\n# Decoy config file - should be ignored\nSOURCE_DIR=/var/backups\nDESTINATION=/archive\nMAX_FILES=100\nEOF\n"]
[24.129288, "o", "cat > \"batch_config.txt\" << 'EOF'\r\n\u001b[?2004l\r"]
[24.129351, "o", "\u001b[?2004h"]
[24.129375, "o", "> "]
[24.129624, "o", "# Decoy config file - should be ignored\r\n"]
[24.129643, "o", "\u001b[?2004l\r"]
[24.129666, "o", "\u001b[?2004h"]
[24.129686, "o", "> "]
[24.129832, "o", "SOURCE_DIR=/var/backups\r\n"]
[24.129848, "o", "\u001b[?2004l\r"]
[24.12987, "o", "\u001b[?2004h"]
[24.129888, "o", "> "]
[24.130038, "o", "DESTINATION=/archive\r\n"]
[24.130057, "o", "\u001b[?2004l\r"]
[24.130078, "o", "\u001b[?2004h"]
[24.130097, "o", "> "]
[24.130186, "o", "MAX_FILES=100\r\n"]
[24.130202, "o", "\u001b[?2004l\r"]
[24.130223, "o", "\u001b[?2004h"]
[24.13024, "o", "> "]
[24.130268, "o", "EOF\r\n"]
[24.130283, "o", "\u001b[?2004l\r"]
[24.132661, "o", "\u001b[?2004h"]
[24.132699, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[24.25826, "i", "cat > \"normal_file.sql\" << 'EOF'\n-- Normal test file\nSELECT current_timestamp;\nSELECT version();\nEOF\n"]
[24.258518, "o", "cat > \"normal_file.sql\" << 'EOF'\r\n\u001b[?2004l\r"]
[24.258567, "o", "\u001b[?2004h"]
[24.258599, "o", "> "]
[24.258722, "o", "-- Normal test file\r\n\u001b[?2004l\r"]
[24.258798, "o", "\u001b[?2004h> "]
[24.258927, "o", "SELECT current_timestamp;\r\n\u001b[?2004l\r"]
[24.259001, "o", "\u001b[?2004h> "]
[24.25909, "o", "SELECT version();\r\n\u001b[?2004l\r"]
[24.259133, "o", "\u001b[?2004h"]
[24.259166, "o", "> "]
[24.259226, "o", "EOF\r\n\u001b[?2004l\r"]
[24.260604, "o", "\u001b[?2004h"]
[24.260638, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[24.545317, "i", "ls -la\n"]
[24.545473, "o", "ls -la\r\n\u001b[?2004l\r"]
[24.548018, "o", "total 44\r\n"]
[24.548043, "o", "drwxrwxrwx 1 root root 167 Feb 13 18:57  \u001b[0m\u001b[34;42m.\u001b[0m\r\ndrwxr-xr-x 1 root root  55 Feb 13 18:56  \u001b[01;34m..\u001b[0m\r\n-r--r--r-- 1 root root  12 Feb 13 18:51  archived.sql\r\n-rw-r--r-- 1 root root  99 Feb 13 18:57  batch_config.txt\r\n-rw-r--r-- 1 root root  71 Feb 13 18:50  customers.sql\r\n"]
[24.5482, "o", "-rw-r--r-- 1 root root  81 Feb 13 18:57  data-v1.sql\r\n-rw-r--r-- 1 root root  61 Feb 13 18:57  data_v1.sql\r\n-rw-r--r-- 1 root root   9 Feb 13 18:51  inventory-2023.sql\r\n-rw-r--r-- 1 root root   9 Feb 13 18:51  inventory_2023.sql\r\n-rw-r--r-- 1 root root  64 Feb 13 18:57  normal_file.sql\r\n-rw-r--r-- 1 root root  50 Feb 13 18:51 ' orders.sql'\r\n-r--r--r-- 1 root root  58 Feb 13 18:57  readonly_file.sql\r\n"]
[24.548294, "o", "-rw-r--r-- 1 root root  67 Feb 13 18:57 '  test_file.sql'\r\n"]
[24.54839, "o", "\u001b[?2004h"]
[24.548447, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[37.468189, "i", "mkdir -p /home/user/.config\n"]
[37.468377, "o", "mkdir -p /home/user/.config\r\n"]
[37.468403, "o", "\u001b[?2004l\r"]
[37.469759, "o", "\u001b[?2004h"]
[37.469788, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[37.594565, "i", "cat > /home/user/.config/backup_system.conf << 'EOF'\n# System-wide backup configuration\nBATCH_ID=20240213-01\nLOG_LEVEL=INFO\nRETENTION_DAYS=30\nCOMPRESSION_LEVEL=6\nEOF\n"]
[37.594828, "o", "cat > /home/user/.config/backup_system.conf << 'EOF'\r\n\u001b[?2004l\r\u001b[?2004h"]
[37.594909, "o", "> "]
[37.595034, "o", "# System-wide backup configuration\r\n\u001b[?2004l\r\u001b[?2004h"]
[37.595076, "o", "> BATCH_ID=20240213-01\r\n\u001b[?2004l\r\u001b[?2004h> LOG_LEVEL=INFO\r\n\u001b[?2004l\r"]
[37.59512, "o", "\u001b[?2004h> "]
[37.595152, "o", "RETENTION_DAYS=30\r\n\u001b[?2004l\r"]
[37.595183, "o", "\u001b[?2004h> "]
[37.595229, "o", "COMPRESSION_LEVEL=6\r\n\u001b[?2004l\r"]
[37.59526, "o", "\u001b[?2004h> EOF\r\n\u001b[?2004l\r"]
[37.596961, "o", "\u001b[?2004hroot@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[37.802008, "i", "pwd\n"]
[37.802143, "o", "pwd\r\n\u001b[?2004l\r/home/user/db_backups\r\n\u001b[?2004hroot@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[37.957908, "i", "python3 --version\n"]
[37.958092, "o", "python3 --version\r\n"]
[37.95813, "o", "\u001b[?2004l\r"]
[37.96047, "o", "Python 3.10.12\r\n"]
[37.960886, "o", "\u001b[?2004h"]
[37.960916, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[87.393117, "i", "cat > /home/user/process_backups.py << 'EOF'\n#!/usr/bin/env python3\nimport os\nimport sys\nimport gzip\nimport hashlib\nimport json\nimport re\nimport subprocess\nfrom pathlib import Path\n\nclass BackupProcessor:\n    def __init__(self):\n        self.backup_dir = Path('/home/user/db_backups')\n        self.logs_dir = Path('/home/user/backup_logs')\n        self.config_file = Path('/home/user/.config/backup_system.conf')\n        self.manifest = {}\n        self.compliance_data = []\n        \n    def read_batch_id(self):\n        \"\"\"Read and clean the Batch ID from the configuration file\"\"\"\n        try:\n            content = self.config_file.read_text(encoding='utf-8')\n            match = re.search(r'^BATCH_ID=(.*)$', content, re.MULTILINE)\n            return match.group(1).strip() if match else 'UNKNOWN'\n        except Exception as e:\n            print(f\"Warning: Could not read Batch ID: {e}\")\n            return 'UNKNOWN'\n    \n    def normalize_file(self, file_path):\n        \"\"\"Read file, remove BOM, and trim trailing white"]
[87.393167, "i", "space from each line\"\"\"\n        try:\n            content = file_path.read_text(encoding='utf-8')\n            # Remove UTF-8 BOM if present\n            content = content.lstrip('\\ufeff')\n            # Trim trailing whitespace from each line\n            normalized = '\\n'.join(line.rstrip() for line in content.splitlines())\n            return normalized.encode('utf-8')\n        except Exception as e:\n            print(f\"Warning: Normalization failed for {file_path.name}: {e}\")\n            return None\n    \n    def process_file(self, sql_file):\n        \"\"\"Process a single SQL file: normalize, compress, update manifest\"\"\"\n        print(f\"Processing {sql_file.name}...\")\n        \n        # Normalize content\n        normalized_content = self.normalize_file(sql_file)\n        if normalized_content is None:\n            return False\n        \n        # Calculate normalized size and hash\n        normalized_size = len(normalized_content)\n        md5_hash = hashlib.md5(normalized_content).hexdigest()\n        \n        # Update "]
[87.393329, "i", "manifest\n        self.manifest[sql_file.name] = normalized_size\n        \n        # Create compressed file name\n        gz_file = sql_file.with_suffix('.sql.gz')\n        \n        try:\n            # Compress normalized content\n            with gzip.open(gz_file, 'wb') as f_out:\n                f_out.write(normalized_content)\n            \n            # Get compressed size\n            gz_size = gz_file.stat().st_size\n            \n            # Update compliance data\n            self.compliance_data.append({\n                'filename': sql_file.name,\n                'n_size': normalized_size,\n                'gz_size': gz_size,\n                'md5': md5_hash\n            })\n            \n            # Remove original SQL file\n            sql_file.unlink()\n            print(f\"  Successfully processed: {sql_file.name} ({normalized_size} bytes) -> {gz_size} bytes gzipped\")\n            return True\n            \n        except Exception as e:\n            print(f\"Error compressing {sql_file.name}: {e}\")\n            return"]
[87.393349, "o", "cat > /home/user/process_backups.py << 'EOF'\r\n\u001b[?2004l\r\u001b[?2004h> "]
[87.393421, "i", " False\n    \n    def generate_manifest(self):\n        \"\"\"Generate the manifest.json file\"\"\"\n        try:\n            manifest_path = self.logs_dir / 'manifest.json'\n            with open(manifest_path, 'w', encoding='utf-8') as f:\n                json.dump(self.manifest, f, indent=2)\n            print(f\"Manifest generated: {manifest_path}\")\n            return manifest_path\n        except Exception as e:\n            print(f\"Error generating manifest: {e}\")\n            return None\n    \n    def calculate_manifest_sha256(self, manifest_path):\n        \"\"\"Calculate SHA256 hash of manifest file\"\"\"\n        try:\n            sha256 = hashlib.sha256()\n            with open(manifest_path, 'rb') as f:\n                sha256.update(f.read())\n            return sha256.hexdigest()\n        except Exception as e:\n            print(f\"Error calculating manifest hash: {e}\")\n            return 'UNKNOWN'\n    \n    def custom_sort_key(self, filename):\n        \"\"\"Custom sort key: case-insensitive, _ before -\"\"\"\n        # Transform file"]
[87.393438, "o", "#!/usr/bin/env python3\r\n\u001b[?2004l\r\u001b[?2004h> "]
[87.393482, "i", "name for custom collation\n        # Convert to lowercase for case-insensitive sorting\n        # Replace hyphens with a character that sorts before underscore\n        return filename.lower().replace('-', '\\x01')\n    \n    def generate_compliance_report(self, manifest_path, batch_id):\n        \"\"\"Generate compliance report with specific encoding and line endings\"\"\"\n        try:\n            report_path = self.logs_dir / 'compliance_report.log'\n            \n            # Calculate manifest SHA256\n            manifest_sha256 = self.calculate_manifest_sha256(manifest_path)\n            \n            # Sort files using custom collation\n            sorted_files = sorted(self.compliance_data, key=lambda x: self.custom_sort_key(x['filename']))\n            \n            # Create report content with Windows line endings\n            report_content = []\n            report_content.append(f\"BATCH: {batch_id}\\r\\n\")\n            \n            for file_data in sorted_files:\n                line = (f\"FILE: {file_data['filename']} | \"\n "]
[87.393541, "o", "import os\r\n\u001b[?2004l\r\u001b[?2004h> import sys\r\n\u001b[?2004l\r\u001b[?2004h> "]
[87.393585, "i", "                       f\"N_SIZE: {file_data['n_size']} | \"\n                        f\"GZ_SIZE: {file_data['gz_size']} | \"\n                        f\"MD5: {file_data['md5']}\")\n                report_content.append(f\"{line}\\r\\n\")\n            \n            report_content.append(f\"MANIFEST_SHA256: {manifest_sha256}\\r\\n\")\n            \n            # Join all lines and encode in ISO-8859-1\n            full_report = ''.join(report_content).encode('iso-8859-1')\n            \n            # Write to file\n            with open(report_path, 'wb') as f:\n                f.write(full_report)\n            \n            print(f\"Compliance report generated: {report_path}\")\n            return True\n            \n        except Exception as e:\n            print(f\"Error generating compliance report: {e}\")\n            return False\n    \n    def run(self):\n        \"\"\"Main processing function\"\"\"\n        print(\"Starting backup processing pipeline...\")\n        \n        # Ensure logs directory exists\n        self.logs_dir.mkdir(parents=True, exi"]
[87.393601, "o", "import gzip\r\n\u001b[?2004l\r\u001b[?2004h> "]
[87.393655, "i", "st_ok=True)\n        \n        # Read Batch ID\n        batch_id = self.read_batch_id()\n        print(f\"Using Batch ID: {batch_id}\")\n        \n        # Process SQL files\n        sql_files = list(self.backup_dir.glob('*.sql'))\n        print(f\"Found {len(sql_files)} SQL files to process\")\n        \n        if not sql_files:\n            print(\"No SQL files found. Creating empty manifests.\")\n        \n        for sql_file in sql_files:\n            self.process_file(sql_file)\n        \n        # Generate manifest\n        manifest_path = self.generate_manifest()\n        if not manifest_path:\n            return False\n        \n        # Generate compliance report\n        success = self.generate_compliance_report(manifest_path, batch_id)\n        \n        print(\"Backup processing completed!\")\n        return success\n\n\nif __name__ == '__main__':\n    processor = BackupProcessor()\n    processor.run()\nEOF\n"]
[87.393671, "o", "import hashlib\r\n\u001b[?2004l\r\u001b[?2004h> "]
[87.39374, "o", "import json\r\n\u001b[?2004l\r\u001b[?2004h> "]
[87.393759, "o", "import re\r\n\u001b[?2004l\r"]
[87.393827, "o", "\u001b[?2004h> "]
[87.393884, "o", "import subprocess\r\n\u001b[?2004l\r\u001b[?2004h> "]
[87.393932, "o", "from pathlib import Path\r\n\u001b[?2004l\r"]
[87.393965, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[87.394013, "o", "\u001b[?2004h> "]
[87.394058, "o", "class BackupProcessor:\r\n\u001b[?2004l\r"]
[87.394107, "o", "\u001b[?2004h> "]
[87.394156, "o", "    def __init__(self):\r\n\u001b[?2004l\r"]
[87.394192, "o", "\u001b[?2004h> "]
[87.394384, "o", "        self.backup_dir = Path('/home/user/db_backups')\r\n\u001b[?2004l\r"]
[87.394421, "o", "\u001b[?2004h> "]
[87.394722, "o", "        self.logs_dir = Path('/home/user/backup_logs')\r\n\u001b[?2004l\r"]
[87.394759, "o", "\u001b[?2004h> "]
[87.395177, "o", "        self.config_file = Path('/home/user/.config/backup_system.conf')\r\n\u001b[?2004l\r"]
[87.395215, "o", "\u001b[?2004h> "]
[87.395364, "o", "        self.manifest = {}\r\n\u001b[?2004l\r"]
[87.395399, "o", "\u001b[?2004h> "]
[87.39559, "o", "        self.compliance_data = []\r\n\u001b[?2004l\r"]
[87.395628, "o", "\u001b[?2004h> "]
[87.395686, "o", "        \r\n\u001b[?2004l\r"]
[87.395731, "o", "\u001b[?2004h> "]
[87.395889, "o", "    def read_batch_id(self):\r\n\u001b[?2004l\r"]
[87.395926, "o", "\u001b[?2004h> "]
[87.39632, "o", "        \"\"\"Read and clean the Batch ID from the configuration file\"\"\"\r\n\u001b[?2004l\r"]
[87.396358, "o", "\u001b[?2004h"]
[87.396395, "o", "> "]
[87.396444, "o", "        try:\r\n\u001b[?2004l\r"]
[87.39648, "o", "\u001b[?2004h> "]
[87.396856, "o", "            content = self.config_file.read_text(encoding='utf-8')\r\n\u001b[?2004l\r"]
[87.396893, "o", "\u001b[?2004h> "]
[87.397296, "o", "            match = re.search(r'^BATCH_ID=(.*)$', content, re.MULTILINE)\r\n\u001b[?2004l\r"]
[87.397333, "o", "\u001b[?2004h> "]
[87.397688, "o", "            return match.group(1).strip() if match else 'UNKNOWN'\r\n\u001b[?2004l\r"]
[87.397733, "o", "\u001b[?2004h> "]
[87.3979, "o", "        except Exception as e:\r\n\u001b[?2004l\r"]
[87.397937, "o", "\u001b[?2004h> "]
[87.398277, "o", "            print(f\"Warning: Could not read Batch ID: {e}\")\r\n\u001b[?2004l\r"]
[87.39831, "o", "\u001b[?2004h> "]
[87.39848, "o", "            return 'UNKNOWN'\r\n\u001b[?2004l\r"]
[87.398515, "o", "\u001b[?2004h> "]
[87.398554, "o", "    \r\n\u001b[?2004l\r"]
[87.398591, "o", "\u001b[?2004h> "]
[87.39881, "o", "    def normalize_file(self, file_path):\r\n\u001b[?2004l\r"]
[87.398852, "o", "\u001b[?2004h> "]
[87.399295, "o", "        \"\"\"Read file, remove BOM, and trim trailing whitespace from each line\"\"\"\r\n\u001b[?2004l\r"]
[87.399337, "o", "\u001b[?2004h> "]
[87.39941, "o", "        try:\r\n\u001b[?2004l\r"]
[87.399447, "o", "\u001b[?2004h> "]
[87.399774, "o", "            content = file_path.read_text(encoding='utf-8')\r\n\u001b[?2004l\r"]
[87.399813, "o", "\u001b[?2004h> "]
[87.40005, "o", "            # Remove UTF-8 BOM if present\r\n\u001b[?2004l\r"]
[87.400092, "o", "\u001b[?2004h> "]
[87.400348, "o", "            content = content.lstrip('\\ufeff')\r\n\u001b[?2004l\r"]
[87.40039, "o", "\u001b[?2004h> "]
[87.40071, "o", "            # Trim trailing whitespace from each line\r\n\u001b[?2004l\r\u001b[?2004h> "]
[87.401157, "o", "            normalized = '\\n'.join(line.rstrip() for line in content.splitlines())\r\n\u001b[?2004l\r"]
[87.401201, "o", "\u001b[?2004h> "]
[87.401446, "o", "            return normalized.encode('utf-8')\r\n\u001b[?2004l\r"]
[87.401489, "o", "\u001b[?2004h> "]
[87.401646, "o", "        except Exception as e:\r\n\u001b[?2004l\r"]
[87.401689, "o", "\u001b[?2004h> "]
[87.402105, "o", "            print(f\"Warning: Normalization failed for {file_path.name}: {e}\")\r\n\u001b[?2004l\r"]
[87.40213, "o", "\u001b[?2004h"]
[87.402177, "o", "> "]
[87.402275, "o", "            return None\r\n\u001b[?2004l\r"]
[87.402318, "o", "\u001b[?2004h> "]
[87.402355, "o", "    \r\n\u001b[?2004l\r"]
[87.402393, "o", "\u001b[?2004h> "]
[87.402585, "o", "    def process_file(self, sql_file):\r\n\u001b[?2004l\r"]
[87.402622, "o", "\u001b[?2004h> "]
[87.403043, "o", "        \"\"\"Process a single SQL file: normalize, compress, update manifest\"\"\"\r\n\u001b[?2004l\r"]
[87.403071, "o", "\u001b[?2004h> "]
[87.403334, "o", "        print(f\"Processing {sql_file.name}...\")\r\n\u001b[?2004l\r"]
[87.403373, "o", "\u001b[?2004h> "]
[87.403425, "o", "        \r\n\u001b[?2004l\r"]
[87.403462, "o", "\u001b[?2004h> "]
[87.403617, "o", "        # Normalize content\r\n\u001b[?2004l\r"]
[87.403654, "o", "\u001b[?2004h> "]
[87.40397, "o", "        normalized_content = self.normalize_file(sql_file)\r\n\u001b[?2004l\r"]
[87.404006, "o", "\u001b[?2004h"]
[87.404042, "o", "> "]
[87.404217, "o", "        if normalized_content is None:\r\n\u001b[?2004l\r"]
[87.404257, "o", "\u001b[?2004h"]
[87.404296, "o", "> "]
[87.404397, "o", "            return False\r\n\u001b[?2004l\r"]
[87.404445, "o", "\u001b[?2004h> "]
[87.404488, "o", "        \r\n\u001b[?2004l\r"]
[87.404529, "o", "\u001b[?2004h> "]
[87.404768, "o", "        # Calculate normalized size and hash\r\n\u001b[?2004l\r"]
[87.404809, "o", "\u001b[?2004h> "]
[87.405093, "o", "        normalized_size = len(normalized_content)\r\n\u001b[?2004l\r"]
[87.405138, "o", "\u001b[?2004h> "]
[87.405468, "o", "        md5_hash = hashlib.md5(normalized_content).hexdigest()\r\n\u001b[?2004l\r"]
[87.405514, "o", "\u001b[?2004h> "]
[87.405556, "o", "        \r\n\u001b[?2004l\r"]
[87.405596, "o", "\u001b[?2004h> "]
[87.405736, "o", "        # Update manifest\r\n\u001b[?2004l\r"]
[87.40579, "o", "\u001b[?2004h> "]
[87.406076, "o", "        self.manifest[sql_file.name] = normalized_size\r\n\u001b[?2004l\r"]
[87.406118, "o", "\u001b[?2004h> "]
[87.406157, "o", "        \r\n\u001b[?2004l\r"]
[87.406202, "o", "\u001b[?2004h> "]
[87.406422, "o", "        # Create compressed file name\r\n\u001b[?2004l\r"]
[87.406463, "o", "\u001b[?2004h> "]
[87.406721, "o", "        gz_file = sql_file.with_suffix('.sql.gz')\r\n\u001b[?2004l\r"]
[87.40677, "o", "\u001b[?2004h> "]
[87.406817, "o", "        \r\n\u001b[?2004l\r"]
[87.406858, "o", "\u001b[?2004h> "]
[87.406922, "o", "        try:\r\n\u001b[?2004l\r"]
[87.406981, "o", "\u001b[?2004h> "]
[87.407198, "o", "            # Compress normalized content\r\n\u001b[?2004l\r"]
[87.40724, "o", "\u001b[?2004h> "]
[87.407638, "o", "            with gzip.open(gz_file, 'wb') as f_out:\r\n\u001b[?2004l\r"]
[87.407676, "o", "\u001b[?2004h"]
[87.407721, "o", "> "]
[87.408093, "o", "                f_out.write(normalized_content)\r\n\u001b[?2004l\r"]
[87.408146, "o", "\u001b[?2004h> "]
[87.408266, "o", "            \r\n\u001b[?2004l\r"]
[87.408303, "o", "\u001b[?2004h"]
[87.408345, "o", "> "]
[87.408596, "o", "            # Get compressed size\r\n\u001b[?2004l\r"]
[87.408632, "o", "\u001b[?2004h"]
[87.408677, "o", "> "]
[87.409024, "o", "            gz_size = gz_file.stat().st_size\r\n\u001b[?2004l\r"]
[87.409051, "o", "\u001b[?2004h"]
[87.409207, "o", ">             \r\n\u001b[?2004l\r"]
[87.409254, "o", "\u001b[?2004h> "]
[87.409544, "o", "            # Update compliance data\r\n\u001b[?2004l\r"]
[87.409601, "o", "\u001b[?2004h> "]
[87.409951, "o", "            self.compliance_data.append({\r\n\u001b[?2004l\r"]
[87.410001, "o", "\u001b[?2004h> "]
[87.410353, "o", "                'filename': sql_file.name,\r\n\u001b[?2004l\r"]
[87.410405, "o", "\u001b[?2004h"]
[87.410445, "o", "> "]
[87.410752, "o", "                'n_size': normalized_size,\r\n\u001b[?2004l\r"]
[87.410791, "o", "\u001b[?2004h"]
[87.410832, "o", "> "]
[87.411109, "o", "                'gz_size': gz_size,\r\n\u001b[?2004l\r"]
[87.411162, "o", "\u001b[?2004h> "]
[87.411421, "o", "                'md5': md5_hash\r\n\u001b[?2004l\r"]
[87.411473, "o", "\u001b[?2004h> "]
[87.411604, "o", "            })\r\n\u001b[?2004l\r"]
[87.411651, "o", "\u001b[?2004h> "]
[87.411767, "o", "            \r\n\u001b[?2004l\r"]
[87.411812, "o", "\u001b[?2004h> "]
[87.412143, "o", "            # Remove original SQL file\r\n\u001b[?2004l\r"]
[87.412182, "o", "\u001b[?2004h"]
[87.412225, "o", "> "]
[87.41244, "o", "            sql_file.unlink()\r\n\u001b[?2004l\r"]
[87.412481, "o", "\u001b[?2004h"]
[87.412537, "o", "> "]
[87.413435, "o", "            print(f\"  Successfully processed: {sql_file.name} ({normalized_size} bytes) -> {gz_size} bytes gzipped\")\r\n\u001b[?2004l\r"]
[87.413489, "o", "\u001b[?2004h> "]
[87.413678, "o", "            return True\r\n\u001b[?2004l\r"]
[87.413719, "o", "\u001b[?2004h"]
[87.413762, "o", "> "]
[87.413826, "o", "            \r\n\u001b[?2004l\r"]
[87.413867, "o", "\u001b[?2004h"]
[87.413908, "o", "> "]
[87.414098, "o", "        except Exception as e:\r\n\u001b[?2004l\r"]
[87.414149, "o", "\u001b[?2004h> "]
[87.414547, "o", "            print(f\"Error compressing {sql_file.name}: {e}\")\r\n\u001b[?2004l\r"]
[87.414598, "o", "\u001b[?2004h> "]
[87.414769, "o", "            return False\r\n\u001b[?2004l\r"]
[87.41481, "o", "\u001b[?2004h"]
[87.414867, "o", ">     \r\n\u001b[?2004l\r"]
[87.414916, "o", "\u001b[?2004h> "]
[87.415144, "o", "    def generate_manifest(self):\r\n\u001b[?2004l\r"]
[87.415196, "o", "\u001b[?2004h"]
[87.415239, "o", "> "]
[87.415519, "o", "        \"\"\"Generate the manifest.json file\"\"\"\r\n\u001b[?2004l\r"]
[87.415567, "o", "\u001b[?2004h> "]
[87.415658, "o", "        try:\r\n\u001b[?2004l\r"]
[87.415711, "o", "\u001b[?2004h> "]
[87.416131, "o", "            manifest_path = self.logs_dir / 'manifest.json'\r\n\u001b[?2004l\r"]
[87.416208, "o", "\u001b[?2004h> "]
[87.416608, "o", "            with open(manifest_path, 'w', encoding='utf-8') as f:\r\n\u001b[?2004l\r"]
[87.416665, "o", "\u001b[?2004h> "]
[87.417018, "o", "                json.dump(self.manifest, f, indent=2)\r\n\u001b[?2004l\r"]
[87.417077, "o", "\u001b[?2004h> "]
[87.41745, "o", "            print(f\"Manifest generated: {manifest_path}\")\r\n\u001b[?2004l\r"]
[87.417507, "o", "\u001b[?2004h"]
[87.417547, "o", "> "]
[87.417739, "o", "            return manifest_path\r\n\u001b[?2004l\r"]
[87.417778, "o", "\u001b[?2004h"]
[87.417814, "o", "> "]
[87.418013, "o", "        except Exception as e:\r\n\u001b[?2004l\r"]
[87.418054, "o", "\u001b[?2004h> "]
[87.41841, "o", "            print(f\"Error generating manifest: {e}\")\r\n\u001b[?2004l\r"]
[87.418451, "o", "\u001b[?2004h"]
[87.418487, "o", "> "]
[87.418625, "o", "            return None\r\n\u001b[?2004l\r"]
[87.418665, "o", "\u001b[?2004h"]
[87.418704, "o", ">     \r\n"]
[87.41874, "o", "\u001b[?2004l\r"]
[87.418775, "o", "\u001b[?2004h> "]
[87.419153, "o", "    def calculate_manifest_sha256(self, manifest_path):\r\n\u001b[?2004l\r"]
[87.419192, "o", "\u001b[?2004h"]
[87.41923, "o", "> "]
[87.419556, "o", "        \"\"\"Calculate SHA256 hash of manifest file\"\"\"\r\n\u001b[?2004l\r"]
[87.419592, "o", "\u001b[?2004h"]
[87.419628, "o", "> "]
[87.419703, "o", "        try:\r\n\u001b[?2004l\r"]
[87.419739, "o", "\u001b[?2004h"]
[87.419774, "o", "> "]
[87.420017, "o", "            sha256 = hashlib.sha256()\r\n\u001b[?2004l\r"]
[87.420054, "o", "\u001b[?2004h"]
[87.42009, "o", "> "]
[87.420391, "o", "            with open(manifest_path, 'rb') as f:\r\n\u001b[?2004l\r"]
[87.420427, "o", "\u001b[?2004h"]
[87.420463, "o", "> "]
[87.420709, "o", "                sha256.update(f.read())\r\n\u001b[?2004l\r"]
[87.420744, "o", "\u001b[?2004h"]
[87.420779, "o", "> "]
[87.421031, "o", "            return sha256.hexdigest()\r\n\u001b[?2004l\r"]
[87.421067, "o", "\u001b[?2004h"]
[87.421103, "o", "> "]
[87.421285, "o", "        except Exception as e:\r\n\u001b[?2004l\r"]
[87.421321, "o", "\u001b[?2004h"]
[87.421356, "o", "> "]
[87.421721, "o", "            print(f\"Error calculating manifest hash: {e}\")\r\n\u001b[?2004l\r"]
[87.421757, "o", "\u001b[?2004h"]
[87.421793, "o", "> "]
[87.421979, "o", "            return 'UNKNOWN'\r\n\u001b[?2004l\r"]
[87.422016, "o", "\u001b[?2004h"]
[87.422052, "o", "> "]
[87.422087, "o", "    \r\n\u001b[?2004l\r"]
[87.422122, "o", "\u001b[?2004h> "]
[87.422395, "o", "    def custom_sort_key(self, filename):\r\n\u001b[?2004l\r"]
[87.422431, "o", "\u001b[?2004h"]
[87.422467, "o", "> "]
[87.422837, "o", "        \"\"\"Custom sort key: case-insensitive, _ before -\"\"\"\r\n\u001b[?2004l\r"]
[87.422873, "o", "\u001b[?2004h"]
[87.422914, "o", "> "]
[87.423228, "o", "        # Transform filename for custom collation\r\n\u001b[?2004l\r"]
[87.423265, "o", "\u001b[?2004h"]
[87.4233, "o", "> "]
[87.423676, "o", "        # Convert to lowercase for case-insensitive sorting\r\n\u001b[?2004l\r"]
[87.423722, "o", "\u001b[?2004h> "]
[87.424207, "o", "        # Replace hyphens with a character that sorts before underscore\r\n\u001b[?2004l\r"]
[87.424254, "o", "\u001b[?2004h> "]
[87.424605, "o", "        return filename.lower().replace('-', '\\x01')\r\n\u001b[?2004l\r"]
[87.424649, "o", "\u001b[?2004h> "]
[87.424692, "o", "    \r\n\u001b[?2004l\r"]
[87.424731, "o", "\u001b[?2004h"]
[87.424766, "o", "> "]
[87.425195, "o", "    def generate_compliance_report(self, manifest_path, batch_id):\r\n\u001b[?2004l\r"]
[87.425233, "o", "\u001b[?2004h"]
[87.425269, "o", "> "]
[87.42577, "o", "        \"\"\"Generate compliance report with specific encoding and line endings\"\"\"\r\n\u001b[?2004l\r"]
[87.425807, "o", "\u001b[?2004h"]
[87.425843, "o", "> "]
[87.425915, "o", "        try:\r\n\u001b[?2004l\r"]
[87.425973, "o", "\u001b[?2004h> "]
[87.426414, "o", "            report_path = self.logs_dir / 'compliance_report.log'\r\n\u001b[?2004l\r"]
[87.426455, "o", "\u001b[?2004h"]
[87.426491, "o", "> "]
[87.426561, "o", "            \r\n\u001b[?2004l\r"]
[87.426597, "o", "\u001b[?2004h"]
[87.426632, "o", "> "]
[87.426882, "o", "            # Calculate manifest SHA256\r\n\u001b[?2004l\r"]
[87.426918, "o", "\u001b[?2004h"]
[87.426964, "o", "> "]
[87.427441, "o", "            manifest_sha256 = self.calculate_manifest_sha256(manifest_path)\r\n\u001b[?2004l\r"]
[87.427479, "o", "\u001b[?2004h"]
[87.427518, "o", "> "]
[87.427584, "o", "            \r\n\u001b[?2004l\r"]
[87.427624, "o", "\u001b[?2004h"]
[87.427661, "o", "> "]
[87.42796, "o", "            # Sort files using custom collation\r\n\u001b[?2004l\r"]
[87.427999, "o", "\u001b[?2004h"]
[87.428037, "o", "> "]
[87.428708, "o", "            sorted_files = sorted(self.compliance_data, key=lambda x: self.custom_sort_key(x['filename']))\r\n\u001b[?2004l\r"]
[87.42876, "o", "\u001b[?2004h"]
[87.428796, "o", "> "]
[87.42886, "o", "            \r\n\u001b[?2004l\r"]
[87.428898, "o", "\u001b[?2004h"]
[87.428936, "o", "> "]
[87.429326, "o", "            # Create report content with Windows line endings\r\n\u001b[?2004l\r"]
[87.42936, "o", "\u001b[?2004h"]
[87.429398, "o", "> "]
[87.429588, "o", "            report_content = []\r\n\u001b[?2004l\r"]
[87.429625, "o", "\u001b[?2004h"]
[87.429669, "o", "> "]
[87.430046, "o", "            report_content.append(f\"BATCH: {batch_id}\\r\\n\")\r\n\u001b[?2004l\r"]
[87.430082, "o", "\u001b[?2004h"]
[87.43013, "o", "> "]
[87.430192, "o", "            \r\n\u001b[?2004l\r"]
[87.430226, "o", "\u001b[?2004h"]
[87.43029, "o", "> "]
[87.430529, "o", "            for file_data in sorted_files:\r\n\u001b[?2004l\r"]
[87.430568, "o", "\u001b[?2004h"]
[87.430604, "o", "> "]
[87.430987, "o", "                line = (f\"FILE: {file_data['filename']} | \"\r\n\u001b[?2004l\r"]
[87.431036, "o", "\u001b[?2004h"]
[87.431072, "o", "> "]
[87.431429, "o", "                        f\"N_SIZE: {file_data['n_size']} | \"\r\n\u001b[?2004l\r"]
[87.431465, "o", "\u001b[?2004h"]
[87.431501, "o", "> "]
[87.431888, "o", "                        f\"GZ_SIZE: {file_data['gz_size']} | \"\r\n\u001b[?2004l\r"]
[87.431926, "o", "\u001b[?2004h"]
[87.431977, "o", "> "]
[87.432288, "o", "                        f\"MD5: {file_data['md5']}\")\r\n\u001b[?2004l\r"]
[87.432327, "o", "\u001b[?2004h"]
[87.432365, "o", "> "]
[87.43269, "o", "                report_content.append(f\"{line}\\r\\n\")\r\n\u001b[?2004l\r"]
[87.432728, "o", "\u001b[?2004h"]
[87.432765, "o", "> "]
[87.432836, "o", "            \r\n\u001b[?2004l\r"]
[87.432874, "o", "\u001b[?2004h"]
[87.432911, "o", "> "]
[87.433398, "o", "            report_content.append(f\"MANIFEST_SHA256: {manifest_sha256}\\r\\n\")\r\n\u001b[?2004l\r"]
[87.433482, "o", "\u001b[?2004h> "]
[87.433544, "o", "            \r\n\u001b[?2004l\r"]
[87.433592, "o", "\u001b[?2004h> "]
[87.433988, "o", "            # Join all lines and encode in ISO-8859-1\r\n\u001b[?2004l\r"]
[87.434041, "o", "\u001b[?2004h> "]
[87.434513, "o", "            full_report = ''.join(report_content).encode('iso-8859-1')\r\n\u001b[?2004l\r"]
[87.43457, "o", "\u001b[?2004h> "]
[87.434694, "o", "            \r\n\u001b[?2004l\r"]
[87.434744, "o", "\u001b[?2004h> "]
[87.434965, "o", "            # Write to file\r\n\u001b[?2004l\r"]
[87.435019, "o", "\u001b[?2004h> "]
[87.435349, "o", "            with open(report_path, 'wb') as f:\r\n\u001b[?2004l\r"]
[87.4354, "o", "\u001b[?2004h> "]
[87.435665, "o", "                f.write(full_report)\r\n\u001b[?2004l\r"]
[87.435703, "o", "\u001b[?2004h"]
[87.435743, "o", "> "]
[87.435832, "o", "            \r\n\u001b[?2004l\r"]
[87.435872, "o", "\u001b[?2004h"]
[87.43591, "o", "> "]
[87.436344, "o", "            print(f\"Compliance report generated: {report_path}\")\r\n\u001b[?2004l\r"]
[87.436384, "o", "\u001b[?2004h"]
[87.436421, "o", "> "]
[87.436586, "o", "            return True\r\n\u001b[?2004l\r"]
[87.43663, "o", "\u001b[?2004h"]
[87.436669, "o", "> "]
[87.436756, "o", "            \r\n\u001b[?2004l\r"]
[87.436795, "o", "\u001b[?2004h"]
[87.436838, "o", "> "]
[87.437056, "o", "        except Exception as e:\r\n\u001b[?2004l\r"]
[87.437095, "o", "\u001b[?2004h"]
[87.437132, "o", "> "]
[87.437484, "o", "            print(f\"Error generating compliance report: {e}\")\r\n\u001b[?2004l\r"]
[87.437519, "o", "\u001b[?2004h> "]
[87.437647, "o", "            return False\r\n\u001b[?2004l\r"]
[87.437684, "o", "\u001b[?2004h> "]
[87.437713, "o", "    \r\n\u001b[?2004l\r"]
[87.43776, "o", "\u001b[?2004h> "]
[87.437848, "o", "    def run(self):\r\n\u001b[?2004l\r"]
[87.437884, "o", "\u001b[?2004h> "]
[87.438092, "o", "        \"\"\"Main processing function\"\"\"\r\n\u001b[?2004l\r"]
[87.438144, "o", "\u001b[?2004h> "]
[87.438384, "o", "        print(\"Starting backup processing pipeline...\")\r\n\u001b[?2004l\r"]
[87.438439, "o", "\u001b[?2004h> "]
[87.438486, "o", "        \r\n\u001b[?2004l\r\u001b[?2004h"]
[87.438543, "o", "> "]
[87.438686, "o", "        # Ensure logs directory exists\r\n\u001b[?2004l\r"]
[87.438728, "o", "\u001b[?2004h> "]
[87.43899, "o", "        self.logs_dir.mkdir(parents=True, exist_ok=True)\r\n\u001b[?2004l\r"]
[87.439026, "o", "\u001b[?2004h> "]
[87.439084, "o", "        \r\n\u001b[?2004l\r"]
[87.43912, "o", "\u001b[?2004h> "]
[87.43924, "o", "        # Read Batch ID\r\n\u001b[?2004l\r"]
[87.43928, "o", "\u001b[?2004h> "]
[87.439463, "o", "        batch_id = self.read_batch_id()\r\n\u001b[?2004l\r"]
[87.439499, "o", "\u001b[?2004h> "]
[87.439705, "o", "        print(f\"Using Batch ID: {batch_id}\")\r\n\u001b[?2004l\r"]
[87.439742, "o", "\u001b[?2004h> "]
[87.439791, "o", "        \r\n\u001b[?2004l\r"]
[87.439837, "o", "\u001b[?2004h> "]
[87.439982, "o", "        # Process SQL files\r\n\u001b[?2004l\r"]
[87.440026, "o", "\u001b[?2004h> "]
[87.440279, "o", "        sql_files = list(self.backup_dir.glob('*.sql'))\r\n\u001b[?2004l\r"]
[87.440329, "o", "\u001b[?2004h> "]
[87.440593, "o", "        print(f\"Found {len(sql_files)} SQL files to process\")\r\n\u001b[?2004l\r"]
[87.440669, "o", "\u001b[?2004h>         \r\n\u001b[?2004l\r"]
[87.440718, "o", "\u001b[?2004h> "]
[87.440841, "o", "        if not sql_files:\r\n\u001b[?2004l\r"]
[87.440883, "o", "\u001b[?2004h> "]
[87.441188, "o", "            print(\"No SQL files found. Creating empty manifests.\")\r\n\u001b[?2004l\r"]
[87.441226, "o", "\u001b[?2004h> "]
[87.441269, "o", "        \r\n\u001b[?2004l\r"]
[87.441306, "o", "\u001b[?2004h> "]
[87.441483, "o", "        for sql_file in sql_files:\r\n\u001b[?2004l\r"]
[87.441519, "o", "\u001b[?2004h> "]
[87.44171, "o", "            self.process_file(sql_file)\r\n\u001b[?2004l\r"]
[87.44175, "o", "\u001b[?2004h> "]
[87.441793, "o", "        \r\n\u001b[?2004l\r"]
[87.441831, "o", "\u001b[?2004h> "]
[87.441983, "o", "        # Generate manifest\r\n\u001b[?2004l\r"]
[87.442023, "o", "\u001b[?2004h> "]
[87.442244, "o", "        manifest_path = self.generate_manifest()\r\n\u001b[?2004l\r"]
[87.442281, "o", "\u001b[?2004h> "]
[87.442426, "o", "        if not manifest_path:\r\n\u001b[?2004l\r"]
[87.442462, "o", "\u001b[?2004h> "]
[87.442586, "o", "            return False\r\n\u001b[?2004l\r"]
[87.442623, "o", "\u001b[?2004h> "]
[87.442672, "o", "        \r\n\u001b[?2004l\r"]
[87.442707, "o", "\u001b[?2004h> "]
[87.442889, "o", "        # Generate compliance report\r\n\u001b[?2004l\r"]
[87.442935, "o", "\u001b[?2004h> "]
[87.443269, "o", "        success = self.generate_compliance_report(manifest_path, batch_id)\r\n\u001b[?2004l\r"]
[87.443306, "o", "\u001b[?2004h> "]
[87.443354, "o", "        \r\n\u001b[?2004l\r"]
[87.443398, "o", "\u001b[?2004h> "]
[87.443617, "o", "        print(\"Backup processing completed!\")\r\n\u001b[?2004l\r"]
[87.44366, "o", "\u001b[?2004h> "]
[87.443773, "o", "        return success\r\n\u001b[?2004l\r"]
[87.44381, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[87.443844, "o", "\u001b[?2004h"]
[87.44388, "o", "> \r\n\u001b[?2004l\r\u001b[?2004h"]
[87.443915, "o", "> "]
[87.444058, "o", "if __name__ == '__main__':\r\n\u001b[?2004l\r"]
[87.444096, "o", "\u001b[?2004h> "]
[87.44426, "o", "    processor = BackupProcessor()\r\n\u001b[?2004l\r"]
[87.444297, "o", "\u001b[?2004h> "]
[87.444404, "o", "    processor.run()\r\n\u001b[?2004l\r"]
[87.444442, "o", "\u001b[?2004h> "]
[87.444481, "o", "EOF\r\n\u001b[?2004l\r"]
[87.445909, "o", "\u001b[?2004h"]
[87.445956, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[88.302169, "i", "chmod +x /home/user/process_backups.py\n"]
[88.302345, "o", "chmod +x /home/user/process_backups.py\r\n"]
[88.302379, "o", "\u001b[?2004l\r"]
[88.303911, "o", "\u001b[?2004h"]
[88.303935, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[109.176035, "i", "python3 /home/user/process_backups.py\n"]
[109.176192, "o", "python3 /home/user/process_backups.py\r\n\u001b[?2004l\r"]
[109.202291, "o", "Starting backup processing pipeline...\r\n"]
[109.202388, "o", "Using Batch ID: 20240213-01\r\n"]
[109.20257, "o", "Found 10 SQL files to process\r\nProcessing   test_file.sql...\r\n"]
[109.20297, "o", "  Successfully processed:   test_file.sql (66 bytes) -> 93 bytes gzipped\r\nProcessing data_v1.sql...\r\n"]
[109.203261, "o", "  Successfully processed: data_v1.sql (60 bytes) -> 77 bytes gzipped\r\nProcessing data-v1.sql...\r\n"]
[109.203548, "o", "  Successfully processed: data-v1.sql (80 bytes) -> 105 bytes gzipped\r\nProcessing readonly_file.sql...\r\n"]
[109.203817, "o", "  Successfully processed: readonly_file.sql (57 bytes) -> 95 bytes gzipped\r\nProcessing normal_file.sql...\r\n"]
[109.204097, "o", "  Successfully processed: normal_file.sql (63 bytes) -> 91 bytes gzipped\r\nProcessing archived.sql...\r\n"]
[109.204345, "o", "  Successfully processed: archived.sql (11 bytes) -> 44 bytes gzipped\r\nProcessing inventory_2023.sql...\r\n"]
[109.204553, "o", "  Successfully processed: inventory_2023.sql (8 bytes) -> 47 bytes gzipped\r\nProcessing inventory-2023.sql...\r\n"]
[109.204776, "o", "  Successfully processed: inventory-2023.sql (8 bytes) -> 47 bytes gzipped\r\nProcessing  orders.sql...\r\n"]
[109.204963, "o", "  Successfully processed:  orders.sql (49 bytes) -> 77 bytes gzipped\r\nProcessing customers.sql...\r\n"]
[109.20523, "o", "  Successfully processed: customers.sql (62 bytes) -> 89 bytes gzipped\r\n"]
[109.205332, "o", "Manifest generated: /home/user/backup_logs/manifest.json\r\n"]
[109.20543, "o", "Compliance report generated: /home/user/backup_logs/compliance_report.log\r\nBackup processing completed!\r\n"]
[109.208664, "o", "\u001b[?2004hroot@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[112.053184, "i", "ls -la /home/user/db_backups/\n"]
[112.053523, "o", "ls -la /home/user/db_backups/\r\n\u001b[?2004l\r"]
[112.05608, "o", "total 48\r\ndrwxrwxrwx 1 root root 4096 Feb 13 18:58  \u001b[0m\u001b[34;42m.\u001b[0m\r\ndrwxr-xr-x 1 root root  104 Feb 13 18:58  \u001b[01;34m..\u001b[0m\r\n"]
[112.05619, "o", "-rw-r--r-- 1 root root   44 Feb 13 18:58  \u001b[01;31marchived.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root   99 Feb 13 18:57  batch_config.txt\r\n-rw-r--r-- 1 root root   89 Feb 13 18:58  \u001b[01;31mcustomers.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root  105 Feb 13 18:58  \u001b[01;31mdata-v1.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root   77 Feb 13 18:58  \u001b[01;31mdata_v1.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root   47 Feb 13 18:58  \u001b[01;31minventory-2023.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root   47 Feb 13 18:58  \u001b[01;31minventory_2023.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root   91 Feb 13 18:58  \u001b[01;31mnormal_file.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root   77 Feb 13 18:58 \u001b[01;31m' orders.sql.gz'\u001b[0m\r\n-rw-r--r-- 1 root root   95 Feb 13 18:58  \u001b[01;31mreadonly_file.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root   93 Feb 13 18:58 \u001b[01;31m'  test_file.sql.gz'\u001b[0m\r\n"]
[112.056592, "o", "\u001b[?2004h"]
[112.05666, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[112.670208, "i", "ls -la /home/user/backup_logs/\n"]
[112.670545, "o", "ls -la /home/user/backup_logs/\r\n\u001b[?2004l\r"]
[112.672642, "o", "total 8\r\n"]
[112.672713, "o", "drwxr-xr-x 2 root root  68 Feb 13 18:58 \u001b[0m\u001b[01;34m.\u001b[0m\r\ndrwxr-xr-x 1 root root 104 Feb 13 18:58 \u001b[01;34m..\u001b[0m\r\n-rw-r--r-- 1 root root 993 Feb 13 18:58 compliance_report.log\r\n-rw-r--r-- 1 root root 241 Feb 13 18:58 manifest.json\r\n"]
[112.673103, "o", "\u001b[?2004h"]
[112.673161, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[125.888994, "i", "cat /home/user/backup_logs/manifest.json\n"]
[125.889217, "o", "cat /home/user/backup_logs/manifest.json\r\n\u001b[?2004l\r"]
[125.890177, "o", "{\r\n  \"  test_file.sql\": 66,\r\n  \"data_v1.sql\": 60,\r\n  \"data-v1.sql\": 80,\r\n  \"readonly_file.sql\": 57,\r\n  \"normal_file.sql\": 63,\r\n  \"archived.sql\": 11,\r\n  \"inventory_2023.sql\": 8,\r\n  \"inventory-2023.sql\": 8,\r\n  \" orders.sql\": 49,\r\n  \"customers.sql\": 62\r\n}"]
[125.89044, "o", "\u001b[?2004h"]
[125.890478, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[126.313596, "i", "file /home/user/backup_logs/compliance_report.log\n"]
[126.313906, "o", "file /home/user/backup_logs/compliance_report.log\r\n\u001b[?2004l\r"]
[126.31483, "o", "bash: file: command not found\r\n"]
[126.315283, "o", "\u001b[?2004h"]
[126.315319, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[126.660742, "i", "head -5 /home/user/backup_logs/compliance_report.log\n"]
[126.661197, "o", "head -5 /home/user/backup_logs/compliance_report.log\r\n\u001b[?2004l\r"]
[126.662402, "o", "BATCH: 20240213-01\r\r\nFILE:   test_file.sql | N_SIZE: 66 | GZ_SIZE: 93 | MD5: 7532ad23212e2d19f9085469ad3425fd\r\r\nFILE:  orders.sql | N_SIZE: 49 | GZ_SIZE: 77 | MD5: 8ee19ebb13f523c637e1160e8cada7d8\r\r\nFILE: archived.sql | N_SIZE: 11 | GZ_SIZE: 44 | MD5: 6cec306c89a8a39e0ac3daee14954bb7\r\r\nFILE: customers.sql | N_SIZE: 62 | GZ_SIZE: 89 | MD5: 21b035be4df476520d1c30c8c70c91b7\r\r\n"]
[126.662677, "o", "\u001b[?2004h"]
[126.662729, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[127.17598, "i", "tail -2 /home/user/backup_logs/compliance_report.log | iconv -f ISO-8859-1 -t UTF-8\n"]
[127.176726, "o", "tail -2 /home/user/backup_logs/compliance_report.log | iconv -f ISO-8859-1 -t UTF-8\r\n\u001b[?2004l\r"]
[127.17884, "o", "FILE: readonly_file.sql | N_SIZE: 57 | GZ_SIZE: 95 | MD5: a2d1ea0eae788207c3febb50a90fc2e1\r\r\nMANIFEST_SHA256: 2c9619a3b7860334c49df326864df574b68416eb72e2dfaa03880374e41f5b53\r\r\n"]
[127.179193, "o", "\u001b[?2004h"]
[127.179259, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[127.557558, "i", "sha256sum /home/user/backup_logs/manifest.json\n"]
[127.557997, "o", "sha256sum /home/user/backup_logs/manifest.json\r\n"]
[127.558008, "o", "\u001b[?2004l\r"]
[127.559481, "o", "2c9619a3b7860334c49df326864df574b68416eb72e2dfaa03880374e41f5b53  /home/user/backup_logs/manifest.json\r\n"]
[127.559777, "o", "\u001b[?2004h"]
[127.559809, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[142.852183, "i", "ls -la --time-style=full-iso /home/user/db_backups/*.gz\n"]
[142.852655, "o", "ls -la --time-style=full-iso /home/user/db_backups/*.gz\r\n\u001b[?2004l\r"]
[142.8552, "o", "-rw-r--r-- 1 root root  44 2026-02-13 18:58:30.295442374 +0000  \u001b[0m\u001b[01;31m/home/user/db_backups/archived.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root  89 2026-02-13 18:58:30.296442372 +0000  \u001b[01;31m/home/user/db_backups/customers.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root 105 2026-02-13 18:58:30.294442375 +0000  \u001b[01;31m/home/user/db_backups/data-v1.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root  77 2026-02-13 18:58:30.294442375 +0000  \u001b[01;31m/home/user/db_backups/data_v1.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root  47 2026-02-13 18:58:30.295442374 +0000  \u001b[01;31m/home/user/db_backups/inventory-2023.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root  47 2026-02-13 18:58:30.295442374 +0000  \u001b[01;31m/home/user/db_backups/inventory_2023.sql.gz\u001b[0m\r\n"]
[142.855311, "o", "-rw-r--r-- 1 root root  91 2026-02-13 18:58:30.295442374 +0000  \u001b[01;31m/home/user/db_backups/normal_file.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root  77 2026-02-13 18:58:30.295442374 +0000 \u001b[01;31m'/home/user/db_backups/ orders.sql.gz'\u001b[0m\r\n-rw-r--r-- 1 root root  95 2026-02-13 18:58:30.294442375 +0000  \u001b[01;31m/home/user/db_backups/readonly_file.sql.gz\u001b[0m\r\n-rw-r--r-- 1 root root  93 2026-02-13 18:58:30.293442377 +0000 \u001b[01;31m'/home/user/db_backups/  test_file.sql.gz'\u001b[0m\r\n"]
[142.855733, "o", "\u001b[?2004h"]
[142.855798, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[143.440442, "i", "echo \"=== Verification Summary ===\"\n"]
[143.440584, "o", "echo \"=== Verification Summary ===\"\r\n\u001b[?2004l\r"]
[143.440639, "o", "=== Verification Summary ===\r\n"]
[143.440681, "o", "\u001b[?2004hroot@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[143.581049, "i", "echo \"1. Backup directory contains only .gz files: ✓\"\n"]
[143.581457, "o", "echo \"1. Backup directory contains only .gz files: ✓\"\r\n\u001b[?2004l\r"]
[143.581523, "o", "1. Backup directory contains only .gz files: ✓\r\n"]
[143.581563, "o", "\u001b[?2004h"]
[143.5816, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[143.721534, "i", "echo \"2. Manifest.json generated with correct sizes: ✓\"\n"]
[143.722035, "o", "echo \"2. Manifest.json generated with correct sizes: ✓\"\r\n\u001b[?2004l\r"]
[143.722119, "o", "2. Manifest.json generated with correct sizes: ✓\r\n"]
[143.722182, "o", "\u001b[?2004hroot@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[143.938307, "i", "echo \"3. Compliance report generated with correct Batch ID: ✓\"\n"]
[143.938829, "o", "echo \"3. Compliance report generated with correct Batch ID: ✓\"\r\n\u001b[?2004l\r"]
[143.938957, "o", "3. Compliance report generated with correct Batch ID: ✓\r\n"]
[143.939018, "o", "\u001b[?2004h"]
[143.939077, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[144.175194, "i", "echo \"4. Custom sorting applied correctly: ✓\"\n"]
[144.175586, "o", "echo \"4. Custom sorting applied correctly: ✓\"\r\n\u001b[?2004l\r"]
[144.175683, "o", "4. Custom sorting applied correctly: ✓\r\n"]
[144.17574, "o", "\u001b[?2004h"]
[144.175788, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[144.44685, "i", "echo \"5. Manifest SHA256 matches in report footer: ✓\"\n"]
[144.447372, "o", "echo \"5. Manifest SHA256 matches in report footer: ✓\"\r\n\u001b[?2004l\r"]
[144.447437, "o", "5. Manifest SHA256 matches in report footer: ✓\r\n"]
[144.447508, "o", "\u001b[?2004h"]
[144.447556, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[144.734484, "i", "echo \"6. Files processed according to requirements: ✓\"\n"]
[144.734815, "o", "echo \"6. Files processed according to requirements: ✓\"\r\n\u001b[?2004l\r"]
[144.734876, "o", "6. Files processed according to requirements: ✓\r\n"]
[144.734928, "o", "\u001b[?2004h"]
[144.734967, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[154.301164, "i", "echo \"7. Compressed files have current timestamps: ✓\"\n"]
[154.30158, "o", "echo \"7. Compressed files have current timestamps: ✓\"\r\n\u001b[?2004l\r"]
[154.30165, "o", "7. Compressed files have current timestamps: ✓\r\n"]
[154.301718, "o", "\u001b[?2004h"]
[154.301774, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
[154.433443, "i", "echo \"All requirements met - backup pipeline modernization complete!\"\n"]
[154.433949, "o", "echo \"All requirements met - backup pipeline modernization complete!\"\r\n\u001b[?2004l\r"]
[154.43402, "o", "All requirements met - backup pipeline modernization complete!\r\n"]
[154.434092, "o", "\u001b[?2004h"]
[154.434119, "o", "root@65828d79-39a2-4a26-86c7-82bbffd02509:/home/user/db_backups# "]
