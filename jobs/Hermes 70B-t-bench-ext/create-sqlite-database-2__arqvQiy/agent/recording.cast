{"version": 2, "width": 160, "height": 40, "timestamp": 1771009139, "env": {"SHELL": "/bin/bash", "TERM": "screen"}}
[0.00613, "o", "\u001b[?2004h"]
[0.006571, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[0.971254, "i", "clear\r"]
[0.971423, "o", "clear\r\n\u001b[?2004l\r"]
[0.972433, "o", "\u001b[H\u001b[J"]
[0.972615, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[11.414105, "i", "mkdir -p configs db logs reports\n"]
[11.41427, "o", "mkdir -p configs db logs reports\r\n\u001b[?2004l\r"]
[11.417537, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[43.782241, "i", "cat > configs/ssh.cfg << 'EOF'\r\n# SSH Config File - Original\r\nHost localhost\r\n  User root\r\n  Port 22\r\n  IdentityFile ~/.ssh/id_rsa\r\nEOF\n"]
[43.782639, "o", "cat > configs/ssh.cfg << 'EOF'\r\n\u001b[?2004l\r"]
[43.782731, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r\u001b[?2004h"]
[43.782786, "o", "> "]
[43.783002, "o", "# SSH Config File - Original\r\n\u001b[?2004l\r\u001b[?2004h"]
[43.78316, "o", "> \r\n\u001b[?2004l\r\u001b[?2004h> "]
[43.783203, "o", "Host localhost\r\n\u001b[?2004l\r"]
[43.783323, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r\u001b[?2004h> "]
[43.783455, "o", "  User root\r\n\u001b[?2004l\r"]
[43.783527, "o", "\u001b[?2004h"]
[43.783578, "o", "> \r\n\u001b[?2004l\r\u001b[?2004h"]
[43.783638, "o", "> "]
[43.783722, "o", "  Port 22\r\n\u001b[?2004l\r"]
[43.783772, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[43.783827, "o", "\u001b[?2004h"]
[43.783886, "o", "> "]
[43.784067, "o", "  IdentityFile ~/.ssh/id_rsa\r\n\u001b[?2004l\r"]
[43.784112, "o", "\u001b[?2004h"]
[43.784155, "o", "> \r\n\u001b[?2004l\r"]
[43.784196, "o", "\u001b[?2004h"]
[43.784239, "o", "> EOF"]
[43.784321, "o", "\r\n\u001b[?2004l\r"]
[43.787569, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[43.861721, "i", "cat > configs/nginx.conf << 'EOF'\n# Nginx Configuration\n# Copyright © 2023 Company Ltd.\n# UTF-8 encoded file\nuser nginx;\nworker_processes auto;\nEOF\n"]
[43.862154, "o", "cat > configs/nginx.conf << 'EOF'\r\n\u001b[?2004l\r"]
[43.862221, "o", "\u001b[?2004h> "]
[43.862402, "o", "# Nginx Configuration\r\n\u001b[?2004l\r"]
[43.862462, "o", "\u001b[?2004h> "]
[43.862724, "o", "# Copyright © 2023 Company Ltd.\r\n\u001b[?2004l\r"]
[43.862776, "o", "\u001b[?2004h> "]
[43.862942, "o", "# UTF-8 encoded file\r\n\u001b[?2004l\r"]
[43.862997, "o", "\u001b[?2004h> "]
[43.863108, "o", "user nginx;\r\n\u001b[?2004l\r"]
[43.863147, "o", "\u001b[?2004h"]
[43.863194, "o", "> "]
[43.863348, "o", "worker_processes auto;\r\n\u001b[?2004l\r"]
[43.863389, "o", "\u001b[?2004h"]
[43.863441, "o", "> EOF\r\n"]
[43.863492, "o", "\u001b[?2004l\r"]
[43.865524, "o", "\u001b[?2004h"]
[43.865584, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[44.01948, "i", "cat > configs/app.ini << 'EOF'\n[General]\n  debug = false\n  port = 8080\n  timeout = 30\n\n[Database]\n  host = localhost\n  dbname = appdb\n  user = appuser\n  password = secret\nEOF\n"]
[44.019805, "o", "cat > configs/app.ini << 'EOF'\r\n\u001b[?2004l\r"]
[44.019884, "o", "\u001b[?2004h"]
[44.019942, "o", "> "]
[44.019996, "o", "[General]\r\n\u001b[?2004l\r"]
[44.020045, "o", "\u001b[?2004h> "]
[44.020154, "o", "  debug = false\r\n\u001b[?2004l\r"]
[44.02021, "o", "\u001b[?2004h> "]
[44.02029, "o", "  port = 8080\r\n\u001b[?2004l\r"]
[44.02034, "o", "\u001b[?2004h> "]
[44.020449, "o", "  timeout = 30\r\n\u001b[?2004l\r"]
[44.020495, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[44.020542, "o", "\u001b[?2004h"]
[44.020585, "o", "> "]
[44.020636, "o", "[Database]\r\n\u001b[?2004l\r"]
[44.020704, "o", "\u001b[?2004h> "]
[44.020836, "o", "  host = localhost\r\n\u001b[?2004l\r"]
[44.020876, "o", "\u001b[?2004h"]
[44.020922, "o", "> "]
[44.021008, "o", "  dbname = appdb\r\n\u001b[?2004l\r"]
[44.021055, "o", "\u001b[?2004h> "]
[44.021174, "o", "  user = appuser\r\n\u001b[?2004l\r"]
[44.021223, "o", "\u001b[?2004h"]
[44.021265, "o", "> "]
[44.021381, "o", "  password = secret\r\n\u001b[?2004l\r"]
[44.021437, "o", "\u001b[?2004h> "]
[44.02149, "o", "EOF\r\n\u001b[?2004l\r"]
[44.024269, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[44.113784, "i", "touch configs/.hidden_file\n"]
[44.114072, "o", "touch configs/.hidden_file\r\n"]
[44.11414, "o", "\u001b[?2004l\r"]
[44.11556, "o", "\u001b[?2004h"]
[44.115616, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[44.246101, "i", "cp configs/ssh.cfg configs/ssh.cfg.bak\n"]
[44.246482, "o", "cp configs/ssh.cfg configs/ssh.cfg.bak\r\n\u001b[?2004l\r"]
[44.248532, "o", "\u001b[?2004h"]
[44.248613, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[44.341876, "i", "echo 'v2.0-RC1' > /home/user/version.txt\n"]
[44.342214, "o", "echo 'v2.0-RC1' > /home/user/version.txt\r\n\u001b[?2004l\r"]
[44.343135, "o", "\u001b[?2004h"]
[44.343197, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[57.949984, "i", "dos2unix configs/ssh.cfg\n"]
[57.950281, "o", "dos2unix configs/ssh.cfg\r\n\u001b[?2004l\r"]
[57.951135, "o", "bash: dos2unix: command not found\r\n"]
[57.951474, "o", "\u001b[?2004h"]
[57.951573, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[58.027091, "i", "sed -i 's/[ \\t]*$//' configs/app.ini\n"]
[58.02743, "o", "sed -i 's/[ \\t]*$//' configs/app.ini\r\n"]
[58.02746, "o", "\u001b[?2004l\r"]
[58.029346, "o", "\u001b[?2004h"]
[58.029395, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[58.123782, "i", "rm configs/.hidden_file configs/ssh.cfg.bak\n"]
[58.12404, "o", "rm configs/.hidden_file configs/ssh.cfg.bak\r\n\u001b[?2004l\r"]
[58.125243, "o", "\u001b[?2004h"]
[58.125306, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[58.407462, "i", "file configs/*\n"]
[58.407665, "o", "file configs/*\r\n"]
[58.407709, "o", "\u001b[?2004l\r"]
[58.40867, "o", "bash: file: command not found\r\n"]
[58.40901, "o", "\u001b[?2004h"]
[58.409045, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[70.992826, "i", "sed -i 's/\\r$//' configs/ssh.cfg\n"]
[70.993162, "o", "sed -i 's/\\r$//' configs/ssh.cfg\r\n\u001b[?2004l\r"]
[70.995075, "o", "\u001b[?2004h"]
[70.995098, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[71.102618, "i", "cat configs/ssh.cfg\n"]
[71.102844, "o", "cat configs/ssh.cfg\r\n\u001b[?2004l\r"]
[71.103728, "o", "\r\n# SSH Config File - Original\r\n\r\nHost localhost\r\n\r\n  User root\r\n\r\n  Port 22\r\n\r\n  IdentityFile ~/.ssh/id_rsa\r\n\r\n"]
[71.10394, "o", "\u001b[?2004h"]
[71.103993, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[71.25807, "i", "cat configs/nginx.conf\n"]
[71.258186, "o", "cat configs/nginx.conf\r\n\u001b[?2004l\r"]
[71.259027, "o", "# Nginx Configuration\r\n# Copyright © 2023 Company Ltd.\r\n# UTF-8 encoded file\r\nuser nginx;\r\nworker_processes auto;\r\n"]
[71.259215, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[89.934243, "i", "sqlite3 db/audit.db \"\nCREATE TABLE tracked_files (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    rel_path TEXT NOT NULL UNIQUE,\n    file_hash TEXT NOT NULL,\n    magic_hex TEXT NOT NULL,\n    size_bytes INTEGER NOT NULL\n);\n\" > logs/sql_history.log 2>&1\n"]
[89.934418, "o", "sqlite3 db/audit.db \"\r\n\u001b[?2004l\r\u001b[?2004h> "]
[89.934506, "o", "CREATE TABLE tracked_files (\r\n\u001b[?2004l\r\u001b[?2004h"]
[89.934566, "o", "> "]
[89.93464, "o", "    id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n\u001b[?2004l\r\u001b[?2004h> "]
[89.934767, "o", "    rel_path TEXT NOT NULL UNIQUE,\r\n\u001b[?2004l\r\u001b[?2004h> "]
[89.934889, "o", "    file_hash TEXT NOT NULL,\r\n\u001b[?2004l\r\u001b[?2004h> "]
[89.934972, "o", "    magic_hex TEXT NOT NULL,\r\n\u001b[?2004l\r\u001b[?2004h> "]
[89.935069, "o", "    size_bytes INTEGER NOT NULL\r\n\u001b[?2004l\r\u001b[?2004h> "]
[89.935124, "o", ");\r\n\u001b[?2004l\r\u001b[?2004h> "]
[89.935202, "o", "\" > logs/sql_history.log 2>&1\r\n\u001b[?2004l\r"]
[89.938998, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[90.012892, "i", "sqlite3 db/audit.db \"\nCREATE TABLE audit_events (\n    event_id INTEGER PRIMARY KEY AUTOINCREMENT,\n    file_id INTEGER NOT NULL,\n    event_type TEXT NOT NULL CHECK(event_type IN ('INIT', 'MODIFY', 'PERM')),\n    event_ts TEXT NOT NULL,\n    FOREIGN KEY(file_id) REFERENCES tracked_files(id)\n);\n\" >> logs/sql_history.log 2>&1\n"]
[90.013101, "o", "sqlite3 db/audit.db \"\r\n\u001b[?2004l\r"]
[90.013189, "o", "\u001b[?2004h> "]
[90.013426, "o", "CREATE TABLE audit_events (\r\n\u001b[?2004l\r"]
[90.013477, "o", "\u001b[?2004h"]
[90.0135, "o", "> "]
[90.013893, "o", "    event_id INTEGER PRIMARY KEY AUTOINCREMENT,\r\n\u001b[?2004l\r"]
[90.013946, "o", "\u001b[?2004h"]
[90.013968, "o", "> "]
[90.014204, "o", "    file_id INTEGER NOT NULL,\r\n"]
[90.014222, "o", "\u001b[?2004l\r"]
[90.01425, "o", "\u001b[?2004h"]
[90.014273, "o", "> "]
[90.014888, "o", "    event_type TEXT NOT NULL CHECK(event_type IN ('INIT', 'MODIFY', 'PERM')),\r\n"]
[90.014921, "o", "\u001b[?2004l\r"]
[90.014943, "o", "\u001b[?2004h"]
[90.014965, "o", "> "]
[90.015194, "o", "    event_ts TEXT NOT NULL,\r\n"]
[90.015216, "o", "\u001b[?2004l\r"]
[90.015246, "o", "\u001b[?2004h"]
[90.015272, "o", "> "]
[90.015741, "o", "    FOREIGN KEY(file_id) REFERENCES tracked_files(id)\r\n\u001b[?2004l\r"]
[90.015791, "o", "\u001b[?2004h"]
[90.015815, "o", "> "]
[90.015844, "o", ");\r\n"]
[90.015861, "o", "\u001b[?2004l\r"]
[90.015901, "o", "\u001b[?2004h"]
[90.015925, "o", "> "]
[90.016176, "o", "\" >> logs/sql_history.log 2>&1\r\n"]
[90.016195, "o", "\u001b[?2004l\r"]
[90.019291, "o", "\u001b[?2004h"]
[90.019339, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[108.376816, "i", "cat > load_initial.sh << 'EOF'\n#!/bin/bash\n\nDB=\"db/audit.db\"\nCONFIG_DIR=\"configs\"\nSQL_LOG=\"logs/sql_history.log\"\n\n# Insert initial file records\nfor file_path in \"$CONFIG_DIR\"/*; do\n    rel_path=\"$(basename \"$file_path\")\"\n    \n    # Calculate SHA-256 hash\n    file_hash=\"$(sha256sum \"$file_path\" | cut -d' ' -f1)\"\n    \n    # Get first 4 bytes as lowercase hex\n    magic_hex=\"$(od -An -tx1 -j0 -N4 \"$file_path\" | tr -d ' \\n' | awk '{print tolower($0)}')\"\n    \n    # Get file size in bytes\n    size_bytes=\"$(stat -c%s \"$file_path\")\"\n    \n    # Get modification timestamp (ISO-8601 format)\n    mtime_utc=\"$(date -u -d \"$(stat -c%y \"$file_path\" | cut -d'.' -f1)\" +'%Y-%m-%dT%H:%M:%SZ')\"\n    \n    # Insert into tracked_files\n    sqlite3 \"$DB\" \"INSERT INTO tracked_files (rel_path, file_hash, magic_hex, size_bytes) VALUES('$rel_path', '$file_hash', '$magic_hex', $size_bytes);\" >> \"$SQL_LOG\" 2>&1\n    \n    # Get the file_id\n    file_id=\"$(sqlite3 \"$DB\" \"SELECT id FROM tracked_files WHERE rel_path = '$rel_path';\" | grep -v id)\"\n "]
[108.376932, "i", "   \n    # Insert INIT event\n    sqlite3 \"$DB\" \"INSERT INTO audit_events (file_id, event_type, event_ts) VALUES($file_id, 'INIT', '$mtime_utc');\" >> \"$SQL_LOG\" 2>&1\n    \ndone\n\necho \"-- Initial load completed\" >> \"$SQL_LOG\"\nEOF\n\nchmod +x load_initial.sh\n"]
[108.376966, "o", "cat > load_initial.sh << 'EOF'\r\n\u001b[?2004l\r"]
[108.377013, "o", "\u001b[?2004h> "]
[108.377053, "o", "#!/bin/bash\r\n\u001b[?2004l\r"]
[108.377079, "o", "\u001b[?2004h"]
[108.377101, "o", "> \r\n\u001b[?2004l\r\u001b[?2004h> "]
[108.377151, "o", "DB=\"db/audit.db\"\r\n\u001b[?2004l\r"]
[108.377171, "o", "\u001b[?2004h> "]
[108.377229, "o", "CONFIG_DIR=\"configs\"\r\n\u001b[?2004l\r"]
[108.377249, "o", "\u001b[?2004h> "]
[108.37733, "o", "SQL_LOG=\"logs/sql_history.log\"\r\n\u001b[?2004l\r"]
[108.377351, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[108.377372, "o", "\u001b[?2004h"]
[108.377391, "o", "> "]
[108.377458, "o", "# Insert initial file records\r\n\u001b[?2004l\r"]
[108.377476, "o", "\u001b[?2004h> "]
[108.377583, "o", "for file_path in \"$CONFIG_DIR\"/*; do\r\n\u001b[?2004l\r\u001b[?2004h"]
[108.377603, "o", "> "]
[108.377717, "o", "    rel_path=\"$(basename \"$file_path\")\"\r\n\u001b[?2004l\r"]
[108.377738, "o", "\u001b[?2004h> "]
[108.377759, "o", "    \r\n\u001b[?2004l\r\u001b[?2004h"]
[108.377779, "o", "> "]
[108.377849, "o", "    # Calculate SHA-256 hash\r\n\u001b[?2004l\r"]
[108.377867, "o", "\u001b[?2004h> "]
[108.378016, "o", "    file_hash=\"$(sha256sum \"$file_path\" | cut -d' ' -f1)\"\r\n\u001b[?2004l\r"]
[108.378042, "o", "\u001b[?2004h> "]
[108.378069, "o", "    \r\n\u001b[?2004l\r"]
[108.37809, "o", "\u001b[?2004h> "]
[108.378181, "o", "    # Get first 4 bytes as lowercase hex\r\n\u001b[?2004l\r"]
[108.3782, "o", "\u001b[?2004h> "]
[108.378441, "o", "    magic_hex=\"$(od -An -tx1 -j0 -N4 \"$file_path\" | tr -d ' \\n' | awk '{print tolower($0)}')\"\r\n\u001b[?2004l\r"]
[108.378461, "o", "\u001b[?2004h> "]
[108.378482, "o", "    \r\n\u001b[?2004l\r"]
[108.378501, "o", "\u001b[?2004h> "]
[108.378573, "o", "    # Get file size in bytes\r\n\u001b[?2004l\r"]
[108.378593, "o", "\u001b[?2004h> "]
[108.378716, "o", "    size_bytes=\"$(stat -c%s \"$file_path\")\"\r\n\u001b[?2004l\r"]
[108.378736, "o", "\u001b[?2004h> "]
[108.378757, "o", "    \r\n\u001b[?2004l\r"]
[108.378777, "o", "\u001b[?2004h> "]
[108.378903, "o", "    # Get modification timestamp (ISO-8601 format)\r\n\u001b[?2004l\r"]
[108.378922, "o", "\u001b[?2004h> "]
[108.379167, "o", "    mtime_utc=\"$(date -u -d \"$(stat -c%y \"$file_path\" | cut -d'.' -f1)\" +'%Y-%m-%dT%H:%M:%SZ')\"\r\n\u001b[?2004l\r"]
[108.379194, "o", "\u001b[?2004h> "]
[108.379215, "o", "    \r\n\u001b[?2004l\r"]
[108.379236, "o", "\u001b[?2004h> "]
[108.379321, "o", "    # Insert into tracked_files\r\n\u001b[?2004l\r"]
[108.379341, "o", "\u001b[?2004h> "]
[108.379781, "o", "    sqlite3 \"$DB\" \"INSERT INTO tracked_files (rel_path, file_hash, magic_hex, size_bytes) VALUES('$rel_path', '$file_hash', '$magic_hex', $size_bytes);\" >> \"$SQL_LOG\" 2>&1\r\n\u001b[?2004l\r"]
[108.379802, "o", "\u001b[?2004h> "]
[108.379823, "o", "    \r\n\u001b[?2004l\r"]
[108.379844, "o", "\u001b[?2004h> "]
[108.379899, "o", "    # Get the file_id\r\n\u001b[?2004l\r"]
[108.379918, "o", "\u001b[?2004h> "]
[108.380185, "o", "    file_id=\"$(sqlite3 \"$DB\" \"SELECT id FROM tracked_files WHERE rel_path = '$rel_path';\" | grep -v id)\"\r\n\u001b[?2004l\r"]
[108.380206, "o", "\u001b[?2004h"]
[108.380227, "o", ">     \r\n\u001b[?2004l\r"]
[108.380249, "o", "\u001b[?2004h> "]
[108.38031, "o", "    # Insert INIT event\r\n\u001b[?2004l\r"]
[108.38033, "o", "\u001b[?2004h> "]
[108.380695, "o", "    sqlite3 \"$DB\" \"INSERT INTO audit_events (file_id, event_type, event_ts) VALUES($file_id, 'INIT', '$mtime_utc');\" >> \"$SQL_LOG\" 2>&1\r\n\u001b[?2004l\r"]
[108.380716, "o", "\u001b[?2004h> "]
[108.38074, "o", "    \r\n\u001b[?2004l\r"]
[108.380758, "o", "\u001b[?2004h> "]
[108.380777, "o", "done\r\n\u001b[?2004l\r"]
[108.380795, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[108.380814, "o", "\u001b[?2004h> "]
[108.380944, "o", "echo \"-- Initial load completed\" >> \"$SQL_LOG\"\r\n\u001b[?2004l\r"]
[108.380965, "o", "\u001b[?2004h> "]
[108.380984, "o", "EOF\r\n\u001b[?2004l\r"]
[108.382134, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[108.382155, "o", "\r\n\u001b[?2004l\r"]
[108.382174, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[108.38225, "o", "chmod +x load_initial.sh\r\n\u001b[?2004l\r"]
[108.383189, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[108.505978, "i", "chmod +x load_initial.sh\n"]
[108.506165, "o", "chmod +x load_initial.sh\r\n\u001b[?2004l\r"]
[108.507386, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[122.471979, "i", "./load_initial.sh\n"]
[122.472092, "o", "./load_initial.sh\r\n\u001b[?2004l\r"]
[122.553061, "o", "\u001b[?2004h"]
[122.553192, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[123.42927, "i", "sqlite3 db/audit.db \"SELECT rel_path, file_hash, magic_hex, size_bytes FROM tracked_files;\" >> logs/sql_history.log 2>&1\n"]
[123.429737, "o", "sqlite3 db/audit.db \"SELECT rel_path, file_hash, magic_hex, size_bytes FROM tracked_files;\" >> logs/sql_history.log 2>&1\r\n\u001b[?2004l\r"]
[123.431756, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[123.607842, "i", "sqlite3 db/audit.db \"SELECT file_id, event_type, event_ts FROM audit_events;\" >> logs/sql_history.log 2>&1\n"]
[123.608248, "o", "sqlite3 db/audit.db \"SELECT file_id, event_type, event_ts FROM audit_events;\" >> logs/sql_history.log 2>&1\r\n\u001b[?2004l\r"]
[123.61034, "o", "\u001b[?2004h"]
[123.610386, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[137.60653, "i", "sed -i '1s/^/# URGENT SECURITY PATCH\\\n/' configs/ssh.cfg\n"]
[137.60668, "o", "sed -i '1s/^/# URGENT SECURITY PATCH\\\r\n"]
[137.606734, "o", "\u001b[?2004l\r"]
[137.606759, "o", "\u001b[?2004h> "]
[137.606803, "o", "/' configs/ssh.cfg\r\n\u001b[?2004l\r"]
[137.608241, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[137.913213, "i", "cat configs/ssh.cfg\n"]
[137.91331, "o", "cat configs/ssh.cfg\r\n"]
[137.913337, "o", "\u001b[?2004l\r"]
[137.914228, "o", "# URGENT SECURITY PATCH\r\n\r\n# SSH Config File - Original\r\n\r\nHost localhost\r\n\r\n  User root\r\n\r\n  Port 22\r\n\r\n  IdentityFile ~/.ssh/id_rsa\r\n\r\n"]
[137.914408, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[161.191452, "i", "cat > update_sshcfg.sh << 'EOF'\n#!/bin/bash\n\nDB=\"db/audit.db\"\nSQL_LOG=\"logs/sql_history.log\"\nFILE_PATH=\"configs/ssh.cfg\"\n\nrel_path=\"$(basename \"$FILE_PATH\")\"\n\n# Calculate new SHA-256 hash\nnew_file_hash=\"$(sha256sum \"$FILE_PATH\" | cut -d' ' -f1)\"\n\n# Get new first 4 bytes as lowercase hex\nnew_magic_hex=\"$(od -An -tx1 -j0 -N4 \"$FILE_PATH\" | tr -d ' \\n' | awk '{print tolower($0)}')\"\n\n# Get new file size in bytes\nnew_size_bytes=\"$(stat -c%s \"$FILE_PATH\")\"\n\n# Get new modification timestamp (ISO-8601 format)\nnew_mtime_utc=\"$(date -u -d \"$(stat -c%y \"$FILE_PATH\" | cut -d'.' -f1)\" +'%Y-%m-%dT%H:%M:%SZ')\"\n\n# Get the file_id for ssh.cfg\nfile_id=\"$(sqlite3 \"$DB\" \"SELECT id FROM tracked_files WHERE rel_path = '$rel_path';\" | grep -v id)\"\n\n# Update tracked_files record\nsqlite3 \"$DB\" \"UPDATE tracked_files SET file_hash='$new_file_hash', magic_hex='$new_magic_hex', size_bytes=$new_size_bytes WHERE id=$file_id;\" >> \"$SQL_LOG\" 2>&1\n\n# Insert MODIFY event\nsqlite3 \"$DB\" \"INSERT INTO audit_events (file_id, event_type, event_ts) V"]
[161.191637, "i", "ALUES($file_id, 'MODIFY', '$new_mtime_utc');\" >> \"$SQL_LOG\" 2>&1\n\necho \"-- ssh.cfg updated and event logged\" >> \"$SQL_LOG\"\nEOF\n\nchmod +x update_sshcfg.sh\n"]
[161.191684, "o", "cat > update_sshcfg.sh << 'EOF'\r\n\u001b[?2004l\rALUES($file_id, 'MODIFY', '$new_mtime_utc');\""]
[161.191744, "o", " >> \"$SQL_LOG\" 2>&1\r\n\r\necho \"-- ssh.cfg updated and event logged\" >> \"$SQL_LOG\"\r\nEOF\r\n\r\nchmod +x update_sshcfg.sh\r\n\u001b[?2004h"]
[161.191784, "o", "> "]
[161.191822, "o", "#!/bin/bash\r\n\u001b[?2004l\r"]
[161.19186, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r\u001b[?2004h"]
[161.191955, "o", "> DB=\"db/audit.db\"\r\n\u001b[?2004l\r\u001b[?2004h> "]
[161.192059, "o", "SQL_LOG=\"logs/sql_history.log\"\r\n\u001b[?2004l\r"]
[161.192097, "o", "\u001b[?2004h> "]
[161.192174, "o", "FILE_PATH=\"configs/ssh.cfg\"\r\n\u001b[?2004l\r"]
[161.192211, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r\u001b[?2004h> "]
[161.192328, "o", "rel_path=\"$(basename \"$FILE_PATH\")\"\r\n\u001b[?2004l\r"]
[161.192366, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r\u001b[?2004h"]
[161.192406, "o", "> "]
[161.192482, "o", "# Calculate new SHA-256 hash\r\n\u001b[?2004l\r"]
[161.192519, "o", "\u001b[?2004h> "]
[161.192697, "o", "new_file_hash=\"$(sha256sum \"$FILE_PATH\" | cut -d' ' -f1)\"\r\n\u001b[?2004l\r"]
[161.192737, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[161.192775, "o", "\u001b[?2004h> "]
[161.192889, "o", "# Get new first 4 bytes as lowercase hex\r\n\u001b[?2004l\r"]
[161.192925, "o", "\u001b[?2004h> "]
[161.193211, "o", "new_magic_hex=\"$(od -An -tx1 -j0 -N4 \"$FILE_PATH\" | tr -d ' \\n' | awk '{print tolower($0)}')\"\r\n\u001b[?2004l\r"]
[161.193234, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[161.193369, "o", "\u001b[?2004h> # Get new file size in bytes\r\n\u001b[?2004l\r\u001b[?2004h"]
[161.193421, "o", "> "]
[161.193525, "o", "new_size_bytes=\"$(stat -c%s \"$FILE_PATH\")\"\r\n\u001b[?2004l\r"]
[161.19357, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r\u001b[?2004h"]
[161.193617, "o", "> "]
[161.19376, "o", "# Get new modification timestamp (ISO-8601 format)\r\n\u001b[?2004l\r"]
[161.193799, "o", "\u001b[?2004h> "]
[161.194093, "o", "new_mtime_utc=\"$(date -u -d \"$(stat -c%y \"$FILE_PATH\" | cut -d'.' -f1)\" +'%Y-%m-%dT%H:%M:%SZ')\"\r\n\u001b[?2004l\r"]
[161.19413, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[161.194177, "o", "\u001b[?2004h> "]
[161.194255, "o", "# Get the file_id for ssh.cfg\r\n\u001b[?2004l\r"]
[161.194291, "o", "\u001b[?2004h> "]
[161.194604, "o", "file_id=\"$(sqlite3 \"$DB\" \"SELECT id FROM tracked_files WHERE rel_path = '$rel_path';\" | grep -v id)\"\r\n\u001b[?2004l\r"]
[161.194663, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r\u001b[?2004h"]
[161.194716, "o", "> "]
[161.194801, "o", "# Update tracked_files record\r\n\u001b[?2004l\r"]
[161.194836, "o", "\u001b[?2004h> "]
[161.195344, "o", "sqlite3 \"$DB\" \"UPDATE tracked_files SET file_hash='$new_file_hash', magic_hex='$new_magic_hex', size_bytes=$new_size_bytes WHERE id=$file_id;\" >> \"$SQL_LOG\" 2>&1\r\n\u001b[?2004l\r"]
[161.195381, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[161.195428, "o", "\u001b[?2004h> "]
[161.195476, "o", "# Insert MODIFY event\r\n\u001b[?2004l\r"]
[161.195493, "o", "\u001b[?2004h> "]
[161.195958, "o", "sqlite3 \"$DB\" \"INSERT INTO audit_events (file_id, event_type, event_ts) VALUES($file_id, 'MODIFY', '$new_mtime_utc');\" >> \"$SQL_LOG\" 2>&1\r\n\u001b[?2004l\r"]
[161.195997, "o", "\u001b[?2004h"]
[161.196014, "o", "> \r\n\u001b[?2004l\r\u001b[?2004h> "]
[161.196207, "o", "echo \"-- ssh.cfg updated and event logged\" >> \"$SQL_LOG\"\r\n\u001b[?2004l\r"]
[161.196254, "o", "\u001b[?2004h> "]
[161.196303, "o", "EOF\r\n\u001b[?2004l\r"]
[161.198361, "o", "\u001b[?2004h"]
[161.198406, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# \r\n\u001b[?2004l\r"]
[161.198454, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[161.198501, "o", "chmod +x update_sshcfg.sh\r\n\u001b[?2004l\r"]
[161.19983, "o", "\u001b[?2004h"]
[161.199904, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[161.377292, "i", "chmod +x update_sshcfg.sh\n"]
[161.377428, "o", "chmod +x update_sshcfg.sh\r\n\u001b[?2004l\r"]
[161.378415, "o", "\u001b[?2004h"]
[161.378431, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[172.28088, "i", "./update_sshcfg.sh\n"]
[172.281099, "o", "./update_sshcfg.sh\r\n\u001b[?2004l\r"]
[172.306094, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[173.235506, "i", "sleep 1\n"]
[173.23561, "o", "sleep 1\r\n\u001b[?2004l\r"]
[174.237579, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[191.296952, "i", "chmod 400 configs/nginx.conf\n"]
[191.297251, "o", "chmod 400 configs/nginx.conf\r\n\u001b[?2004l\r"]
[191.298535, "o", "\u001b[?2004h"]
[191.29858, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[191.373677, "i", "cat > log_nginx_perm.sh << 'EOF'\n#!/bin/bash\n\nDB=\"db/audit.db\"\nSQL_LOG=\"logs/sql_history.log\"\nFILE_PATH=\"configs/nginx.conf\"\n\necho \"-- Changing permissions for $FILE_PATH to 400\" >> \"$SQL_LOG\"\n\nrel_path=\"$(basename \"$FILE_PATH\")\"\nfile_id=\"$(sqlite3 \"$DB\" \"SELECT id FROM tracked_files WHERE rel_path = '$rel_path';\" | grep -v id)\"\n\nevent_ts=\"$(date -u +'%Y-%m-%dT%H:%M:%SZ')\"\n\nsqlite3 \"$DB\" \"INSERT INTO audit_events (file_id, event_type, event_ts) VALUES($file_id, 'PERM', '$event_ts');\" >> \"$SQL_LOG\" 2>&1\n\necho \"-- PERM event logged for $rel_path\" >> \"$SQL_LOG\"\nEOF\n\nchmod +x log_nginx_perm.sh\n"]
[191.373813, "o", "cat > log_nginx_perm.sh << 'EOF'\r\n\u001b[?2004l\r"]
[191.373851, "o", "\u001b[?2004h"]
[191.373883, "o", "> "]
[191.373915, "o", "#!/bin/bash\r\n\u001b[?2004l\r\u001b[?2004h"]
[191.373949, "o", "> \r\n\u001b[?2004l\r\u001b[?2004h> "]
[191.373999, "o", "DB=\"db/audit.db\"\r\n\u001b[?2004l\r"]
[191.374032, "o", "\u001b[?2004h> "]
[191.374107, "o", "SQL_LOG=\"logs/sql_history.log\"\r\n\u001b[?2004l\r"]
[191.374132, "o", "\u001b[?2004h> "]
[191.374214, "o", "FILE_PATH=\"configs/nginx.conf\"\r\n\u001b[?2004l\r"]
[191.374245, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r\u001b[?2004h"]
[191.374279, "o", "> "]
[191.374428, "o", "echo \"-- Changing permissions for $FILE_PATH to 400\" >> \"$SQL_LOG\"\r\n\u001b[?2004l\r"]
[191.374456, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[191.374488, "o", "\u001b[?2004h> "]
[191.374571, "o", "rel_path=\"$(basename \"$FILE_PATH\")\"\r\n\u001b[?2004l\r"]
[191.374621, "o", "\u001b[?2004h> "]
[191.374888, "o", "file_id=\"$(sqlite3 \"$DB\" \"SELECT id FROM tracked_files WHERE rel_path = '$rel_path';\" | grep -v id)\"\r\n\u001b[?2004l\r\u001b[?2004h"]
[191.374922, "o", "> \r\n\u001b[?2004l\r\u001b[?2004h"]
[191.374944, "o", "> "]
[191.37505, "o", "event_ts=\"$(date -u +'%Y-%m-%dT%H:%M:%SZ')\"\r\n\u001b[?2004l\r"]
[191.375071, "o", "\u001b[?2004h"]
[191.37509, "o", "> \r\n\u001b[?2004l\r"]
[191.375103, "o", "\u001b[?2004h"]
[191.375143, "o", "> "]
[191.375484, "o", "sqlite3 \"$DB\" \"INSERT INTO audit_events (file_id, event_type, event_ts) VALUES($file_id, 'PERM', '$event_ts');\" >> \"$SQL_LOG\" 2>&1\r\n\u001b[?2004l\r"]
[191.375526, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[191.37555, "o", "\u001b[?2004h> "]
[191.375727, "o", "echo \"-- PERM event logged for $rel_path\" >> \"$SQL_LOG\"\r\n\u001b[?2004l\r\u001b[?2004h> "]
[191.375756, "o", "EOF\r\n\u001b[?2004l\r"]
[191.376867, "o", "\u001b[?2004h"]
[191.37691, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# \r\n\u001b[?2004l\r\u001b[?2004h"]
[191.376934, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[191.377005, "o", "chmod +x log_nginx_perm.sh\r\n\u001b[?2004l\r"]
[191.378207, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[191.476, "i", "chmod +x log_nginx_perm.sh\n"]
[191.476281, "o", "chmod +x log_nginx_perm.sh\r\n\u001b[?2004l\r"]
[191.477786, "o", "\u001b[?2004h"]
[191.477869, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[203.188194, "i", "./log_nginx_perm.sh\n"]
[203.188374, "o", "./log_nginx_perm.sh\r\n\u001b[?2004l\r"]
[203.199529, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[221.931036, "i", "cat > generate_report.sh << 'EOF'\n#!/bin/bash\n\nDB=\"db/audit.db\"\nREPORT_FILE=\"reports/audit_summary.csv\"\nVERSION_FILE=\"/home/user/version.txt\"\nSQL_LOG=\"logs/sql_history.log\"\n\n# Get version string\nversion=\"$(cat \"$VERSION_FILE\")\"\n\n# Create report header\nheader=\"PATH;EVENT;HASH;VERSION=$version\"\n\n# Query data and format into CSV\nquery=\"SELECT tf.rel_path, ae.event_type, tf.file_hash \n       FROM audit_events ae \n       JOIN tracked_files tf ON ae.file_id = tf.id \n       ORDER BY ae.event_type, tf.rel_path;\"\n\nsqlite3 -separator ';' \"$DB\" \"$query\" | \nawk 'BEGIN {print \"$header\"} NR>1 && $0 !~ /^$/ {print}' > \"$REPORT_FILE\"\n\n# Log the report generation\necho \"-- Generated audit report: $REPORT_FILE\" >> \"$SQL_LOG\"\nEOF\n\nchmod +x generate_report.sh\n"]
[221.931416, "o", "cat > generate_report.sh << 'EOF'\r\n\u001b[?2004l\r"]
[221.931515, "o", "\u001b[?2004h"]
[221.931563, "o", "> "]
[221.931632, "o", "#!/bin/bash\r\n\u001b[?2004l\r"]
[221.931715, "o", "\u001b[?2004h> "]
[221.931762, "o", "\r\n\u001b[?2004l\r"]
[221.931809, "o", "\u001b[?2004h> "]
[221.931939, "o", "DB=\"db/audit.db\"\r\n\u001b[?2004l\r"]
[221.931975, "o", "\u001b[?2004h"]
[221.932008, "o", "> "]
[221.932306, "o", "REPORT_FILE=\"reports/audit_summary.csv\"\r\n\u001b[?2004l\r"]
[221.93235, "o", "\u001b[?2004h"]
[221.932384, "o", "> "]
[221.932699, "o", "VERSION_FILE=\"/home/user/version.txt\"\r\n\u001b[?2004l\r"]
[221.932748, "o", "\u001b[?2004h> "]
[221.932995, "o", "SQL_LOG=\"logs/sql_history.log\"\r\n\u001b[?2004l\r"]
[221.933033, "o", "\u001b[?2004h"]
[221.933088, "o", "> \r\n\u001b[?2004l\r"]
[221.933136, "o", "\u001b[?2004h> "]
[221.933291, "o", "# Get version string\r\n\u001b[?2004l\r"]
[221.933333, "o", "\u001b[?2004h"]
[221.933373, "o", "> "]
[221.933607, "o", "version=\"$(cat \"$VERSION_FILE\")\"\r\n\u001b[?2004l\r"]
[221.93366, "o", "\u001b[?2004h"]
[221.933712, "o", "> \r\n\u001b[?2004l\r"]
[221.933754, "o", "\u001b[?2004h"]
[221.933794, "o", "> "]
[221.933939, "o", "# Create report header\r\n\u001b[?2004l\r"]
[221.933985, "o", "\u001b[?2004h"]
[221.934024, "o", "> "]
[221.934327, "o", "header=\"PATH;EVENT;HASH;VERSION=$version\"\r\n\u001b[?2004l\r"]
[221.934374, "o", "\u001b[?2004h"]
[221.934413, "o", "> \r\n\u001b[?2004l\r"]
[221.934465, "o", "\u001b[?2004h> "]
[221.934729, "o", "# Query data and format into CSV\r\n\u001b[?2004l\r"]
[221.93477, "o", "\u001b[?2004h"]
[221.934812, "o", "> "]
[221.93522, "o", "query=\"SELECT tf.rel_path, ae.event_type, tf.file_hash \r\n\u001b[?2004l\r"]
[221.935264, "o", "\u001b[?2004h"]
[221.935303, "o", "> "]
[221.93551, "o", "       FROM audit_events ae \r\n\u001b[?2004l\r"]
[221.935557, "o", "\u001b[?2004h"]
[221.935596, "o", "> "]
[221.935985, "o", "       JOIN tracked_files tf ON ae.file_id = tf.id \r\n\u001b[?2004l\r"]
[221.936035, "o", "\u001b[?2004h"]
[221.936074, "o", "> "]
[221.936398, "o", "       ORDER BY ae.event_type, tf.rel_path;\"\r\n\u001b[?2004l\r"]
[221.936443, "o", "\u001b[?2004h"]
[221.936482, "o", "> \r\n\u001b[?2004l\r"]
[221.936521, "o", "\u001b[?2004h> "]
[221.936861, "o", "sqlite3 -separator ';' \"$DB\" \"$query\" | \r\n\u001b[?2004l\r"]
[221.936903, "o", "\u001b[?2004h"]
[221.936943, "o", "> "]
[221.937499, "o", "awk 'BEGIN {print \"$header\"} NR>1 && $0 !~ /^$/ {print}' > \"$REPORT_FILE\"\r\n\u001b[?2004l\r"]
[221.937546, "o", "\u001b[?2004h"]
[221.937589, "o", "> \r\n\u001b[?2004l\r"]
[221.937637, "o", "\u001b[?2004h> "]
[221.937877, "o", "# Log the report generation\r\n\u001b[?2004l\r"]
[221.937933, "o", "\u001b[?2004h"]
[221.937974, "o", "> "]
[221.938442, "o", "echo \"-- Generated audit report: $REPORT_FILE\" >> \"$SQL_LOG\"\r\n\u001b[?2004l\r"]
[221.938489, "o", "\u001b[?2004h"]
[221.938536, "o", "> "]
[221.938588, "o", "EOF\r\n\u001b[?2004l\r"]
[221.940196, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[221.940289, "o", "\r\n\u001b[?2004l\r\u001b[?2004h"]
[221.940358, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[221.940552, "o", "chmod +x generate_report.sh\r\n\u001b[?2004l\r"]
[221.942031, "o", "\u001b[?2004h"]
[221.942108, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[222.038258, "i", "chmod +x generate_report.sh\n"]
[222.038519, "o", "chmod +x generate_report.sh\r\n\u001b[?2004l\r"]
[222.039869, "o", "\u001b[?2004h"]
[222.039915, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[236.484232, "i", "./generate_report.sh\n"]
[236.484386, "o", "./generate_report.sh\r\n\u001b[?2004l\r"]
[236.490195, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[237.477968, "i", "cat > final_integrity_check.sh << 'EOF'\n#!/bin/bash\n\nDB_FILE=\"db/audit.db\"\nSQL_LOG=\"logs/sql_history.log\"\n\n# Calculate SHA-256 checksum of the database file\ndb_checksum=\"$(sha256sum \"$DB_FILE\" | cut -d' ' -f1)\"\n\n# Append the checksum comment to the SQL log\necho \"-- DB_CHECKSUM: $db_checksum\" >> \"$SQL_LOG\"\n\necho \"Integrity check completed and logged to $SQL_LOG\"\nEOF\n\nchmod +x final_integrity_check.sh\n"]
[237.478374, "o", "cat > final_integrity_check.sh << 'EOF'\r\n\u001b[?2004l\r"]
[237.478482, "o", "\u001b[?2004h> "]
[237.478606, "o", "#!/bin/bash\r\n\u001b[?2004l\r"]
[237.478686, "o", "\u001b[?2004h"]
[237.478758, "o", "> \r\n\u001b[?2004l\r\u001b[?2004h"]
[237.478827, "o", "> "]
[237.478966, "o", "DB_FILE=\"db/audit.db\"\r\n\u001b[?2004l\r"]
[237.479025, "o", "\u001b[?2004h> "]
[237.47928, "o", "SQL_LOG=\"logs/sql_history.log\"\r\n\u001b[?2004l\r"]
[237.479339, "o", "\u001b[?2004h> "]
[237.4794, "o", "\r\n\u001b[?2004l\r\u001b[?2004h> "]
[237.479797, "o", "# Calculate SHA-256 checksum of the database file\r\n\u001b[?2004l\r"]
[237.47986, "o", "\u001b[?2004h> "]
[237.480255, "o", "db_checksum=\"$(sha256sum \"$DB_FILE\" | cut -d' ' -f1)\"\r\n\u001b[?2004l\r"]
[237.480323, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[237.480386, "o", "\u001b[?2004h> "]
[237.480731, "o", "# Append the checksum comment to the SQL log\r\n\u001b[?2004l\r"]
[237.480791, "o", "\u001b[?2004h> "]
[237.481163, "o", "echo \"-- DB_CHECKSUM: $db_checksum\" >> \"$SQL_LOG\"\r\n\u001b[?2004l\r"]
[237.481217, "o", "\u001b[?2004h"]
[237.481282, "o", "> \r\n\u001b[?2004l\r\u001b[?2004h"]
[237.481344, "o", "> "]
[237.481821, "o", "echo \"Integrity check completed and logged to $SQL_LOG\"\r\n\u001b[?2004l\r"]
[237.481926, "o", "\u001b[?2004h"]
[237.481999, "o", "> EOF\r\n\u001b[?2004l\r"]
[237.483419, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[237.483569, "o", "\r\n\u001b[?2004l\r"]
[237.48364, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[237.483709, "o", "chmod +x final_integrity_check.sh\r\n\u001b[?2004l\r"]
[237.48512, "o", "\u001b[?2004h"]
[237.48522, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[237.576487, "i", "chmod +x final_integrity_check.sh\n"]
[237.576626, "o", "chmod +x final_integrity_check.sh\r\n\u001b[?2004l\r"]
[237.577525, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[250.487474, "i", "./final_integrity_check.sh\n"]
[250.48759, "o", "./final_integrity_check.sh\r\n\u001b[?2004l\r"]
[250.491132, "o", "Integrity check completed and logged to logs/sql_history.log\r\n"]
[250.491333, "o", "\u001b[?2004h"]
[250.491358, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[251.461981, "i", "echo \"Verification:\" >> logs/sql_history.log\n"]
[251.462142, "o", "echo \"Verification:\" >> logs/sql_history.log\r\n\u001b[?2004l\r"]
[251.462253, "o", "\u001b[?2004hroot@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[251.619445, "i", "tail -3 logs/sql_history.log\n"]
[251.619575, "o", "tail -3 logs/sql_history.log\r\n\u001b[?2004l\r"]
[251.620531, "o", "-- Generated audit report: reports/audit_summary.csv\r\n-- DB_CHECKSUM: 68a6d7ad1a94309e45f3f55b0ca03f038202e98948bf90a7bdc969dec363dc4b\r\nVerification:\r\n"]
[251.620708, "o", "\u001b[?2004h"]
[251.620753, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
[251.864492, "i", "head -1 reports/audit_summary.csv\n"]
[251.864625, "o", "head -1 reports/audit_summary.csv\r\n\u001b[?2004l\r"]
[251.865705, "o", "$header\r\n"]
[251.865869, "o", "\u001b[?2004h"]
[251.865892, "o", "root@e535d4ff-2e66-427a-ade1-d8e01430a6f3:/home/user/cmtracker# "]
