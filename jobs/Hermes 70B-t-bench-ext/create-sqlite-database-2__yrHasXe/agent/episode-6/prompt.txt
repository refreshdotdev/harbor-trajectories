Previous response had warnings:
WARNINGS: - Extra text detected before JSON object
- Extra text detected after JSON object
- Command 1 should end with newline when followed by another command. Otherwise the two commands will be concatenated together on the same line.

New Terminal Output:

> cat > update_db.py << 'EOF'
> #!/usr/bin/env python3
> import sqlite3
> import os
> import hashlib
> import datetime
>
> def get_file_magic_hex(filepath):
>     """Get first 4 bytes of file as lowercase hex string."""
>     try:
>         with open(filepath, 'rb') as f:
>             magic_bytes = f.read(4)
>         return magic_bytes.hex().lower()
>     except Exception as e:
>         return ''
>
> def get_file_sha256(filepath):
>     """Get SHA-256 hash of file content."""
>     try:
>         hash_sha256 = hashlib.sha256()
>         with open(filepath, 'rb') as f:
>             for chunk in iter(lambda: f.read(4096), b''):
>                 hash_sha256.update(chunk)
>         return hash_sha256.hexdigest()
>     except Exception as e:
>         return ''
>
> def main():
>     db_path = 'db/audit.db'
>     configs_dir = 'configs'
>
>     conn = sqlite3.connect(db_path)
>     cursor = conn.cursor()
>
>     # Update ssh.cfg record and add MODIFY event
>     ssh_cfg_path = os.path.join(configs_dir, 'ssh.cfg')
>     if os.path.exists(ssh_cfg_path):
>         try:
>             new_file_hash = get_file_sha256(ssh_cfg_path)
>             new_magic_hex = get_file_magic_hex(ssh_cfg_path)
>             new_size_bytes = os.path.getsize(ssh_cfg_path)
>             mtime_ts = datetime.datetime.fromtimestamp(os.path.getmtime(ssh_cfg_path)).strftime('%Y-%m-%d %H:%M:%S')
>
>             # Get current file ID
>             cursor.execute('SELECT id FROM tracked_files WHERE rel_path = ?', ('ssh.cfg',))
>             file_id = cursor.fetchone()[0]
>
>             # Update tracked_files record
>             cursor.execute('''
>                 UPDATE tracked_files
>                 SET file_hash = ?, magic_hex = ?, size_bytes = ?
>                 WHERE id = ?
>             ''', (new_file_hash, new_magic_hex, new_size_bytes, file_id))
>
>             # Add MODIFY event
>             cursor.execute('''
>                 INSERT INTO audit_events (file_id, event_type, event_ts)
>                 VALUES (?, 'MODIFY', ?)
>             ''', (file_id, mtime_ts))
>
>             print("Updated ssh.cfg in database")
>         except Exception as e:
>             print(f"Error updating ssh.cfg: {e}")
>
>     # Add PERM event for nginx.conf
>     nginx_cfg_path = os.path.join(configs_dir, 'nginx.conf')
>     if os.path.exists(nginx_cfg_path):
>         try:
>             cursor.execute('SELECT id FROM tracked_files WHERE rel_path = ?', ('nginx.conf',))
>             file_id = cursor.fetchone()[0]
>             current_time = datetime.datetime.utcnow().strftime('%Y-%m-%d %H:%M:%S')
>
>             cursor.execute('''
>                 INSERT INTO audit_events (file_id, event_type, event_ts)
>                 VALUES (?, 'PERM', ?)
>             ''', (file_id, current_time))
>
>             print("Added PERM event for nginx.conf")
>         except Exception as e:
>             print(f"Error adding PERM event: {e}")
>
>     conn.commit()
>     conn.close()
>     print("Database update complete")
>
> if __name__ == '__main__':
>     main()
> EOFchmod +x update_db.py
> python3 update_db.py
> cat > version.txt << 'EOF'
> v1.2.3-RELEASE
> EOF
