[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user# asciinema rec --stdin /logs/agent/recording.cast
[?2004l[0;32masciinema: recording asciicast to /logs/agent/recording.cast[0m
[0;32masciinema: press <ctrl-d> or type "exit" when you're done[0m
[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user# clear
[?2004l[H[J[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user# mkdir -p /home/user/hardening_workshop
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user# chmod 0700 /home/user/hardening_workshop
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user# ls -ld /home/user/hardening_workshop
[?2004ldrwx------ 2 root root 10 Feb 13 18:56 [0m[01;34m/home/user/hardening_workshop[0m
[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user# cd /home/user/hardening_workshop
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# cp /home/user/baseline_configs/ssh/sshd_config_baseline ./
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# cp /home/user/baseline_configs/sysctl/sysctl_baseline.conf ./
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# chmod 0600 sshd_config_baseline sysctl_baseline.conf
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# sha256sum sshd_config_baseline > /tmp/__hash_ssh_config_baseline
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# sha256sum sysctl_baseline.conf > /tmp/__hash_sysctl_baseline
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# cat /tmp/__hash_ssh_config_baseline | cut -d' ' -f1 | xargs -I{} echo "$(date -u +'%Y-%m-%d %H:%M:%S') | ACTION=COPY | SRC=/home/user/baseline_configs/ssh/sshd_config_baseline | DST=$(pwd)/sshd_config_baseline | HASH={} | STATUS=OK" >> /home/user/hardening_summary.log
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# cat /tmp/__hash_sysctl_baseline | cut -d' ' -f1 | xargs -I{} echo "$(date -u +'%Y-%m-%d %H:%M:%S') | ACTION=COPY | SRC=/home/user/baseline_configs/sysctl/sysctl_baseline.conf | DST=$(pwd)/sysctl_baseline.conf | HASH={} | STATUS=OK" >> /home/user/hardening_summary.log
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# DATE_UTC=$(date -u +'%Y%m%d')
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# WEEK_UTC=$(date -u +'%V')
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# TARBALL_NAME="baseline_backup_${DATE_UTC}_${WEEK_UTC}.tar.gz"
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# echo "Creating tarball: ${TARBALL_NAME}..."
[?2004lCreating tarball: baseline_backup_20260213_07.tar.gz...
[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# tar -czvf "${TARBALL_NAME}" sshd_config_baseline sysctl_baseline.conf
[?2004lsshd_config_baseline
sysctl_baseline.conf
[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# chmod 0600 "${TARBALL_NAME}"
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# sha256sum "${TARBALL_NAME}" > /tmp/__hash_tarball
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# cat /tmp/__hash_tarball | cut -d' ' -f1 | xargs -I{} echo "$(date -u +'%Y-%m-%d %H:%M:%S') | ACTION=ARCHIVE | SRC=- | DST=$(pwd)/${TARBALL_NAME} | HASH={} | STATUS=OK" >> /home/user/hardening_summary.log
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# grep -vE '^(#.*|\s*$)' /home/user/security_policies/ssh_policy.txt > /tmp/__filtered_ssh_policy.txt
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# cp sshd_config_baseline sshd_config_hardened
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# cat /tmp/__filtered_ssh_policy.txt >> sshd_config_hardened
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# chmod 0600 sshd_config_hardened
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# sha256sum sshd_config_hardened > /tmp/__hash_ssh_hardened
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# cat /tmp/__hash_ssh_hardened | cut -d' ' -f1 | xargs -I{} echo "$(date -u +'%Y-%m-%d %H:%M:%S') | ACTION=HARDEN | SRC=/home/user/security_policies/ssh_policy.txt | DST=$(pwd)/sshd_config_hardened | HASH={} | STATUS=OK" >> /home/user/hardening_summary.log
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# grep -vE '^(#.*|\s*$)' /home/user/security_policies/sysctl_policy.txt > /tmp/__filtered_sysctl_policy.txt
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# cp sysctl_baseline.conf sysctl_hardened.conf
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# cat /tmp/__filtered_sysctl_policy.txt >> sysctl_hardened.conf
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# chmod 0600 sysctl_hardened.conf
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# sha256sum sysctl_hardened.conf > /tmp/__hash_sysctl_hardened
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# cat /tmp/__hash_sysctl_hardened | cut -d' ' -f1 | xargs -I{} echo "$(date -u +'%Y-%m-%d %H:%M:%S') | ACTION=HARDEN | SRC=/home/user/security_policies/sysctl_policy.txt | DST=$(pwd)/sysctl_hardened.conf | HASH={} | STATUS=OK" >> /home/user/hardening_summary.log
[?2004l[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# ls -la /home/user/hardening_workshop
[?2004ltotal 4
drwx------ 2 root root 184 Feb 13 18:58 [0m[01;34m.[0m
drwxrwxrwx 1 root root  73 Feb 13 18:57 [34;42m..[0m
-rw------- 1 root root 151 Feb 13 18:57 [01;31mbaseline_backup_20260213_07.tar.gz[0m
-rw------- 1 root root   0 Feb 13 18:57 sshd_config_baseline
-rw------- 1 root root   0 Feb 13 18:58 sshd_config_hardened
-rw------- 1 root root   0 Feb 13 18:57 sysctl_baseline.conf
-rw------- 1 root root   0 Feb 13 18:58 sysctl_hardened.conf
[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# cat /home/user/hardening_summary.log
[?2004l2026-02-13 18:57:16 | ACTION=COPY | SRC=/home/user/baseline_configs/ssh/sshd_config_baseline | DST=/home/user/hardening_workshop/sshd_config_baseline | HASH=e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 | STATUS=OK
2026-02-13 18:57:17 | ACTION=COPY | SRC=/home/user/baseline_configs/sysctl/sysctl_baseline.conf | DST=/home/user/hardening_workshop/sysctl_baseline.conf | HASH=e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 | STATUS=OK
2026-02-13 18:57:37 | ACTION=ARCHIVE | SRC=- | DST=/home/user/hardening_workshop/baseline_backup_20260213_07.tar.gz | HASH=cc6a1a9fd02a44ae2b1ed6d6c9560f770a07732549edad24cf448dbc4357272e | STATUS=OK
2026-02-13 18:58:01 | ACTION=HARDEN | SRC=/home/user/security_policies/ssh_policy.txt | DST=/home/user/hardening_workshop/sshd_config_hardened | HASH=e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 | STATUS=OK
2026-02-13 18:58:02 | ACTION=HARDEN | SRC=/home/user/security_policies/sysctl_policy.txt | DST=/home/user/hardening_workshop/sysctl_hardened.conf | HASH=e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 | STATUS=OK
[?2004hroot@3cd85bbd-e44d-4fbe-a1fd-d7e39b7a20ea:/home/user/hardening_workshop# 