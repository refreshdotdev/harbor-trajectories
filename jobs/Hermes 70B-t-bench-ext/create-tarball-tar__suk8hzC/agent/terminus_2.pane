[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# asciinema rec --stdin /logs/agent/recording.cast
[?2004l[0;32masciinema: recording asciicast to /logs/agent/recording.cast[0m
[0;32masciinema: press <ctrl-d> or type "exit" when you're done[0m
[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# clear
[?2004l[H[J[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# BACKUP_DEST="${BACKUP_DEST:-/home/user/archives}"
[?2004l[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# LOG_FILE="${LOG_FILE:-/home/user/backup_logs/backup.log}"
[?2004l[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# mkdir -p "$BACKUP_DEST" /home/user/backup_logs
[?2004l[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# TIMESTAMP=$(date +%Y%m%d)
[?2004l[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# ARCHIVE_FILE="$BACKUP_DEST/daily_${TIMESTAMP}.tar.gz"
[?2004l[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# CHECKSUM_FILE="$BACKUP_DEST/daily_${TIMESTAMP}.sha256"
[?2004l[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# if [ -f "$ARCHIVE_FILE" ]; then TIMESTAMP_BAK=$(date +%s) && mv "$ARCHIVE_FILE" "$ARCHIVE_FILE.bak-$TIMESTAMP_BAK"; fi
[?2004l[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# if [ -f "$CHECKSUM_FILE" ]; then TIMESTAMP_BAK=$(date +%s) && mv "$CHECKSUM_FILE" "$CHECKSUM_FILE.bak-$TIMESTAMP_BAK"; fi
[?2004l[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# tar --exclude='*.tmp' --exclude-broken -czf "$ARCHIVE_FILE" --owner=0 --group=0 --mode='go-rwx' -C /home/user/data .
[?2004ltar: unrecognized option '--exclude-broken'
Try 'tar --help' or 'tar --usage' for more information.
[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# find /home/user/data -type l ! -exec test -e {} \; -delete
[?2004l[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# tar --exclude='*.tmp' -czf "$ARCHIVE_FILE" --owner=0 --group=0 --mode='go-rwx' -C /home/user/data .
[?2004l[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# sha256sum "$ARCHIVE_FILE" > "$CHECKSUM_FILE"
[?2004l[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# sed -i "s|$ARCHIVE_FILE|SHA256 ($ARCHIVE_FILE) =|" "$CHECKSUM_FILE"
[?2004l[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# if [ ! -f "$LOG_FILE" ]; then echo 'TIMESTAMP | ARCHIVE | STATUS' > "$LOG_FILE"; fi
[?2004lbash: /home/user/audit/backup_audit.log: No such file or directory
[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# LOG_TIMESTAMP=$(date +%Y-%m-%d\ %H:%M:%S) && echo "$LOG_TIMESTAMP - $ARCHIVE_FILE - OK" >> "$LOG_FILE"
[?2004lbash: /home/user/audit/backup_audit.log: No such file or directory
[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# LOG_FILE="/home/user/backup_logs/backup.log"
[?2004l[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# mkdir -p /home/user/backup_logs
[?2004l[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# if [ ! -f "$LOG_FILE" ]; then echo 'TIMESTAMP | ARCHIVE | STATUS' > "$LOG_FILE"; fi
[?2004l[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# LOG_TIMESTAMP=$(date +%Y-%m-%d\ %H:%M:%S) && echo "$LOG_TIMESTAMP - $ARCHIVE_FILE - OK" >> "$LOG_FILE"
[?2004l[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# echo "=== Archive File ===" && ls -la "$ARCHIVE_FILE"
[?2004l=== Archive File ===
-rw-r--r-- 1 root root 321 Feb 13 19:02 [0m[01;31m/home/user/secure_backups/daily_20260213.tar.gz[0m
[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# echo "=== Checksum File ===" && cat "$CHECKSUM_FILE"
[?2004l=== Checksum File ===
48a81f7e2f4a3c400d9938c8993f98e4700fd94d64a9619d40105998694d3250  SHA256 (/home/user/secure_backups/daily_20260213.tar.gz) =
[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# echo "=== Log File ===" && cat "$LOG_FILE"
[?2004l=== Log File ===
TIMESTAMP | ARCHIVE | STATUS
2026-02-13 19:03:21 - /home/user/secure_backups/daily_20260213.tar.gz - OK
[?2004hroot@249c4f6b-18f8-499e-b385-94261daf5f93:~# 