{"version": 2, "width": 160, "height": 40, "timestamp": 1771009677, "env": {"SHELL": "/bin/bash", "TERM": "screen"}}
[0.008656, "o", "\u001b[?2004hroot@963d2f4c-1621-4fe5-9229-0b01f412381d:~# "]
[0.948251, "i", "clear\r"]
[0.948455, "o", "clear\r\n\u001b[?2004l\r"]
[0.949636, "o", "\u001b[H\u001b[J"]
[0.949809, "o", "\u001b[?2004hroot@963d2f4c-1621-4fe5-9229-0b01f412381d:~# "]
[29.805682, "i", "mkdir -p /home/user/reports\n"]
[29.805905, "o", "mkdir -p /home/user/reports\r\n\u001b[?2004l\r"]
[29.807935, "o", "\u001b[?2004hroot@963d2f4c-1621-4fe5-9229-0b01f412381d:~# "]
[30.004007, "i", "mkdir -p /home/user/sample_data\n"]
[30.004298, "o", "mkdir -p /home/user/sample_data\r\n\u001b[?2004l\r"]
[30.005701, "o", "\u001b[?2004h"]
[30.005748, "o", "root@963d2f4c-1621-4fe5-9229-0b01f412381d:~# "]
[30.184692, "i", "mkdir -p /home/user/config\n"]
[30.184859, "o", "mkdir -p /home/user/config\r\n\u001b[?2004l\r"]
[30.186041, "o", "\u001b[?2004hroot@963d2f4c-1621-4fe5-9229-0b01f412381d:~# "]
[30.386581, "i", "cat > /home/user/reports/run_security_scan.sh << 'EOF'\n#!/bin/bash\n\n# Enterprise Security Baseline Automation (SOP-992) - SEC-4022\n# Automate daily infrastructure snapshot report generation\n\n# Define input file paths\nNETSTAT_FILE=\"/home/user/sample_data/mock_netstat.txt\"\nPASSWD_FILE=\"/home/user/sample_data/mock_passwd\"\nSERVICE_NAMES_FILE=\"/home/user/sample_data/service_names.csv\"\nUSER_BLACKLIST_FILE=\"/home/user/config/user_blacklist.txt\"\nREPORT_DIR=\"/home/user/reports\"\n\n# Set default UID limit\nUID_LIMIT=1000\n\n# Initialize variables\nSTART_EPOCH=0\nEND_EPOCH=0\nINPUT_HASH=\"\"\n\n# Array to store job PIDs\ndeclare -a JOB_PIDS\n\n# Function to calculate MD5 hash of concatenated input files\nfunction calculate_input_hash() {\n    cat \"$NETSTAT_FILE\" \"$PASSWD_FILE\" | md5sum | awk '{print $1}'\n}\n\n# Function to process network exposure data (Job 1)\nfunction process_network_data() {\n    # Process mock_netstat.txt - implementation will go here\n    echo \"Network analysis job completed\"\n}\n\n# Function to process user audit data (Jo"]
[30.386718, "i", "b 2)\nfunction process_user_audit() {\n    # Process mock_passwd - implementation will go here  \n    echo \"User audit job completed\"\n}\n\n# Function to generate final reports\nfunction generate_reports() {\n    # Create reports - implementation will go here\n    echo \"Reports generated successfully\"\n}\n\n# Main execution block\n{\n    echo \"Starting security scan...\"\n    \n    # Capture start epoch\n    START_EPOCH=$(date +%s)\n    \n    # TODO: Launch parallel jobs\n    # TODO: Wait for completion\n    \n    # Placeholder for end epoch capture\n    END_EPOCH=$((START_EPOCH + 5))\n    \n    # Placeholder for report generation\n    generate_reports\n    \n    echo \"Security scan completed\"\n    echo \"Start epoch: $START_EPOCH, End epoch: $END_EPOCH\"\n} &> \"$REPORT_DIR/scan_exec_time.log\"\nEOF\n"]
[30.387045, "o", "cat > /home/user/reports/run_security_scan.sh << 'EOF'\r\n\u001b[?2004l\r"]
[30.387128, "o", "\u001b[?2004h"]
[30.387172, "o", "> "]
[30.387268, "o", "#!/bin/bash\r\n\u001b[?2004l\r"]
[30.387326, "o", "\u001b[?2004h> \r\n"]
[30.387372, "o", "\u001b[?2004l\r\u001b[?2004h"]
[30.387416, "o", "> "]
[30.387829, "o", "# Enterprise Security Baseline Automation (SOP-992) - SEC-4022\r\n\u001b[?2004l\r"]
[30.387873, "o", "\u001b[?2004h"]
[30.38791, "o", "> "]
[30.388299, "o", "# Automate daily infrastructure snapshot report generation\r\n\u001b[?2004l\r"]
[30.388336, "o", "\u001b[?2004h"]
[30.388374, "o", "> \r\n\u001b[?2004l\r"]
[30.388412, "o", "\u001b[?2004h"]
[30.388447, "o", "> "]
[30.388615, "o", "# Define input file paths\r\n\u001b[?2004l\r"]
[30.388671, "o", "\u001b[?2004h> "]
[30.389073, "o", "NETSTAT_FILE=\"/home/user/sample_data/mock_netstat.txt\"\r\n\u001b[?2004l\r"]
[30.389117, "o", "\u001b[?2004h> "]
[30.389445, "o", "PASSWD_FILE=\"/home/user/sample_data/mock_passwd\"\r\n\u001b[?2004l\r"]
[30.389484, "o", "\u001b[?2004h"]
[30.389518, "o", "> "]
[30.389929, "o", "SERVICE_NAMES_FILE=\"/home/user/sample_data/service_names.csv\"\r\n\u001b[?2004l\r"]
[30.389968, "o", "\u001b[?2004h> "]
[30.390363, "o", "USER_BLACKLIST_FILE=\"/home/user/config/user_blacklist.txt\"\r\n\u001b[?2004l\r"]
[30.390413, "o", "\u001b[?2004h> "]
[30.39064, "o", "REPORT_DIR=\"/home/user/reports\"\r\n\u001b[?2004l\r"]
[30.39069, "o", "\u001b[?2004h"]
[30.390725, "o", "> \r\n\u001b[?2004l\r"]
[30.390761, "o", "\u001b[?2004h"]
[30.390788, "o", "> "]
[30.390964, "o", "# Set default UID limit\r\n\u001b[?2004l\r"]
[30.390998, "o", "\u001b[?2004h"]
[30.391032, "o", "> "]
[30.391146, "o", "UID_LIMIT=1000\r\n\u001b[?2004l\r"]
[30.39118, "o", "\u001b[?2004h"]
[30.391212, "o", "> \r\n\u001b[?2004l\r"]
[30.391267, "o", "\u001b[?2004h"]
[30.391301, "o", "> "]
[30.391446, "o", "# Initialize variables\r\n\u001b[?2004l\r"]
[30.391494, "o", "\u001b[?2004h"]
[30.391524, "o", "> "]
[30.391626, "o", "START_EPOCH=0\r\n\u001b[?2004l\r"]
[30.391663, "o", "\u001b[?2004h"]
[30.39169, "o", "> "]
[30.391789, "o", "END_EPOCH=0\r\n\u001b[?2004l\r"]
[30.391836, "o", "\u001b[?2004h"]
[30.391868, "o", "> "]
[30.391987, "o", "INPUT_HASH=\"\"\r\n\u001b[?2004l\r"]
[30.392038, "o", "\u001b[?2004h> "]
[30.392088, "o", "\r\n\u001b[?2004l\r\u001b[?2004h"]
[30.392132, "o", "> "]
[30.392308, "o", "# Array to store job PIDs\r\n\u001b[?2004l\r"]
[30.392353, "o", "\u001b[?2004h> "]
[30.392514, "o", "declare -a JOB_PIDS\r\n\u001b[?2004l\r"]
[30.392553, "o", "\u001b[?2004h"]
[30.392605, "o", "> \r\n\u001b[?2004l\r"]
[30.392648, "o", "\u001b[?2004h> "]
[30.393079, "o", "# Function to calculate MD5 hash of concatenated input files\r\n\u001b[?2004l\r"]
[30.393102, "o", "\u001b[?2004h"]
[30.393129, "o", "> "]
[30.39338, "o", "function calculate_input_hash() {\r\n\u001b[?2004l\r"]
[30.39343, "o", "\u001b[?2004h> "]
[30.393898, "o", "    cat \"$NETSTAT_FILE\" \"$PASSWD_FILE\" | md5sum | awk '{print $1}'\r\n\u001b[?2004l\r"]
[30.393965, "o", "\u001b[?2004h> }\r\n\u001b[?2004l\r"]
[30.394012, "o", "\u001b[?2004h"]
[30.39406, "o", "> \r\n\u001b[?2004l\r"]
[30.394105, "o", "\u001b[?2004h> "]
[30.394455, "o", "# Function to process network exposure data (Job 1)\r\n\u001b[?2004l\r"]
[30.394521, "o", "\u001b[?2004h"]
[30.394548, "o", "> "]
[30.394776, "o", "function process_network_data() {\r\n\u001b[?2004l\r"]
[30.394809, "o", "\u001b[?2004h"]
[30.394858, "o", "> "]
[30.395248, "o", "    # Process mock_netstat.txt - implementation will go here\r\n\u001b[?2004l\r"]
[30.395282, "o", "\u001b[?2004h"]
[30.395306, "o", "> "]
[30.395598, "o", "    echo \"Network analysis job completed\"\r\n\u001b[?2004l\r"]
[30.395631, "o", "\u001b[?2004h"]
[30.395655, "o", "> "]
[30.395674, "o", "}\r\n\u001b[?2004l\r"]
[30.395727, "o", "\u001b[?2004h"]
[30.395874, "o", "> \r\n\u001b[?2004l\r\u001b[?2004h> "]
[30.396133, "o", "# Function to process user audit data (Job 2)\r\n\u001b[?2004l\r"]
[30.396168, "o", "\u001b[?2004h"]
[30.396196, "o", "> "]
[30.396413, "o", "function process_user_audit() {\r\n\u001b[?2004l\r"]
[30.396464, "o", "\u001b[?2004h"]
[30.396488, "o", "> "]
[30.39689, "o", "    # Process mock_passwd - implementation will go here  \r\n\u001b[?2004l\r"]
[30.396924, "o", "\u001b[?2004h> "]
[30.397181, "o", "    echo \"User audit job completed\"\r\n\u001b[?2004l\r"]
[30.397214, "o", "\u001b[?2004h"]
[30.397249, "o", "> }\r\n"]
[30.397281, "o", "\u001b[?2004l\r"]
[30.397314, "o", "\u001b[?2004h"]
[30.397352, "o", "> \r\n\u001b[?2004l\r"]
[30.397375, "o", "\u001b[?2004h"]
[30.397401, "o", "> "]
[30.397655, "o", "# Function to generate final reports\r\n\u001b[?2004l\r"]
[30.397688, "o", "\u001b[?2004h"]
[30.397712, "o", "> "]
[30.397942, "o", "function generate_reports() {\r\n\u001b[?2004l\r"]
[30.397976, "o", "\u001b[?2004h"]
[30.398019, "o", "> "]
[30.398335, "o", "    # Create reports - implementation will go here\r\n\u001b[?2004l\r"]
[30.398369, "o", "\u001b[?2004h"]
[30.398403, "o", "> "]
[30.398693, "o", "    echo \"Reports generated successfully\"\r\n\u001b[?2004l\r"]
[30.398734, "o", "\u001b[?2004h"]
[30.398778, "o", "> }\r\n"]
[30.398834, "o", "\u001b[?2004l\r\u001b[?2004h"]
[30.398878, "o", "> \r\n\u001b[?2004l\r"]
[30.398925, "o", "\u001b[?2004h"]
[30.398958, "o", "> "]
[30.399107, "o", "# Main execution block\r\n\u001b[?2004l\r"]
[30.399141, "o", "\u001b[?2004h"]
[30.399175, "o", "> "]
[30.399203, "o", "{\r\n\u001b[?2004l\r"]
[30.399228, "o", "\u001b[?2004h"]
[30.399251, "o", "> "]
[30.39951, "o", "    echo \"Starting security scan...\"\r\n\u001b[?2004l\r"]
[30.399544, "o", "\u001b[?2004h"]
[30.399568, "o", "> "]
[30.399618, "o", "    \r\n\u001b[?2004l\r"]
[30.399662, "o", "\u001b[?2004h"]
[30.399685, "o", "> "]
[30.399905, "o", "    # Capture start epoch\r\n\u001b[?2004l\r"]
[30.399953, "o", "\u001b[?2004h"]
[30.399984, "o", "> "]
[30.400186, "o", "    START_EPOCH=$(date +%s)\r\n\u001b[?2004l\r"]
[30.400233, "o", "\u001b[?2004h> "]
[30.400285, "o", "    \r\n\u001b[?2004l\r"]
[30.40032, "o", "\u001b[?2004h"]
[30.400353, "o", "> "]
[30.400576, "o", "    # TODO: Launch parallel jobs\r\n\u001b[?2004l\r"]
[30.400609, "o", "\u001b[?2004h"]
[30.400643, "o", "> "]
[30.400883, "o", "    # TODO: Wait for completion\r\n\u001b[?2004l\r"]
[30.400923, "o", "\u001b[?2004h"]
[30.400958, "o", "> "]
[30.400991, "o", "    \r\n\u001b[?2004l\r"]
[30.401036, "o", "\u001b[?2004h"]
[30.401069, "o", "> "]
[30.401329, "o", "    # Placeholder for end epoch capture\r\n\u001b[?2004l\r"]
[30.401362, "o", "\u001b[?2004h"]
[30.401395, "o", "> "]
[30.401627, "o", "    END_EPOCH=$((START_EPOCH + 5))\r\n\u001b[?2004l\r"]
[30.401666, "o", "\u001b[?2004h"]
[30.401699, "o", "> "]
[30.401732, "o", "    \r\n\u001b[?2004l\r"]
[30.401789, "o", "\u001b[?2004h"]
[30.401832, "o", "> "]
[30.40209, "o", "    # Placeholder for report generation\r\n\u001b[?2004l\r"]
[30.402124, "o", "\u001b[?2004h"]
[30.402164, "o", "> "]
[30.402306, "o", "    generate_reports\r\n\u001b[?2004l\r"]
[30.402339, "o", "\u001b[?2004h"]
[30.402378, "o", "> "]
[30.402411, "o", "    \r\n\u001b[?2004l\r"]
[30.402457, "o", "\u001b[?2004h"]
[30.40249, "o", "> "]
[30.402727, "o", "    echo \"Security scan completed\"\r\n\u001b[?2004l\r"]
[30.402761, "o", "\u001b[?2004h"]
[30.402794, "o", "> "]
[30.403206, "o", "    echo \"Start epoch: $START_EPOCH, End epoch: $END_EPOCH\"\r\n\u001b[?2004l\r"]
[30.403247, "o", "\u001b[?2004h"]
[30.403285, "o", "> "]
[30.40354, "o", "} &> \"$REPORT_DIR/scan_exec_time.log\"\r\n\u001b[?2004l\r"]
[30.403574, "o", "\u001b[?2004h"]
[30.403607, "o", "> "]
[30.40364, "o", "EOF\r\n\u001b[?2004l\r"]
[30.406847, "o", "\u001b[?2004h"]
[30.406902, "o", "root@963d2f4c-1621-4fe5-9229-0b01f412381d:~# "]
[31.002044, "i", "chmod +x /home/user/reports/run_security_scan.sh\n"]
[31.002565, "o", "chmod +x /home/user/reports/run_security_scan.sh\r\n\u001b[?2004l\r"]
[31.003984, "o", "\u001b[?2004hroot@963d2f4c-1621-4fe5-9229-0b01f412381d:~# "]
[31.208567, "i", "ls -la /home/user/\n"]
[31.208855, "o", "ls -la /home/user/\r\n\u001b[?2004l\r"]
[31.212018, "o", "total 0\r\n"]
[31.212094, "o", "drwxr-xr-x 1 root root 29 Feb 12 23:58 \u001b[0m\u001b[01;34m.\u001b[0m\r\ndrwxr-xr-x 1 root root 26 Feb 12 23:58 \u001b[01;34m..\u001b[0m\r\ndrwxr-xr-x 1 root root 40 Feb 12 23:58 \u001b[01;34mconfig\u001b[0m\r\ndrwxrwxrwx 1 root root 42 Feb 13 19:08 \u001b[34;42mreports\u001b[0m\r\ndrwxr-xr-x 1 root root 90 Feb 12 23:58 \u001b[01;34msample_data\u001b[0m\r\n"]
[31.212606, "o", "\u001b[?2004hroot@963d2f4c-1621-4fe5-9229-0b01f412381d:~# "]
[79.352132, "i", "cat > /home/user/sample_data/mock_netstat.txt << 'EOF'\nActive Internet connections (w/o servers)\ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -\ntcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -\ntcp        0      0 192.168.1.100:9000      0.0.0.0:*               LISTEN      -\nudp        0      0 0.0.0.0:68              0.0.0.0:*                           -\ntcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      -\ntcp        0      0 0.0.0.0:443             0.0.0.0:*               LISTEN      -\nEOF"]
[79.352459, "o", "cat > /home/user/sample_data/mock_netstat.txt << 'EOF'\r\n\u001b[?2004l\r"]
[79.35253, "o", "\u001b[?2004h> "]
[79.352702, "o", "Active Internet connections (w/o servers)\r\n\u001b[?2004l\r"]
[79.352746, "o", "\u001b[?2004h> "]
[79.353093, "o", "tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -\r\n\u001b[?2004l\r"]
[79.353133, "o", "\u001b[?2004h> "]
[79.353463, "o", "tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -\r\n\u001b[?2004l\r"]
[79.35352, "o", "\u001b[?2004h> "]
[79.353839, "o", "tcp        0      0 192.168.1.100:9000      0.0.0.0:*               LISTEN      -\r\n\u001b[?2004l\r"]
[79.353886, "o", "\u001b[?2004h> "]
[79.35422, "o", "udp        0      0 0.0.0.0:68              0.0.0.0:*                           -\r\n\u001b[?2004l\r"]
[79.35426, "o", "\u001b[?2004h> "]
[79.354598, "o", "tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      -\r\n\u001b[?2004l\r"]
[79.354639, "o", "\u001b[?2004h> "]
[79.355, "o", "tcp        0      0 0.0.0.0:443             0.0.0.0:*               LISTEN      -\r\n\u001b[?2004l\r"]
[79.355041, "o", "\u001b[?2004h> EOF"]
[79.546183, "i", "cat > /home/user/sample_data/mock_passwd << 'EOF'\nroot:x:0:0:root:/root:/bin/bash\nbin:x:1:1:bin:/bin:/bin/false\ndaemon:x:2:2:daemon:/sbin:/bin/false\nadm:x:3:4:adm:/var/adm:/bin/false\nlp:x:4:7:lp:/var/spool/lpd:/bin/false\nsync:x:5:0:sync:/sbin:/bin/sync\nshutdown:x:6:0:shutdown:/sbin:/bin/shutdown\nhalt:x:7:0:halt:/sbin:/bin/halt\nmail:x:8:12:mail:/var/spool/mail:/bin/false\noperator:x:11:0:operator:/root:/bin/bash\ngames:x:12:100:games:/usr/games:/bin/false\nguest:x:13:100:guest:/tmp:/bin/false\nnobody:x:99:99:Nobody:/:/bin/false\nuser1:x:1000:1000:User One,,,:/home/user1:/bin/bash\ndefault:x:1001:1001:Default User,,,:/home/default:/bin/bash\nEOF"]
[79.546775, "o", "cat > /home/user/sample_data/mock_passwd << 'EOF'\r\n\u001b[?2004l\r"]
[79.54691, "o", "\u001b[?2004h> "]
[79.547203, "o", "root:x:0:0:root:/root:/bin/bash\r\n\u001b[?2004l\r"]
[79.547283, "o", "\u001b[?2004h> "]
[79.547514, "o", "bin:x:1:1:bin:/bin:/bin/false\r\n\u001b[?2004l\r"]
[79.547577, "o", "\u001b[?2004h"]
[79.547621, "o", "> "]
[79.547913, "o", "daemon:x:2:2:daemon:/sbin:/bin/false\r\n\u001b[?2004l\r"]
[79.547964, "o", "\u001b[?2004h"]
[79.548007, "o", "> "]
[79.548234, "o", "adm:x:3:4:adm:/var/adm:/bin/false\r\n\u001b[?2004l\r"]
[79.548283, "o", "\u001b[?2004h"]
[79.548336, "o", "> "]
[79.548583, "o", "lp:x:4:7:lp:/var/spool/lpd:/bin/false\r\n\u001b[?2004l\r"]
[79.548625, "o", "\u001b[?2004h"]
[79.548673, "o", "> "]
[79.548891, "o", "sync:x:5:0:sync:/sbin:/bin/sync\r\n\u001b[?2004l\r"]
[79.548931, "o", "\u001b[?2004h"]
[79.548985, "o", "> "]
[79.549279, "o", "shutdown:x:6:0:shutdown:/sbin:/bin/shutdown\r\n\u001b[?2004l\r"]
[79.54932, "o", "\u001b[?2004h"]
[79.549366, "o", "> "]
[79.549573, "o", "halt:x:7:0:halt:/sbin:/bin/halt\r\n\u001b[?2004l\r"]
[79.549613, "o", "\u001b[?2004h"]
[79.549661, "o", "> "]
[79.54998, "o", "mail:x:8:12:mail:/var/spool/mail:/bin/false\r\n\u001b[?2004l\r"]
[79.550033, "o", "\u001b[?2004h"]
[79.550084, "o", "> "]
[79.550347, "o", "operator:x:11:0:operator:/root:/bin/bash\r\n\u001b[?2004l\r"]
[79.550384, "o", "\u001b[?2004h"]
[79.550429, "o", "> "]
[79.55073, "o", "games:x:12:100:games:/usr/games:/bin/false\r\n\u001b[?2004l\r"]
[79.550771, "o", "\u001b[?2004h"]
[79.550826, "o", "> "]
[79.551078, "o", "guest:x:13:100:guest:/tmp:/bin/false\r\n\u001b[?2004l\r"]
[79.551115, "o", "\u001b[?2004h"]
[79.551168, "o", "> "]
[79.551396, "o", "nobody:x:99:99:Nobody:/:/bin/false\r\n\u001b[?2004l\r"]
[79.551442, "o", "\u001b[?2004h"]
[79.551485, "o", "> "]
[79.551863, "o", "user1:x:1000:1000:User One,,,:/home/user1:/bin/bash\r\n\u001b[?2004l\r"]
[79.551907, "o", "\u001b[?2004h"]
[79.551955, "o", "> "]
[79.552376, "o", "default:x:1001:1001:Default User,,,:/home/default:/bin/bash\r\n\u001b[?2004l\r"]
[79.552413, "o", "\u001b[?2004h"]
[79.552461, "o", "> EOF"]
[79.729089, "i", "cat > /home/user/sample_data/service_names.csv << 'EOF'\n22/tcp,ssh\n25/tcp,smtp\n53/tcp,dns\n80/tcp,http\n443/tcp,https\n3306/tcp,mysql\n9000/tcp,BjörnApp\n68/udp,dhcpclient\nEOF"]
[79.72943, "o", "cat > /home/user/sample_data/service_names.csv << 'EOF'\r\n\u001b[?2004l\r"]
[79.72946, "o", "\u001b[?2004h> "]
[79.729585, "o", "22/tcp,ssh\r\n\u001b[?2004l\r\u001b[?2004h> "]
[79.729656, "o", "25/tcp,smtp\r\n\u001b[?2004l\r\u001b[?2004h> "]
[79.729713, "o", "53/tcp,dns\r\n\u001b[?2004l\r"]
[79.729759, "o", "\u001b[?2004h> "]
[79.729826, "o", "80/tcp,http\r\n\u001b[?2004l\r"]
[79.729874, "o", "\u001b[?2004h"]
[79.729892, "o", "> "]
[79.729964, "o", "443/tcp,https\r\n\u001b[?2004l\r"]
[79.730011, "o", "\u001b[?2004h> "]
[79.730081, "o", "3306/tcp,mysql\r\n\u001b[?2004l\r"]
[79.730137, "o", "\u001b[?2004h> "]
[79.730218, "o", "9000/tcp,BjörnApp\r\n\u001b[?2004l\r"]
[79.73027, "o", "\u001b[?2004h> "]
[79.730352, "o", "68/udp,dhcpclient\r\n\u001b[?2004l\r"]
[79.730402, "o", "\u001b[?2004h> "]
[79.73045, "o", "EOF"]
[79.877086, "i", "cat > /home/user/config/user_blacklist.txt << 'EOF'\nroot\nbin\ndaemon\nadm\nlp\nsync\nshutdown\nhalt\nmail\noperator\ngames\nguest\nnobody\nEOF"]
[79.877316, "o", "cat > /home/user/config/user_blacklist.txt << 'EOF'\r\n\u001b[?2004l\r\u001b[?2004h> "]
[79.877379, "o", "root\r\n\u001b[?2004l\r\u001b[?2004h> bin\r\n\u001b[?2004l\r"]
[79.877437, "o", "\u001b[?2004h> daemon\r\n\u001b[?2004l\r\u001b[?2004h> "]
[79.877481, "o", "adm\r\n\u001b[?2004l\r\u001b[?2004h> lp\r\n\u001b[?2004l\r"]
[79.877525, "o", "\u001b[?2004h> sync\r\n\u001b[?2004l\r"]
[79.877563, "o", "\u001b[?2004h> shutdown\r\n\u001b[?2004l\r"]
[79.877599, "o", "\u001b[?2004h> "]
[79.877636, "o", "halt\r\n\u001b[?2004l\r\u001b[?2004h> mail\r\n\u001b[?2004l\r"]
[79.877699, "o", "\u001b[?2004h> operator\r\n\u001b[?2004l\r\u001b[?2004h> "]
[79.877736, "o", "games\r\n\u001b[?2004l\r"]
[79.877775, "o", "\u001b[?2004h> guest\r\n\u001b[?2004l\r"]
[79.877832, "o", "\u001b[?2004h> nobody\r\n\u001b[?2004l\r"]
[79.877872, "o", "\u001b[?2004h> EOF"]
[80.179754, "i", "cat >> /home/user/reports/run_security_scan.sh << 'EOF'\n\n# Function to process network exposure data (Job 1)\nfunction process_network_data() {\n    local output_file=\"$REPORT_DIR/network_analysis.tmp\"\n    \n    # Filter for LISTEN state or UDP protocol\n    awk 'BEGIN {FS=\"[[:space:]]+\"; OFS=\" \"}\n         /LISTEN/ || /udp/ {\n             # Extract port/protocol and process name\n             if ($4 ~ /([^:]+):([0-9]+)/) {\n                 port = substr($4, RSTART(1), RLENGTH(1))\n                 proto_port = $4\n             } else {\n                 port = \"unknown\"\n                 proto_port = $4\n             }\n             \n             # Get service name from CSV\n             service_name=\"\"\n             while ((getline csv_line < \"${SERVICE_NAMES_FILE}\") > 0) {\n                 if (csv_line ~ /^\"?\"?[[:alnum:]]+[[:space:]]+\"?\"?${proto_port}\\/?\"?\"?$/) {\n                     split(csv_line, parts, /,/) \n                     service_name = parts[2]\n                     break\n                 }\n             }\n   "]
[80.179971, "i", "          close(\"${SERVICE_NAMES_FILE}\")\n             \n             # Determine scope classification\n             if ($4 ~ /^0.0.0.0/) {\n                 prefix=\"public-\"\n             } else if ($4 ~ /^127.0.0.1/) {\n                 prefix=\"local-\"\n             } else {\n                 prefix=\"\"\n             }\n             \n             # Format output\n             printf \"%s %s %s (%s %s)\\n\", port, prefix proto_port, $NF, $(NF-1), service_name\n         }\n    ' \"$NETSTAT_FILE\" | sort -k1n > \"$output_file\"\n    \n    echo \"Network analysis completed\"\n}\n\n# Function to process user audit data (Job 2)\nfunction process_user_audit() {\n    local output_file=\"$REPORT_DIR/user_audit.tmp\"\n    \n    # Process passwd file with exclusions\n    awk -F: -v limit=\"$UID_LIMIT\" -v blacklist_file=\"$USER_BLACKLIST_FILE\" '\n        BEGIN { \n            while ((getline bl < blacklist_file) > 0) {\n                blacklist[bl] = 1\n            }\n            close(blacklist_file)\n        }\n        $3 < limit && $7 != \"/bin/false\" && !( $"]
[80.180047, "i", "1 in blacklist ) {\n            print $1\n        }\n    ' \"$PASSWD_FILE\" | sort > \"$output_file\"\n    \n    echo \"User audit completed\"\n}\nEOF"]
[80.180338, "o", "cat >> /home/user/reports/run_security_scan.sh << 'EOF'\r\n\u001b[?2004l\r"]
[80.180422, "o", "\u001b[?2004h> "]
[80.180483, "o", "\r\n\u001b[?2004l\r\u001b[?2004h"]
[80.18054, "o", "> "]
[80.180901, "o", "# Function to process network exposure data (Job 1)\r\n\u001b[?2004l\r"]
[80.180962, "o", "\u001b[?2004h> "]
[80.181205, "o", "function process_network_data() {\r\n\u001b[?2004l\r"]
[80.181268, "o", "\u001b[?2004h> "]
[80.181685, "o", "    local output_file=\"$REPORT_DIR/network_analysis.tmp\"\r\n\u001b[?2004l\r"]
[80.181746, "o", "\u001b[?2004h> "]
[80.181799, "o", "    \r\n\u001b[?2004l\r"]
[80.181861, "o", "\u001b[?2004h> "]
[80.182225, "o", "    # Filter for LISTEN state or UDP protocol\r\n\u001b[?2004l\r"]
[80.18227, "o", "\u001b[?2004h"]
[80.182321, "o", "> "]
[80.182622, "o", "    awk 'BEGIN {FS=\"[[:space:]]+\"; OFS=\" \"}\r\n\u001b[?2004l\r"]
[80.182674, "o", "\u001b[?2004h"]
[80.182726, "o", "> "]
[80.182921, "o", "         /LISTEN/ || /udp/ {\r\n\u001b[?2004l\r"]
[80.182983, "o", "\u001b[?2004h"]
[80.183036, "o", "> "]
[80.183411, "o", "             # Extract port/protocol and process name\r\n\u001b[?2004l\r"]
[80.183472, "o", "\u001b[?2004h"]
[80.183525, "o", "> "]
[80.183794, "o", "             if ($4 ~ /([^:]+):([0-9]+)/) {\r\n\u001b[?2004l\r"]
[80.183856, "o", "\u001b[?2004h> "]
[80.184296, "o", "                 port = substr($4, RSTART(1), RLENGTH(1))\r\n\u001b[?2004l\r"]
[80.184342, "o", "\u001b[?2004h"]
[80.184382, "o", "> "]
[80.184615, "o", "                 proto_port = $4\r\n\u001b[?2004l\r"]
[80.184663, "o", "\u001b[?2004h"]
[80.184704, "o", "> "]
[80.184875, "o", "             } else {\r\n\u001b[?2004l\r"]
[80.184925, "o", "\u001b[?2004h"]
[80.184964, "o", "> "]
[80.185207, "o", "                 port = \"unknown\"\r\n\u001b[?2004l\r"]
[80.185247, "o", "\u001b[?2004h"]
[80.185292, "o", "> "]
[80.185527, "o", "                 proto_port = $4\r\n\u001b[?2004l\r"]
[80.185582, "o", "\u001b[?2004h> "]
[80.185706, "o", "             }\r\n\u001b[?2004l\r"]
[80.185775, "o", "\u001b[?2004h> "]
[80.185898, "o", "             \r\n\u001b[?2004l\r"]
[80.185962, "o", "\u001b[?2004h> "]
[80.186281, "o", "             # Get service name from CSV\r\n\u001b[?2004l\r"]
[80.186334, "o", "\u001b[?2004h"]
[80.186384, "o", "> "]
[80.186577, "o", "             service_name=\"\"\r\n\u001b[?2004l\r"]
[80.186627, "o", "\u001b[?2004h"]
[80.186677, "o", "> "]
[80.187187, "o", "             while ((getline csv_line < \"${SERVICE_NAMES_FILE}\") > 0) {\r\n\u001b[?2004l\r"]
[80.187251, "o", "\u001b[?2004h> "]
[80.187941, "o", "                 if (csv_line ~ /^\"?\"?[[:alnum:]]+[[:space:]]+\"?\"?${proto_port}\\/?\"?\"?$/) {\r\n\u001b[?2004l\r"]
[80.187992, "o", "\u001b[?2004h"]
[80.188042, "o", "> "]
[80.188386, "o", "                     split(csv_line, parts, /,/) \r\n\u001b[?2004l\r"]
[80.188438, "o", "\u001b[?2004h"]
[80.188486, "o", "> "]
[80.188796, "o", "                     service_name = parts[2]\r\n\u001b[?2004l\r"]
[80.188875, "o", "\u001b[?2004h> "]
[80.189073, "o", "                     break\r\n\u001b[?2004l\r"]
[80.189124, "o", "\u001b[?2004h"]
[80.189173, "o", "> "]
[80.189296, "o", "                 }\r\n\u001b[?2004l\r"]
[80.189345, "o", "\u001b[?2004h"]
[80.189394, "o", "> "]
[80.18949, "o", "             }\r\n\u001b[?2004l\r"]
[80.189543, "o", "\u001b[?2004h"]
[80.189596, "o", "> "]
[80.189906, "o", "             close(\"${SERVICE_NAMES_FILE}\")\r\n\u001b[?2004l\r"]
[80.189968, "o", "\u001b[?2004h> "]
[80.1901, "o", "             \r\n\u001b[?2004l\r"]
[80.190157, "o", "\u001b[?2004h"]
[80.190211, "o", "> "]
[80.190524, "o", "             # Determine scope classification\r\n\u001b[?2004l\r"]
[80.190582, "o", "\u001b[?2004h> "]
[80.190895, "o", "             if ($4 ~ /^0.0.0.0/) {\r\n\u001b[?2004l\r"]
[80.190943, "o", "\u001b[?2004h> "]
[80.191233, "o", "                 prefix=\"public-\"\r\n\u001b[?2004l\r"]
[80.191287, "o", "\u001b[?2004h"]
[80.191334, "o", "> "]
[80.191658, "o", "             } else if ($4 ~ /^127.0.0.1/) {\r\n\u001b[?2004l\r"]
[80.191708, "o", "\u001b[?2004h"]
[80.191757, "o", "> "]
[80.192006, "o", "                 prefix=\"local-\"\r\n\u001b[?2004l\r"]
[80.192055, "o", "\u001b[?2004h"]
[80.192106, "o", "> "]
[80.19225, "o", "             } else {\r\n\u001b[?2004l\r"]
[80.192308, "o", "\u001b[?2004h"]
[80.192358, "o", "> "]
[80.192541, "o", "                 prefix=\"\"\r\n\u001b[?2004l\r"]
[80.192591, "o", "\u001b[?2004h"]
[80.192639, "o", "> "]
[80.192738, "o", "             }\r\n\u001b[?2004l\r"]
[80.192845, "o", "\u001b[?2004h> "]
[80.192942, "o", "             \r\n\u001b[?2004l\r"]
[80.19303, "o", "\u001b[?2004h> "]
[80.193238, "o", "             # Format output\r\n\u001b[?2004l\r"]
[80.193293, "o", "\u001b[?2004h> "]
[80.194013, "o", "             printf \"%s %s %s (%s %s)\\n\", port, prefix proto_port, $NF, $(NF-1), service_name\r\n\u001b[?2004l\r"]
[80.194087, "o", "\u001b[?2004h> "]
[80.194171, "o", "         }\r\n\u001b[?2004l\r"]
[80.194236, "o", "\u001b[?2004h> "]
[80.194638, "o", "    ' \"$NETSTAT_FILE\" | sort -k1n > \"$output_file\"\r\n\u001b[?2004l\r"]
[80.194694, "o", "\u001b[?2004h> "]
[80.194749, "o", "    \r\n\u001b[?2004l\r"]
[80.194803, "o", "\u001b[?2004h> "]
[80.19512, "o", "    echo \"Network analysis completed\"\r\n\u001b[?2004l\r"]
[80.195177, "o", "\u001b[?2004h> "]
[80.195231, "o", "}\r\n\u001b[?2004l\r\u001b[?2004h"]
[80.195296, "o", "> \r\n\u001b[?2004l\r"]
[80.19535, "o", "\u001b[?2004h> "]
[80.195702, "o", "# Function to process user audit data (Job 2)\r\n\u001b[?2004l\r"]
[80.195758, "o", "\u001b[?2004h> "]
[80.19605, "o", "function process_user_audit() {\r\n\u001b[?2004l\r"]
[80.196112, "o", "\u001b[?2004h> "]
[80.1965, "o", "    local output_file=\"$REPORT_DIR/user_audit.tmp\"\r\n\u001b[?2004l\r"]
[80.196551, "o", "\u001b[?2004h> "]
[80.196607, "o", "    \r\n\u001b[?2004l\r"]
[80.196656, "o", "\u001b[?2004h"]
[80.196708, "o", "> "]
[80.197024, "o", "    # Process passwd file with exclusions\r\n\u001b[?2004l\r"]
[80.197098, "o", "\u001b[?2004h> "]
[80.197653, "o", "    awk -F: -v limit=\"$UID_LIMIT\" -v blacklist_file=\"$USER_BLACKLIST_FILE\" '\r\n\u001b[?2004l\r"]
[80.197704, "o", "\u001b[?2004h> "]
[80.197877, "o", "        BEGIN { \r\n\u001b[?2004l\r"]
[80.197935, "o", "\u001b[?2004h> "]
[80.198362, "o", "            while ((getline bl < blacklist_file) > 0) {\r\n\u001b[?2004l\r"]
[80.198411, "o", "\u001b[?2004h> "]
[80.198689, "o", "                blacklist[bl] = 1\r\n\u001b[?2004l\r"]
[80.198743, "o", "\u001b[?2004h> "]
[80.198889, "o", "            }\r\n\u001b[?2004l\r"]
[80.198946, "o", "\u001b[?2004h> "]
[80.19921, "o", "            close(blacklist_file)\r\n\u001b[?2004l\r"]
[80.199258, "o", "\u001b[?2004h> "]
[80.199345, "o", "        }\r\n\u001b[?2004l\r"]
[80.199388, "o", "\u001b[?2004h> "]
[80.199868, "o", "        $3 < limit && $7 != \"/bin/false\" && !( $1 in blacklist ) {\r\n\u001b[?2004l\r"]
[80.199921, "o", "\u001b[?2004h> "]
[80.200079, "o", "            print $1\r\n\u001b[?2004l\r"]
[80.200146, "o", "\u001b[?2004h> "]
[80.200233, "o", "        }\r\n\u001b[?2004l\r"]
[80.200275, "o", "\u001b[?2004h"]
[80.200328, "o", "> "]
[80.200624, "o", "    ' \"$PASSWD_FILE\" | sort > \"$output_file\"\r\n\u001b[?2004l\r"]
[80.200668, "o", "\u001b[?2004h"]
[80.200734, "o", "> "]
[80.200788, "o", "    \r\n\u001b[?2004l\r\u001b[?2004h"]
[80.200866, "o", "> "]
[80.20107, "o", "    echo \"User audit completed\"\r\n\u001b[?2004l\r"]
[80.201131, "o", "\u001b[?2004h> "]
[80.201181, "o", "}\r\n\u001b[?2004l\r\u001b[?2004h"]
[80.201234, "o", "> "]
[80.201339, "o", "EOF"]
[116.873669, "i", "cat >> /home/user/reports/run_security_scan.sh << 'EOF'\n\n# Function to generate final reports\nfunction generate_reports() {\n    local yaml_file=\"$REPORT_DIR/infra_security_report.yml\"\n    local siem_log_file=\"$REPORT_DIR/scan_exec_time.log\"\n    local temp_network=\"$REPORT_DIR/network_analysis.tmp\"\n    local temp_users=\"$REPORT_DIR/user_audit.tmp\"\n    \n    # Convert network data to YAML format\n    cat > \"$yaml_file\" << YAMLEOF\n---\nmeta:\n  input_hash: \"$INPUT_HASH\"\ninsecure_users:\nYAMLEOF\n\n    while read -r user; do\n        echo \"  - $user\" >> \"$yaml_file\"\n    done < \"$temp_users\"\n    \n    echo -e \"open_ports:\" >> \"$yaml_file\"\n    \n    while read -r line; do\n        port=$(echo \"$line\" | awk '{print $1}')\n        proto=$(echo \"$line\" | awk '{print $2}')\n        process=$(echo \"$line\" | awk '{print $3}')\n        \n        echo -e \"  - port: $port\" >> \"$yaml_file\"\n        echo -e \"    protocol: $proto\" >> \"$yaml_file\"\n        echo -e \"    process: $process\" >> \"$yaml_file\"\n    done < \"$temp_network\"\n    \n    # Con"]
[116.873723, "i", "vert to ISO-8859-1 encoding\n    iconv -f UTF-8 -t ISO-8859-1 \"$yaml_file\" -o \"$yaml_file\"\n    \n    # Create SIEM log with CRLF line endings\n    echo -e \"start_epoch,end_epoch,duration\\r\" > \"$siem_log_file\"\n    local duration=$((END_EPOCH - START_EPOCH))\n    echo -e \"${START_EPOCH},${END_EPOCH},${duration}\\r\" >> \"$siem_log_file\"\n}\n\n# Function to clean up temporary files\nfunction cleanup() {\n    rm -f \"$REPORT_DIR/network_analysis.tmp\"\n    rm -f \"$REPORT_DIR/user_audit.tmp\"\n}\n\n# Trap function to handle script exit\nfunction on_exit() {\n    echo \"Cleaning up temporary files...\"\n    cleanup\n    echo \"Script execution completed\"\n}\n\n# Main execution block\n{\n    echo \"Starting security scan...\"\n    \n    # Capture start epoch\n    START_EPOCH=$(date +%s)\n    INPUT_HASH=$(calculate_input_hash)\n    \n    # Launch parallel jobs\n    process_network_data &\n    JOB_PIDS+=($!)  \n    \n    process_user_audit &\n    JOB_PIDS+=($!) \n    \n    # Wait for all jobs to complete\n    for pid in \"${JOB_PIDS[@]}\"; do\n        wait $pid\n    d"]
[116.873941, "i", "one\n    \n    # Calculate end epoch\n    END_EPOCH=$(date +%s)\n    \n    # Generate reports\n    generate_reports\n    \n    echo \"Security scan completed\"\n    echo \"Start epoch: $START_EPOCH, End epoch: $END_EPOCH, Duration: $((END_EPOCH - START_EPOCH)) seconds\"\n    \n    # Clean up temporary files\n    cleanup\n} &> \"$REPORT_DIR/scan_exec_time.log\"\n\n# Register cleanup function for script exit\nttrap on_exit EXIT\nEOF"]
[116.874294, "o", "cat >> /home/user/reports/run_security_scan.sh << 'EOF'\r\n"]
[116.874315, "o", "\u001b[?2004l\r"]
[116.874391, "o", "\u001b[?2004h"]
[116.87441, "o", "> "]
[116.874488, "o", "\r\n\u001b[?2004l\r"]
[116.87457, "o", "\u001b[?2004h> "]
[116.874792, "o", "# Function to generate final reports\r\n\u001b[?2004l\r"]
[116.87486, "o", "\u001b[?2004h> "]
[116.875083, "o", "function generate_reports() {\r\n\u001b[?2004l\r"]
[116.875139, "o", "\u001b[?2004h> "]
[116.875549, "o", "    local yaml_file=\"$REPORT_DIR/infra_security_report.yml\"\r\n\u001b[?2004l\r"]
[116.875618, "o", "\u001b[?2004h> "]
[116.876006, "o", "    local siem_log_file=\"$REPORT_DIR/scan_exec_time.log\"\r\n\u001b[?2004l\r"]
[116.876064, "o", "\u001b[?2004h> "]
[116.876498, "o", "    local temp_network=\"$REPORT_DIR/network_analysis.tmp\"\r\n\u001b[?2004l\r"]
[116.876561, "o", "\u001b[?2004h> "]
[116.87692, "o", "    local temp_users=\"$REPORT_DIR/user_audit.tmp\"\r\n\u001b[?2004l\r"]
[116.876976, "o", "\u001b[?2004h"]
[116.877026, "o", ">     \r\n\u001b[?2004l\r"]
[116.877074, "o", "\u001b[?2004h"]
[116.877129, "o", "> "]
[116.877398, "o", "    # Convert network data to YAML format\r\n\u001b[?2004l\r"]
[116.87745, "o", "\u001b[?2004h"]
[116.877497, "o", "> "]
[116.877703, "o", "    cat > \"$yaml_file\" << YAMLEOF\r\n\u001b[?2004l\r"]
[116.877759, "o", "\u001b[?2004h"]
[116.877804, "o", "> ---"]
[116.877859, "o", "\r\n\u001b[?2004l\r"]
[116.877905, "o", "\u001b[?2004h> "]
[116.877958, "o", "meta:\r\n\u001b[?2004l\r"]
[116.878007, "o", "\u001b[?2004h"]
[116.878052, "o", "> "]
[116.878234, "o", "  input_hash: \"$INPUT_HASH\"\r\n\u001b[?2004l\r"]
[116.878276, "o", "\u001b[?2004h"]
[116.878321, "o", "> "]
[116.878428, "o", "insecure_users:\r\n\u001b[?2004l\r"]
[116.87847, "o", "\u001b[?2004h"]
[116.878519, "o", "> "]
[116.878567, "o", "YAMLEOF\r\n\u001b[?2004l\r"]
[116.878614, "o", "\u001b[?2004h"]
[116.878659, "o", "> \r\n\u001b[?2004l\r"]
[116.878706, "o", "\u001b[?2004h"]
[116.878748, "o", "> "]
[116.878932, "o", "    while read -r user; do\r\n\u001b[?2004l\r"]
[116.878981, "o", "\u001b[?2004h"]
[116.879032, "o", "> "]
[116.879278, "o", "        echo \"  - $user\" >> \"$yaml_file\"\r\n\u001b[?2004l\r"]
[116.879325, "o", "\u001b[?2004h"]
[116.879373, "o", "> "]
[116.879537, "o", "    done < \"$temp_users\"\r\n\u001b[?2004l\r"]
[116.87959, "o", "\u001b[?2004h"]
[116.879639, "o", ">     \r\n\u001b[?2004l\r"]
[116.879699, "o", "\u001b[?2004h"]
[116.879751, "o", "> "]
[116.880039, "o", "    echo -e \"open_ports:\" >> \"$yaml_file\"\r\n\u001b[?2004l\r"]
[116.880102, "o", "\u001b[?2004h"]
[116.880149, "o", "> "]
[116.880195, "o", "    \r\n\u001b[?2004l\r\u001b[?2004h"]
[116.880241, "o", "> "]
[116.880433, "o", "    while read -r line; do\r\n\u001b[?2004l\r"]
[116.880484, "o", "\u001b[?2004h"]
[116.88053, "o", "> "]
[116.880828, "o", "        port=$(echo \"$line\" | awk '{print $1}')\r\n\u001b[?2004l\r"]
[116.880884, "o", "\u001b[?2004h"]
[116.880941, "o", "> "]
[116.881251, "o", "        proto=$(echo \"$line\" | awk '{print $2}')\r\n\u001b[?2004l\r"]
[116.881306, "o", "\u001b[?2004h> "]
[116.88166, "o", "        process=$(echo \"$line\" | awk '{print $3}')\r\n\u001b[?2004l\r"]
[116.881714, "o", "\u001b[?2004h> "]
[116.881797, "o", "        \r\n\u001b[?2004l\r"]
[116.88186, "o", "\u001b[?2004h> "]
[116.882216, "o", "        echo -e \"  - port: $port\" >> \"$yaml_file\"\r\n\u001b[?2004l\r"]
[116.882269, "o", "\u001b[?2004h> "]
[116.882645, "o", "        echo -e \"    protocol: $proto\" >> \"$yaml_file\"\r\n\u001b[?2004l\r"]
[116.882699, "o", "\u001b[?2004h> "]
[116.883101, "o", "        echo -e \"    process: $process\" >> \"$yaml_file\"\r\n\u001b[?2004l\r"]
[116.883161, "o", "\u001b[?2004h> "]
[116.88335, "o", "    done < \"$temp_network\"\r\n\u001b[?2004l\r"]
[116.883404, "o", "\u001b[?2004h> "]
[116.883449, "o", "    \r\n\u001b[?2004l\r"]
[116.8835, "o", "\u001b[?2004h"]
[116.883544, "o", "> "]
[116.883782, "o", "    # Convert to ISO-8859-1 encoding\r\n\u001b[?2004l\r"]
[116.883837, "o", "\u001b[?2004h"]
[116.88388, "o", "> "]
[116.884274, "o", "    iconv -f UTF-8 -t ISO-8859-1 \"$yaml_file\" -o \"$yaml_file\"\r\n\u001b[?2004l\r"]
[116.884325, "o", "\u001b[?2004h> "]
[116.884378, "o", "    \r\n\u001b[?2004l\r"]
[116.884424, "o", "\u001b[?2004h"]
[116.884469, "o", "> "]
[116.884759, "o", "    # Create SIEM log with CRLF line endings\r\n\u001b[?2004l\r"]
[116.884834, "o", "\u001b[?2004h> "]
[116.885267, "o", "    echo -e \"start_epoch,end_epoch,duration\\r\" > \"$siem_log_file\"\r\n\u001b[?2004l\r"]
[116.885314, "o", "\u001b[?2004h> "]
[116.885648, "o", "    local duration=$((END_EPOCH - START_EPOCH))\r\n\u001b[?2004l\r"]
[116.885698, "o", "\u001b[?2004h"]
[116.88574, "o", "> "]
[116.886224, "o", "    echo -e \"${START_EPOCH},${END_EPOCH},${duration}\\r\" >> \"$siem_log_file\"\r\n\u001b[?2004l\r"]
[116.886276, "o", "\u001b[?2004h"]
[116.886317, "o", "> }\r\n\u001b[?2004l\r"]
[116.886366, "o", "\u001b[?2004h> "]
[116.886416, "o", "\r\n\u001b[?2004l\r\u001b[?2004h"]
[116.886461, "o", "> "]
[116.886724, "o", "# Function to clean up temporary files\r\n\u001b[?2004l\r"]
[116.886771, "o", "\u001b[?2004h"]
[116.886822, "o", "> "]
[116.886954, "o", "function cleanup() {\r\n\u001b[?2004l\r"]
[116.887005, "o", "\u001b[?2004h"]
[116.887054, "o", "> "]
[116.88734, "o", "    rm -f \"$REPORT_DIR/network_analysis.tmp\"\r\n\u001b[?2004l\r"]
[116.887396, "o", "\u001b[?2004h> "]
[116.887681, "o", "    rm -f \"$REPORT_DIR/user_audit.tmp\"\r\n\u001b[?2004l\r"]
[116.887731, "o", "\u001b[?2004h> "]
[116.887782, "o", "}\r\n\u001b[?2004l\r"]
[116.887835, "o", "\u001b[?2004h> "]
[116.887878, "o", "\r\n\u001b[?2004l\r"]
[116.887912, "o", "\u001b[?2004h> "]
[116.888184, "o", "# Trap function to handle script exit\r\n\u001b[?2004l\r"]
[116.888236, "o", "\u001b[?2004h"]
[116.888286, "o", "> "]
[116.88842, "o", "function on_exit() {\r\n\u001b[?2004l\r"]
[116.888466, "o", "\u001b[?2004h> "]
[116.88877, "o", "    echo \"Cleaning up temporary files...\"\r\n\u001b[?2004l\r"]
[116.888842, "o", "\u001b[?2004h> "]
[116.888946, "o", "    cleanup\r\n\u001b[?2004l\r"]
[116.889001, "o", "\u001b[?2004h> "]
[116.889267, "o", "    echo \"Script execution completed\"\r\n\u001b[?2004l\r"]
[116.889315, "o", "\u001b[?2004h> "]
[116.889364, "o", "}\r\n\u001b[?2004l\r"]
[116.889423, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[116.889471, "o", "\u001b[?2004h"]
[116.889518, "o", "> "]
[116.889667, "o", "# Main execution block\r\n\u001b[?2004l\r"]
[116.889708, "o", "\u001b[?2004h"]
[116.889754, "o", "> {\r\n\u001b[?2004l\r"]
[116.889801, "o", "\u001b[?2004h"]
[116.889862, "o", "> "]
[116.890097, "o", "    echo \"Starting security scan...\"\r\n"]
[116.890143, "o", "\u001b[?2004l\r\u001b[?2004h"]
[116.89019, "o", "> "]
[116.890237, "o", "    \r\n\u001b[?2004l\r"]
[116.890282, "o", "\u001b[?2004h"]
[116.890324, "o", "> "]
[116.890491, "o", "    # Capture start epoch\r\n\u001b[?2004l\r"]
[116.890532, "o", "\u001b[?2004h"]
[116.890578, "o", "> "]
[116.890762, "o", "    START_EPOCH=$(date +%s)\r\n\u001b[?2004l\r"]
[116.890828, "o", "\u001b[?2004h> "]
[116.891099, "o", "    INPUT_HASH=$(calculate_input_hash)\r\n\u001b[?2004l\r"]
[116.891153, "o", "\u001b[?2004h"]
[116.891201, "o", "> "]
[116.891253, "o", "    \r\n\u001b[?2004l\r"]
[116.891305, "o", "\u001b[?2004h> "]
[116.891495, "o", "    # Launch parallel jobs\r\n\u001b[?2004l\r"]
[116.891542, "o", "\u001b[?2004h> "]
[116.891749, "o", "    process_network_data &\r\n\u001b[?2004l\r"]
[116.891807, "o", "\u001b[?2004h"]
[116.89187, "o", "> "]
[116.891994, "o", "    JOB_PIDS+=($!)  \r\n\u001b[?2004l\r"]
[116.892049, "o", "\u001b[?2004h"]
[116.892103, "o", ">     \r\n"]
[116.892156, "o", "\u001b[?2004l\r\u001b[?2004h"]
[116.892207, "o", "> "]
[116.892379, "o", "    process_user_audit &\r\n\u001b[?2004l\r"]
[116.892426, "o", "\u001b[?2004h"]
[116.892478, "o", "> "]
[116.892608, "o", "    JOB_PIDS+=($!) \r\n\u001b[?2004l\r"]
[116.892659, "o", "\u001b[?2004h"]
[116.892706, "o", "> "]
[116.892757, "o", "    \r\n\u001b[?2004l\r"]
[116.892806, "o", "\u001b[?2004h> "]
[116.893073, "o", "    # Wait for all jobs to complete\r\n\u001b[?2004l\r"]
[116.893128, "o", "\u001b[?2004h"]
[116.893177, "o", "> "]
[116.893407, "o", "    for pid in \"${JOB_PIDS[@]}\"; do\r\n\u001b[?2004l\r"]
[116.893454, "o", "\u001b[?2004h"]
[116.893507, "o", "> "]
[116.893622, "o", "        wait $pid\r\n\u001b[?2004l\r"]
[116.893706, "o", "\u001b[?2004h"]
[116.893761, "o", "> "]
[116.893808, "o", "    done\r\n\u001b[?2004l\r"]
[116.893891, "o", "\u001b[?2004h"]
[116.893941, "o", "> "]
[116.894006, "o", "    \r\n\u001b[?2004l\r\u001b[?2004h"]
[116.894058, "o", "> "]
[116.894235, "o", "    # Calculate end epoch\r\n\u001b[?2004l\r"]
[116.894283, "o", "\u001b[?2004h> "]
[116.894488, "o", "    END_EPOCH=$(date +%s)\r\n\u001b[?2004l\r"]
[116.894542, "o", "\u001b[?2004h> "]
[116.894604, "o", "    \r\n\u001b[?2004l\r"]
[116.894656, "o", "\u001b[?2004h> "]
[116.89484, "o", "    # Generate reports\r\n\u001b[?2004l\r"]
[116.894886, "o", "\u001b[?2004h"]
[116.894942, "o", "> "]
[116.895082, "o", "    generate_reports\r\n\u001b[?2004l\r"]
[116.89513, "o", "\u001b[?2004h"]
[116.895175, "o", "> "]
[116.895222, "o", "    \r\n\u001b[?2004l\r"]
[116.895247, "o", "\u001b[?2004h"]
[116.895267, "o", "> "]
[116.895533, "o", "    echo \"Security scan completed\"\r\n\u001b[?2004l\r"]
[116.895585, "o", "\u001b[?2004h"]
[116.895627, "o", "> "]
[116.896314, "o", "    echo \"Start epoch: $START_EPOCH, End epoch: $END_EPOCH, Duration: $((END_EPOCH - START_EPOCH)) seconds\"\r\n\u001b[?2004l\r"]
[116.896369, "o", "\u001b[?2004h"]
[116.896423, "o", ">     \r\n\u001b[?2004l\r"]
[116.896464, "o", "\u001b[?2004h"]
[116.896514, "o", "> "]
[116.896711, "o", "    # Clean up temporary files\r\n\u001b[?2004l\r"]
[116.89676, "o", "\u001b[?2004h"]
[116.896801, "o", "> "]
[116.896896, "o", "    cleanup\r\n\u001b[?2004l\r"]
[116.896949, "o", "\u001b[?2004h> "]
[116.897223, "o", "} &> \"$REPORT_DIR/scan_exec_time.log\"\r\n\u001b[?2004l\r"]
[116.89727, "o", "\u001b[?2004h"]
[116.897313, "o", "> \r\n\u001b[?2004l\r"]
[116.897355, "o", "\u001b[?2004h> "]
[116.897672, "o", "# Register cleanup function for script exit\r\n\u001b[?2004l\r"]
[116.897714, "o", "\u001b[?2004h"]
[116.89776, "o", "> "]
[116.897907, "o", "ttrap on_exit EXIT\r\n\u001b[?2004l\r"]
[116.897961, "o", "\u001b[?2004h"]
[116.898009, "o", "> EOF"]
[117.40819, "i", "chmod +x /home/user/reports/run_security_scan.sh\n"]
[117.408656, "o", "chmod +x /home/user/reports/run_security_scan.sh\r\n\u001b[?2004l\r"]
[117.408749, "o", "\u001b[?2004h"]
[117.408807, "o", "> "]
[117.620893, "i", "/home/user/reports/run_security_scan.sh\n"]
[117.621308, "o", "/home/user/reports/run_security_scan.sh\r\n\u001b[?2004l\r"]
[117.621382, "o", "\u001b[?2004h"]
[117.621436, "o", "> "]
[119.690655, "i", "ls -la /home/user/reports/\n"]
[119.691011, "o", "ls -la /home/user/reports/\r\n\u001b[?2004l\r"]
[119.691104, "o", "\u001b[?2004h> "]
[119.969008, "i", "file /home/user/reports/infra_security_report.yml\n"]
[119.969496, "o", "file /home/user/reports/infra_security_report.yml\r\n\u001b[?2004l\r"]
[119.969557, "o", "\u001b[?2004h"]
[119.969601, "o", "> "]
[120.213071, "i", "cat /home/user/reports/infra_security_report.yml\n"]
[120.213391, "o", "cat /home/user/reports/infra_security_report.yml\r\n\u001b[?2004l\r"]
[120.213457, "o", "\u001b[?2004h> "]
