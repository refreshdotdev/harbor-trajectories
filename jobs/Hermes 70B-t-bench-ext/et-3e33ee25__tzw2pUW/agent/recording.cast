{"version": 2, "width": 160, "height": 40, "timestamp": 1771008791, "env": {"SHELL": "/bin/bash", "TERM": "screen"}}
[0.005779, "o", "\u001b[?2004hroot@575b4abc-7c46-4d84-91f7-19e81e66c20e:~# "]
[1.0229, "i", "clear\r"]
[1.023021, "o", "clear\r\n\u001b[?2004l\r"]
[1.024116, "o", "\u001b[H\u001b[J"]
[1.024292, "o", "\u001b[?2004hroot@575b4abc-7c46-4d84-91f7-19e81e66c20e:~# "]
[6.853294, "i", "mkdir -p /home/user/reports\n"]
[6.853425, "o", "mkdir -p /home/user/reports\r\n\u001b[?2004l\r"]
[6.854769, "o", "\u001b[?2004h"]
[6.8548, "o", "root@575b4abc-7c46-4d84-91f7-19e81e66c20e:~# "]
[7.06777, "i", "mkdir -p /home/user/sample_data\n"]
[7.068032, "o", "mkdir -p /home/user/sample_data\r\n\u001b[?2004l\r"]
[7.069148, "o", "\u001b[?2004hroot@575b4abc-7c46-4d84-91f7-19e81e66c20e:~# "]
[7.185206, "i", "mkdir -p /home/user/config\n"]
[7.1856, "o", "mkdir -p /home/user/config\r\n\u001b[?2004l\r"]
[7.186778, "o", "\u001b[?2004hroot@575b4abc-7c46-4d84-91f7-19e81e66c20e:~# "]
[18.328787, "i", "cat > /home/user/sample_data/mock_netstat.txt << 'EOF'\ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      \ntcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      \nudp        0      0 0.0.0.0:161             0.0.0.0:*                           \ntcp        0      0 192.168.1.100:9000      0.0.0.0:*               LISTEN      \nEOF"]
[18.329031, "o", "cat > /home/user/sample_data/mock_netstat.txt << 'EOF'\r\n\u001b[?2004l\r"]
[18.329069, "o", "\u001b[?2004h> "]
[18.329282, "o", "tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      \r\n\u001b[?2004l\r"]
[18.329316, "o", "\u001b[?2004h> "]
[18.329505, "o", "tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      \r\n\u001b[?2004l\r"]
[18.329525, "o", "\u001b[?2004h> "]
[18.32974, "o", "udp        0      0 0.0.0.0:161             0.0.0.0:*                           \r\n\u001b[?2004l\r"]
[18.329766, "o", "\u001b[?2004h> "]
[18.329986, "o", "tcp        0      0 192.168.1.100:9000      0.0.0.0:*               LISTEN      \r\n\u001b[?2004l\r"]
[18.330011, "o", "\u001b[?2004h> "]
[18.330032, "o", "EOF"]
[18.411575, "i", "cat > /home/user/sample_data/mock_passwd << 'EOF'\nroot:x:0:0:root:/root:/bin/bash\nbin:x:1:1:bin:/bin:/bin/false\ndaemon:x:2:2:daemon:/sbin:/bin/false\nadm:x:3:4:adm:/var/adm:/bin/false\nlp:x:4:7:lp:/var/spool/lpd:/bin/false\nEOF"]
[18.411771, "o", "cat > /home/user/sample_data/mock_passwd << 'EOF'\r\n\u001b[?2004l\r"]
[18.411813, "o", "\u001b[?2004h"]
[18.411839, "o", "> "]
[18.41194, "o", "root:x:0:0:root:/root:/bin/bash\r\n\u001b[?2004l\r"]
[18.411999, "o", "\u001b[?2004h> "]
[18.412065, "o", "bin:x:1:1:bin:/bin:/bin/false\r\n\u001b[?2004l\r"]
[18.412087, "o", "\u001b[?2004h"]
[18.412106, "o", "> "]
[18.412203, "o", "daemon:x:2:2:daemon:/sbin:/bin/false\r\n\u001b[?2004l\r"]
[18.412225, "o", "\u001b[?2004h"]
[18.412242, "o", "> "]
[18.412328, "o", "adm:x:3:4:adm:/var/adm:/bin/false\r\n\u001b[?2004l\r"]
[18.412351, "o", "\u001b[?2004h> "]
[18.412462, "o", "lp:x:4:7:lp:/var/spool/lpd:/bin/false\r\n\u001b[?2004l\r"]
[18.412482, "o", "\u001b[?2004h> "]
[18.412512, "o", "EOF"]
[18.512491, "i", "cat > /home/user/sample_data/service_names.csv << 'EOF'\n80/tcp,http\n22/tcp,ssh\n3306/tcp,mysql\n161/udp,snmp\n9000/tcp,BjörnApp\nEOF"]
[18.512957, "o", "cat > /home/user/sample_data/service_names.csv << 'EOF'\r\n\u001b[?2004l\r"]
[18.51306, "o", "\u001b[?2004h"]
[18.513075, "o", "> "]
[18.513186, "o", "80/tcp,http\r\n\u001b[?2004l\r"]
[18.513243, "o", "\u001b[?2004h"]
[18.513297, "o", "> "]
[18.513358, "o", "22/tcp,ssh\r\n\u001b[?2004l\r"]
[18.513398, "o", "\u001b[?2004h> "]
[18.51349, "o", "3306/tcp,mysql\r\n\u001b[?2004l\r"]
[18.513543, "o", "\u001b[?2004h> "]
[18.513616, "o", "161/udp,snmp\r\n\u001b[?2004l\r"]
[18.513651, "o", "\u001b[?2004h"]
[18.51369, "o", "> "]
[18.513777, "o", "9000/tcp,BjörnApp\r\n\u001b[?2004l\r"]
[18.513825, "o", "\u001b[?2004h> "]
[18.513845, "o", "EOF"]
[18.672882, "i", "cat > /home/user/config/user_blacklist.txt << 'EOF'\nnagios\nzabbix\nEOF"]
[18.673097, "o", "cat > /home/user/config/user_blacklist.txt << 'EOF'\r\n\u001b[?2004l\r"]
[18.673155, "o", "\u001b[?2004h> "]
[18.673189, "o", "nagios\r\n\u001b[?2004l\r\u001b[?2004h"]
[18.673219, "o", "> "]
[18.673249, "o", "zabbix\r\n\u001b[?2004l\r\u001b[?2004h> "]
[18.673277, "o", "EOF"]
[92.279696, "i", "cat > /home/user/reports/run_security_scan.sh << 'EOF'\n#!/bin/bash\n\n# Enterprise Security Baseline Automation (SOP-992)\n# Ticket SEC-4022: Automate daily infrastructure snapshot report\n\nset -eo pipefail\n\n# Configuration\nOUTPUT_DIR=\"/home/user/reports\"\nSAMPLE_DATA_DIR=\"/home/user/sample_data\"\nCONFIG_DIR=\"/home/user/config\"\n\ntmp_dir=\"$(mktemp -d)\"\nUID_LIMIT=1000\n\n# Cleanup function for temporary files\n cleanup() {\n    rm -rf \"${tmp_dir}\"\n}\n\n# Register cleanup function\n trap cleanup EXIT\n\n# Function to extract port from netstat line\n get_port() {\n    echo \"$1\" | awk -F'[ :]' '{for(i=1; i<=NF; i++) {if($i ~ /^\\d+\\/tcp$/ || $i ~ /^\\d+\\/udp$/) {split($i, a, \"/\"); print a[1]; break}}}'\n}\n\n# Function to classify scope\n classify_scope() {\n    local addr=\"${1}\"\n    local proto=\"${2}\"\n    \n    if [[ \"${addr}\" == \"0.0.0.0:*\" || \"${addr}\" == \"0.0.0.0\" ]]; then\n        echo \"public-${proto}\"\n    elif [[ \"${addr}\" == \"127.0.0.1:*\" || \"${addr}\" == \"127.0.0.1\" ]]; then\n        echo \"local-${proto}\"\n    else\n        echo \"${pr"]
[92.279888, "i", "oto}\"\n    fi\n}\n\n# Function to enrich process name\n enrich_process() {\n    local process=\"${1}\"\n    local port_proto=\"${2}\"\n    local service_name=\"${3}\"\n    \n    if [[ -n \"${service_name}\" ]]; then\n        echo \"${process} (${service_name})\"\n    else\n        echo \"${process}\"\n    fi\n}\n\n# Job 1: Network Exposure Analysis\n analyze_network() {\n    local netstat_file=\"${SAMPLE_DATA_DIR}/mock_netstat.txt\"\n    local service_file=\"${SAMPLE_DATA_DIR}/service_names.csv\"\n    local output_file=\"${tmp_dir}/network_results.txt\"\n    \n    # Strip BOM from service file\n    local service_file_clean=\"${tmp_dir}/service_names_clean.csv\"\n    tail -c +4 \"${service_file}\" > \"${service_file_clean}\"\n    \n    grep -E 'LISTEN|udp' \"${netstat_file}\" | awk '{print $1,$4,$6}' | \n    while read -r proto local_addr state; do\n        port=\"$(get_port \"${local_addr}\")\"\n        service_name=\"$(grep -E \"^${port}/${proto},\" \"${service_file_clean}\" | cut -d',' -f2)\"\n        \n        classified_proto=\"$(classify_scope \"${local_addr}\" \"${proto}\")\""]
[92.279958, "i", "\n        \n        # Extract process name from netstat (last column)\n        grep \"${local_addr}\" \"${netstat_file}\" | awk '{print $NF}' | sort -u | \n        while read -r process; do\n            enriched_process=\"$(enrich_process \"${process}\" \"${port_proto}\" \"${service_name}\")\"\n            echo -e \"${port}\\t${classified_proto}\\t${enriched_process}\"\n        done\n    done | sort -k1,1n > \"${output_file}\"\n    \n    echo \"${output_file}\"\n}\n\n# Job 2: User Audit\n analyze_users() {\n    local passwd_file=\"${SAMPLE_DATA_DIR}/mock_passwd\"\n    local blacklist_file=\"${CONFIG_DIR}/user_blacklist.txt\"\n    local output_file=\"${tmp_dir}/user_results.txt\"\n    \n    grep -v ':/bin/false:$' \"${passwd_file}\" | \n    awk -F':' -v uid_limit=\"${UID_LIMIT}\" -v blacklist_file=\"${CONFIG_DIR}/user_blacklist.txt\" '{ \n        if($3 < uid_limit && $3 != 0) {\n            if(!system(\"grep -qx \\\"\"$1\"\\\" \\\"\"blacklist_file\"\\\"\")) {\n                print $1\n            }\n        }\n    }' | sort > \"${output_file}\"\n    \n    echo \"${output_file}\"\n}\n\n# G"]
[92.280037, "i", "enerate reports\n generate_reports() {\n    local start_epoch=\"${1}\"\n    local end_epoch=\"${2}\"\n    local network_results=\"${3}\"\n    local user_results=\"${4}\"\n    \n    # Calculate input hash\n    local input_hash=\"$((cat \"${SAMPLE_DATA_DIR}/mock_netstat.txt\" \"${SAMPLE_DATA_DIR}/mock_passwd\" | \\\n        md5sum | cut -d' ' -f1))\"\n    \n    # Generate YAML report (ISO-8859-1 encoded)\n    local yaml_file=\"${OUTPUT_DIR}/infra_security_report.yml\"\n    \n    {\n        echo \"---\"\n        echo \"meta:\" \n        echo \"  input_hash: ${input_hash}\"\n        echo \"insecure_users:\" \n        while read -r user; do\n            echo \"  - ${user}\"\n        done < \"${user_results}\"\n        echo \"open_ports:\" \n        while read -r line; do\n            port=\"$(echo \"${line}\" | cut -f1)\"\n            protocol=\"$(echo \"${line}\" | cut -f2)\"\n            process=\"$(echo \"${line}\" | cut -f3)\"\n            echo \"  - port: ${port}\"\n            echo \"    protocol: ${protocol}\"\n            echo \"    process: ${process}\"\n        done < \"${network_re"]
[92.280096, "i", "sults}\"\n    } | iconv -t ISO-8859-1 > \"${yaml_file}\"\n    \n    # Generate CSV report (CRLF line endings)\n    local csv_file=\"${OUTPUT_DIR}/scan_exec_time.log\"\n    local duration=\"$((${end_epoch} - ${start_epoch}))\"\n    echo -e \"${start_epoch},${end_epoch},${duration}\" | \\\n        sed 's/$/\\r/' > \"${csv_file}\"\n}\n\n# Main script execution\n start_epoch=$$(date +%s)\n\n# Run jobs in parallel\n network_output=$$(analyze_network &)\n user_output=$$(analyze_users &)\n\n# Wait for background jobs to complete\n wait\n\n end_epoch=$$(date +%s)\n\n# Generate final reports\n generate_reports \"${start_epoch}\" \"${end_epoch}\" \"${network_output}\" \"${user_output}\"\n\n# Set executable permission\n chmod +x \"${OUTPUT_DIR}/run_security_scan.sh\"\n\necho \"Security scan completed successfully\"\nEOF"]
[92.280149, "o", "cat > /home/user/reports/run_security_scan.sh << 'EOF'\r\n\u001b[?2004l\r"]
[92.280236, "o", "\u001b[?2004h> "]
[92.280289, "o", "#!/bin/bash\r\n\u001b[?2004l\r"]
[92.280325, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r"]
[92.280354, "o", "\u001b[?2004h"]
[92.280386, "o", "> "]
[92.280667, "o", "# Enterprise Security Baseline Automation (SOP-992)\r\n\u001b[?2004l\r"]
[92.280698, "o", "\u001b[?2004h"]
[92.28073, "o", "> "]
[92.281084, "o", "# Ticket SEC-4022: Automate daily infrastructure snapshot report\r\n\u001b[?2004l\r"]
[92.281112, "o", "\u001b[?2004h"]
[92.281143, "o", "> \r\n\u001b[?2004l\r"]
[92.281172, "o", "\u001b[?2004h"]
[92.281203, "o", "> "]
[92.281293, "o", "set -eo pipefail\r\n\u001b[?2004l\r"]
[92.281327, "o", "\u001b[?2004h"]
[92.281358, "o", "> \r\n\u001b[?2004l\r"]
[92.281387, "o", "\u001b[?2004h"]
[92.281423, "o", "> "]
[92.281504, "o", "# Configuration\r\n\u001b[?2004l\r"]
[92.281538, "o", "\u001b[?2004h"]
[92.28157, "o", "> "]
[92.281741, "o", "OUTPUT_DIR=\"/home/user/reports\"\r\n\u001b[?2004l\r"]
[92.281771, "o", "\u001b[?2004h"]
[92.281802, "o", "> "]
[92.282036, "o", "SAMPLE_DATA_DIR=\"/home/user/sample_data\"\r\n\u001b[?2004l\r"]
[92.282071, "o", "\u001b[?2004h"]
[92.282103, "o", "> "]
[92.282269, "o", "CONFIG_DIR=\"/home/user/config\"\r\n\u001b[?2004l\r"]
[92.282301, "o", "\u001b[?2004h"]
[92.282331, "o", "> \r\n\u001b[?2004l\r"]
[92.28236, "o", "\u001b[?2004h"]
[92.282388, "o", "> "]
[92.282512, "o", "tmp_dir=\"$(mktemp -d)\"\r\n\u001b[?2004l\r"]
[92.282545, "o", "\u001b[?2004h"]
[92.282554, "o", "> "]
[92.282652, "o", "UID_LIMIT=1000\r\n"]
[92.28266, "o", "\u001b[?2004l\r"]
[92.282683, "o", "\u001b[?2004h"]
[92.282731, "o", "> \r\n\u001b[?2004l\r"]
[92.282763, "o", "\u001b[?2004h> "]
[92.282981, "o", "# Cleanup function for temporary files\r\n\u001b[?2004l\r"]
[92.283017, "o", "\u001b[?2004h"]
[92.28305, "o", "> "]
[92.283125, "o", " cleanup() {\r\n\u001b[?2004l\r"]
[92.283159, "o", "\u001b[?2004h"]
[92.283167, "o", "> "]
[92.283314, "o", "    rm -rf \"${tmp_dir}\"\r\n"]
[92.283345, "o", "\u001b[?2004l\r"]
[92.283375, "o", "\u001b[?2004h"]
[92.283385, "o", "> }\r\n\u001b[?2004l\r"]
[92.283422, "o", "\u001b[?2004h"]
[92.283431, "o", "> "]
[92.283476, "o", "\r\n\u001b[?2004l\r"]
[92.283507, "o", "\u001b[?2004h> "]
[92.283655, "o", "# Register cleanup function\r\n\u001b[?2004l\r"]
[92.283685, "o", "\u001b[?2004h"]
[92.283715, "o", "> "]
[92.283819, "o", " trap cleanup EXIT\r\n\u001b[?2004l\r"]
[92.283854, "o", "\u001b[?2004h"]
[92.283884, "o", "> "]
[92.283912, "o", "\r\n\u001b[?2004l\r"]
[92.283922, "o", "\u001b[?2004h> "]
[92.284184, "o", "# Function to extract port from netstat line\r\n\u001b[?2004l\r"]
[92.284212, "o", "\u001b[?2004h"]
[92.284243, "o", "> "]
[92.28432, "o", " get_port() {\r\n\u001b[?2004l\r"]
[92.284352, "o", "\u001b[?2004h"]
[92.284384, "o", "> "]
[92.28513, "o", "    echo \"$1\" | awk -F'[ :]' '{for(i=1; i<=NF; i++) {if($i ~ /^\\d+\\/tcp$/ || $i ~ /^\\d+\\/udp$/) {split($i, a, \"/\"); print a[1]; break}}}'\r\n\u001b[?2004l\r"]
[92.285174, "o", "\u001b[?2004h"]
[92.285206, "o", "> }"]
[92.285216, "o", "\r\n\u001b[?2004l\r"]
[92.285257, "o", "\u001b[?2004h"]
[92.285285, "o", "> \r\n\u001b[?2004l\r"]
[92.285315, "o", "\u001b[?2004h> "]
[92.285469, "o", "# Function to classify scope\r\n\u001b[?2004l\r"]
[92.285499, "o", "\u001b[?2004h"]
[92.28553, "o", "> "]
[92.285639, "o", " classify_scope() {\r\n\u001b[?2004l\r"]
[92.285675, "o", "\u001b[?2004h"]
[92.285706, "o", "> "]
[92.285825, "o", "    local addr=\"${1}\"\r\n\u001b[?2004l\r"]
[92.285854, "o", "\u001b[?2004h"]
[92.285886, "o", "> "]
[92.286, "o", "    local proto=\"${2}\"\r\n\u001b[?2004l\r"]
[92.286029, "o", "\u001b[?2004h"]
[92.286059, "o", "> "]
[92.286088, "o", "    \r\n"]
[92.286115, "o", "\u001b[?2004l\r"]
[92.286144, "o", "\u001b[?2004h> "]
[92.286455, "o", "    if [[ \"${addr}\" == \"0.0.0.0:*\" || \"${addr}\" == \"0.0.0.0\" ]]; then\r\n\u001b[?2004l\r"]
[92.286484, "o", "\u001b[?2004h"]
[92.286513, "o", "> "]
[92.286657, "o", "        echo \"public-${proto}\"\r\n\u001b[?2004l\r"]
[92.286689, "o", "\u001b[?2004h"]
[92.286719, "o", "> "]
[92.287066, "o", "    elif [[ \"${addr}\" == \"127.0.0.1:*\" || \"${addr}\" == \"127.0.0.1\" ]]; then\r\n\u001b[?2004l\r"]
[92.287093, "o", "\u001b[?2004h"]
[92.287124, "o", "> "]
[92.28726, "o", "        echo \"local-${proto}\"\r\n\u001b[?2004l\r"]
[92.287288, "o", "\u001b[?2004h"]
[92.287318, "o", "> "]
[92.287362, "o", "    else\r\n\u001b[?2004l\r"]
[92.287391, "o", "\u001b[?2004h"]
[92.287421, "o", "> "]
[92.287531, "o", "        echo \"${proto}\"\r\n\u001b[?2004l\r"]
[92.28756, "o", "\u001b[?2004h"]
[92.287589, "o", "> "]
[92.287623, "o", "    fi\r\n\u001b[?2004l\r"]
[92.287655, "o", "\u001b[?2004h"]
[92.287685, "o", "> }\r\n"]
[92.287716, "o", "\u001b[?2004l\r\u001b[?2004h"]
[92.287735, "o", "> "]
[92.287768, "o", "\r\n\u001b[?2004l\r"]
[92.287799, "o", "\u001b[?2004h"]
[92.287829, "o", "> "]
[92.287967, "o", "# Function to enrich process name\r\n"]
[92.288019, "o", "\u001b[?2004l\r"]
[92.288048, "o", "\u001b[?2004h> "]
[92.288112, "o", " enrich_process() {\r\n\u001b[?2004l\r"]
[92.288147, "o", "\u001b[?2004h"]
[92.288178, "o", "> "]
[92.288293, "o", "    local process=\"${1}\"\r\n\u001b[?2004l\r"]
[92.288321, "o", "\u001b[?2004h"]
[92.28835, "o", "> "]
[92.28848, "o", "    local port_proto=\"${2}\"\r\n\u001b[?2004l\r"]
[92.288507, "o", "\u001b[?2004h"]
[92.288537, "o", "> "]
[92.288675, "o", "    local service_name=\"${3}\"\r\n\u001b[?2004l\r"]
[92.288703, "o", "\u001b[?2004h"]
[92.288732, "o", "> "]
[92.288762, "o", "    \r\n"]
[92.288789, "o", "\u001b[?2004l\r"]
[92.288819, "o", "\u001b[?2004h> "]
[92.289029, "o", "    if [[ -n \"${service_name}\" ]]; then\r\n\u001b[?2004l\r"]
[92.289065, "o", "\u001b[?2004h"]
[92.289096, "o", "> "]
[92.289286, "o", "        echo \"${process} (${service_name})\"\r\n\u001b[?2004l\r"]
[92.289317, "o", "\u001b[?2004h"]
[92.289347, "o", "> "]
[92.289391, "o", "    else\r\n\u001b[?2004l\r"]
[92.289419, "o", "\u001b[?2004h"]
[92.289449, "o", "> "]
[92.289568, "o", "        echo \"${process}\"\r\n\u001b[?2004l\r"]
[92.289597, "o", "\u001b[?2004h"]
[92.289627, "o", "> "]
[92.289662, "o", "    fi\r\n\u001b[?2004l\r"]
[92.289692, "o", "\u001b[?2004h"]
[92.289724, "o", "> }\r\n\u001b[?2004l\r"]
[92.289755, "o", "\u001b[?2004h"]
[92.289785, "o", "> \r\n\u001b[?2004l\r"]
[92.289813, "o", "\u001b[?2004h"]
[92.289842, "o", "> "]
[92.290006, "o", "# Job 1: Network Exposure Analysis\r\n\u001b[?2004l\r"]
[92.290035, "o", "\u001b[?2004h"]
[92.290065, "o", "> "]
[92.290165, "o", " analyze_network() {\r\n\u001b[?2004l\r"]
[92.290194, "o", "\u001b[?2004h"]
[92.290224, "o", "> "]
[92.290493, "o", "    local netstat_file=\"${SAMPLE_DATA_DIR}/mock_netstat.txt\"\r\n\u001b[?2004l\r"]
[92.290519, "o", "\u001b[?2004h"]
[92.29055, "o", "> "]
[92.290825, "o", "    local service_file=\"${SAMPLE_DATA_DIR}/service_names.csv\"\r\n\u001b[?2004l\r"]
[92.290852, "o", "\u001b[?2004h"]
[92.290881, "o", "> "]
[92.291135, "o", "    local output_file=\"${tmp_dir}/network_results.txt\"\r\n"]
[92.291146, "o", "\u001b[?2004l\r"]
[92.291185, "o", "\u001b[?2004h> "]
[92.291211, "o", "    \r\n"]
[92.291241, "o", "\u001b[?2004l\r"]
[92.291272, "o", "\u001b[?2004h"]
[92.291302, "o", "> "]
[92.291436, "o", "    # Strip BOM from service file\r\n\u001b[?2004l\r"]
[92.291463, "o", "\u001b[?2004h"]
[92.291493, "o", "> "]
[92.291784, "o", "    local service_file_clean=\"${tmp_dir}/service_names_clean.csv\"\r\n\u001b[?2004l\r"]
[92.291816, "o", "\u001b[?2004h"]
[92.291845, "o", "> "]
[92.292116, "o", "    tail -c +4 \"${service_file}\" > \"${service_file_clean}\"\r\n\u001b[?2004l\r"]
[92.292144, "o", "\u001b[?2004h"]
[92.292175, "o", "> "]
[92.292205, "o", "    \r\n\u001b[?2004l\r"]
[92.292233, "o", "\u001b[?2004h"]
[92.292263, "o", "> "]
[92.292572, "o", "    grep -E 'LISTEN|udp' \"${netstat_file}\" | awk '{print $1,$4,$6}' | \r\n\u001b[?2004l\r"]
[92.292607, "o", "\u001b[?2004h"]
[92.292635, "o", "> "]
[92.292839, "o", "    while read -r proto local_addr state; do\r\n\u001b[?2004l\r"]
[92.292872, "o", "\u001b[?2004h"]
[92.292889, "o", "> "]
[92.293113, "o", "        port=\"$(get_port \"${local_addr}\")\"\r\n\u001b[?2004l\r"]
[92.293135, "o", "\u001b[?2004h"]
[92.29316, "o", "> "]
[92.293564, "o", "        service_name=\"$(grep -E \"^${port}/${proto},\" \"${service_file_clean}\" | cut -d',' -f2)\"\r\n\u001b[?2004l\r"]
[92.293587, "o", "\u001b[?2004h"]
[92.29361, "o", "> "]
[92.293641, "o", "        \r\n\u001b[?2004l\r"]
[92.293667, "o", "\u001b[?2004h"]
[92.293688, "o", "> "]
[92.294002, "o", "        classified_proto=\"$(classify_scope \"${local_addr}\" \"${proto}\")\"\r\n"]
[92.29403, "o", "\u001b[?2004l\r\u001b[?2004h"]
[92.294039, "o", "> "]
[92.294083, "o", "        \r\n\u001b[?2004l\r"]
[92.294106, "o", "\u001b[?2004h"]
[92.294122, "o", "> "]
[92.294375, "o", "        # Extract process name from netstat (last column)\r\n\u001b[?2004l\r"]
[92.294398, "o", "\u001b[?2004h"]
[92.294418, "o", "> "]
[92.294762, "o", "        grep \"${local_addr}\" \"${netstat_file}\" | awk '{print $NF}' | sort -u | \r\n\u001b[?2004l\r"]
[92.294786, "o", "\u001b[?2004h"]
[92.294807, "o", "> "]
[92.294951, "o", "        while read -r process; do\r\n\u001b[?2004l\r"]
[92.294979, "o", "\u001b[?2004h"]
[92.295002, "o", "> "]
[92.295417, "o", "            enriched_process=\"$(enrich_process \"${process}\" \"${port_proto}\" \"${service_name}\")\"\r\n\u001b[?2004l\r"]
[92.295445, "o", "\u001b[?2004h"]
[92.295465, "o", "> "]
[92.295777, "o", "            echo -e \"${port}\\t${classified_proto}\\t${enriched_process}\"\r\n\u001b[?2004l\r"]
[92.295796, "o", "\u001b[?2004h"]
[92.295821, "o", "> "]
[92.295883, "o", "        done\r\n\u001b[?2004l\r"]
[92.295911, "o", "\u001b[?2004h"]
[92.295934, "o", "> "]
[92.296145, "o", "    done | sort -k1,1n > \"${output_file}\"\r\n\u001b[?2004l\r"]
[92.296175, "o", "\u001b[?2004h"]
[92.296204, "o", "> "]
[92.296223, "o", "    \r\n\u001b[?2004l\r"]
[92.296257, "o", "\u001b[?2004h> "]
[92.29639, "o", "    echo \"${output_file}\"\r\n\u001b[?2004l\r"]
[92.296414, "o", "\u001b[?2004h"]
[92.296432, "o", "> "]
[92.296451, "o", "}\r\n\u001b[?2004l\r"]
[92.296471, "o", "\u001b[?2004h"]
[92.296484, "o", "> "]
[92.296505, "o", "\r\n\u001b[?2004l\r"]
[92.29652, "o", "\u001b[?2004h"]
[92.296531, "o", "> "]
[92.296693, "o", "# Job 2: User Audit\r\n\u001b[?2004l\r\u001b[?2004h> "]
[92.296822, "o", " analyze_users() {\r\n\u001b[?2004l\r\u001b[?2004h"]
[92.296847, "o", "> "]
[92.297103, "o", "    local passwd_file=\"${SAMPLE_DATA_DIR}/mock_passwd\"\r\n\u001b[?2004l\r"]
[92.297134, "o", "\u001b[?2004h"]
[92.297155, "o", "> "]
[92.29741, "o", "    local blacklist_file=\"${CONFIG_DIR}/user_blacklist.txt\"\r\n\u001b[?2004l\r"]
[92.297433, "o", "\u001b[?2004h"]
[92.297452, "o", "> "]
[92.297675, "o", "    local output_file=\"${tmp_dir}/user_results.txt\"\r\n\u001b[?2004l\r"]
[92.297698, "o", "\u001b[?2004h"]
[92.297715, "o", "> "]
[92.297737, "o", "    \r\n\u001b[?2004l\r"]
[92.297766, "o", "\u001b[?2004h"]
[92.297782, "o", "> "]
[92.298, "o", "    grep -v ':/bin/false:$' \"${passwd_file}\" | \r\n"]
[92.298034, "o", "\u001b[?2004l\r\u001b[?2004h> "]
[92.29847, "o", "    awk -F':' -v uid_limit=\"${UID_LIMIT}\" -v blacklist_file=\"${CONFIG_DIR}/user_blacklist.txt\" '{ \r\n\u001b[?2004l\r"]
[92.298493, "o", "\u001b[?2004h"]
[92.298513, "o", "> "]
[92.298685, "o", "        if($3 < uid_limit && $3 != 0) {\r\n\u001b[?2004l\r"]
[92.298711, "o", "\u001b[?2004h"]
[92.298727, "o", "> "]
[92.29903, "o", "            if(!system(\"grep -qx \\\"\"$1\"\\\" \\\"\"blacklist_file\"\\\"\")) {\r\n\u001b[?2004l\r"]
[92.299058, "o", "\u001b[?2004h"]
[92.299074, "o", "> "]
[92.299184, "o", "                print $1\r\n\u001b[?2004l\r"]
[92.299212, "o", "\u001b[?2004h"]
[92.299228, "o", "> "]
[92.299285, "o", "            }\r\n\u001b[?2004l\r"]
[92.299312, "o", "\u001b[?2004h"]
[92.299326, "o", "> "]
[92.299382, "o", "        }\r\n"]
[92.299399, "o", "\u001b[?2004l\r"]
[92.29942, "o", "\u001b[?2004h"]
[92.299437, "o", "> "]
[92.299605, "o", "    }' | sort > \"${output_file}\"\r\n\u001b[?2004l\r"]
[92.299643, "o", "\u001b[?2004h"]
[92.299666, "o", "> "]
[92.299687, "o", "    \r\n\u001b[?2004l\r"]
[92.299712, "o", "\u001b[?2004h"]
[92.299726, "o", "> "]
[92.299857, "o", "    echo \"${output_file}\"\r\n\u001b[?2004l\r"]
[92.299894, "o", "\u001b[?2004h> "]
[92.299924, "o", "}\r\n\u001b[?2004l\r"]
[92.29995, "o", "\u001b[?2004h"]
[92.300018, "o", "> \r\n\u001b[?2004l\r\u001b[?2004h> "]
[92.300097, "o", "# Generate reports\r\n\u001b[?2004l\r"]
[92.300121, "o", "\u001b[?2004h"]
[92.300143, "o", "> "]
[92.300232, "o", " generate_reports() {\r\n\u001b[?2004l\r"]
[92.300259, "o", "\u001b[?2004h"]
[92.300281, "o", "> "]
[92.3004, "o", "    local start_epoch=\"${1}\"\r\n\u001b[?2004l\r"]
[92.300424, "o", "\u001b[?2004h"]
[92.300447, "o", "> "]
[92.30056, "o", "    local end_epoch=\"${2}\"\r\n"]
[92.300581, "o", "\u001b[?2004l\r"]
[92.300601, "o", "\u001b[?2004h> "]
[92.300765, "o", "    local network_results=\"${3}\"\r\n\u001b[?2004l\r"]
[92.300786, "o", "\u001b[?2004h"]
[92.300807, "o", "> "]
[92.300945, "o", "    local user_results=\"${4}\"\r\n\u001b[?2004l\r"]
[92.300972, "o", "\u001b[?2004h"]
[92.301, "o", "> "]
[92.301029, "o", "    \r\n\u001b[?2004l\r"]
[92.301054, "o", "\u001b[?2004h"]
[92.301076, "o", "> "]
[92.301198, "o", "    # Calculate input hash\r\n"]
[92.301214, "o", "\u001b[?2004l\r"]
[92.30124, "o", "\u001b[?2004h"]
[92.301256, "o", "> "]
[92.301716, "o", "    local input_hash=\"$((cat \"${SAMPLE_DATA_DIR}/mock_netstat.txt\" \"${SAMPLE_DATA_DIR}/mock_passwd\" | \\\r\n\u001b[?2004l\r"]
[92.301755, "o", "\u001b[?2004h"]
[92.301788, "o", "> "]
[92.30192, "o", "        md5sum | cut -d' ' -f1))\"\r\n\u001b[?2004l\r"]
[92.30195, "o", "\u001b[?2004h"]
[92.301969, "o", "> "]
[92.302012, "o", "    \r\n\u001b[?2004l\r"]
[92.302031, "o", "\u001b[?2004h> "]
[92.302256, "o", "    # Generate YAML report (ISO-8859-1 encoded)\r\n\u001b[?2004l\r"]
[92.302283, "o", "\u001b[?2004h"]
[92.302304, "o", "> "]
[92.302574, "o", "    local yaml_file=\"${OUTPUT_DIR}/infra_security_report.yml\"\r\n\u001b[?2004l\r"]
[92.302603, "o", "\u001b[?2004h"]
[92.302622, "o", "> "]
[92.302641, "o", "    \r\n"]
[92.30266, "o", "\u001b[?2004l\r"]
[92.30268, "o", "\u001b[?2004h> "]
[92.302712, "o", "    {\r\n\u001b[?2004l\r"]
[92.302739, "o", "\u001b[?2004h"]
[92.302757, "o", "> "]
[92.302844, "o", "        echo \"---\"\r\n\u001b[?2004l\r"]
[92.302874, "o", "\u001b[?2004h"]
[92.302893, "o", "> "]
[92.303001, "o", "        echo \"meta:\" \r\n\u001b[?2004l\r"]
[92.303025, "o", "\u001b[?2004h"]
[92.303044, "o", "> "]
[92.303235, "o", "        echo \"  input_hash: ${input_hash}\"\r\n\u001b[?2004l\r"]
[92.303271, "o", "\u001b[?2004h"]
[92.303291, "o", "> "]
[92.303429, "o", "        echo \"insecure_users:\" \r\n"]
[92.30345, "o", "\u001b[?2004l\r"]
[92.303468, "o", "\u001b[?2004h"]
[92.303488, "o", "> "]
[92.303618, "o", "        while read -r user; do\r\n\u001b[?2004l\r"]
[92.303649, "o", "\u001b[?2004h"]
[92.303667, "o", "> "]
[92.303806, "o", "            echo \"  - ${user}\"\r\n\u001b[?2004l\r"]
[92.303835, "o", "\u001b[?2004h"]
[92.303854, "o", "> "]
[92.304008, "o", "        done < \"${user_results}\"\r\n\u001b[?2004l\r"]
[92.304037, "o", "\u001b[?2004h"]
[92.304056, "o", "> "]
[92.304177, "o", "        echo \"open_ports:\" \r\n"]
[92.304195, "o", "\u001b[?2004l\r"]
[92.304214, "o", "\u001b[?2004h"]
[92.304233, "o", "> "]
[92.304369, "o", "        while read -r line; do\r\n"]
[92.304391, "o", "\u001b[?2004l\r"]
[92.304412, "o", "\u001b[?2004h> "]
[92.304627, "o", "            port=\"$(echo \"${line}\" | cut -f1)\"\r\n\u001b[?2004l\r"]
[92.304655, "o", "\u001b[?2004h"]
[92.304675, "o", "> "]
[92.304902, "o", "            protocol=\"$(echo \"${line}\" | cut -f2)\"\r\n\u001b[?2004l\r"]
[92.30493, "o", "\u001b[?2004h"]
[92.30495, "o", "> "]
[92.305179, "o", "            process=\"$(echo \"${line}\" | cut -f3)\"\r\n\u001b[?2004l\r"]
[92.305214, "o", "\u001b[?2004h"]
[92.305233, "o", "> "]
[92.305394, "o", "            echo \"  - port: ${port}\"\r\n\u001b[?2004l\r"]
[92.305422, "o", "\u001b[?2004h"]
[92.30544, "o", "> "]
[92.305639, "o", "            echo \"    protocol: ${protocol}\"\r\n\u001b[?2004l\r"]
[92.305668, "o", "\u001b[?2004h"]
[92.305688, "o", "> "]
[92.305878, "o", "            echo \"    process: ${process}\"\r\n\u001b[?2004l\r"]
[92.305907, "o", "\u001b[?2004h"]
[92.305924, "o", "> "]
[92.306089, "o", "        done < \"${network_results}\"\r\n\u001b[?2004l\r"]
[92.306114, "o", "\u001b[?2004h"]
[92.306133, "o", "> "]
[92.306333, "o", "    } | iconv -t ISO-8859-1 > \"${yaml_file}\"\r\n\u001b[?2004l\r"]
[92.306362, "o", "\u001b[?2004h"]
[92.306381, "o", "> "]
[92.306408, "o", "    \r\n\u001b[?2004l\r"]
[92.306437, "o", "\u001b[?2004h"]
[92.306454, "o", "> "]
[92.306654, "o", "    # Generate CSV report (CRLF line endings)\r\n"]
[92.306676, "o", "\u001b[?2004l\r"]
[92.306696, "o", "\u001b[?2004h> "]
[92.306946, "o", "    local csv_file=\"${OUTPUT_DIR}/scan_exec_time.log\"\r\n\u001b[?2004l\r"]
[92.306983, "o", "\u001b[?2004h"]
[92.307009, "o", "> "]
[92.307251, "o", "    local duration=\"$((${end_epoch} - ${start_epoch}))\"\r\n\u001b[?2004l\r"]
[92.307281, "o", "\u001b[?2004h"]
[92.307298, "o", "> "]
[92.307551, "o", "    echo -e \"${start_epoch},${end_epoch},${duration}\" | \\\r\n\u001b[?2004l\r"]
[92.307575, "o", "\u001b[?2004h"]
[92.307593, "o", "> "]
[92.307763, "o", "        sed 's/$/\\r/' > \"${csv_file}\"\r\n\u001b[?2004l\r"]
[92.307792, "o", "\u001b[?2004h"]
[92.307812, "o", "> "]
[92.307835, "o", "}\r\n\u001b[?2004l\r"]
[92.307859, "o", "\u001b[?2004h"]
[92.307879, "o", "> \r\n"]
[92.307899, "o", "\u001b[?2004l\r"]
[92.307921, "o", "\u001b[?2004h> "]
[92.308046, "o", "# Main script execution\r\n"]
[92.308065, "o", "\u001b[?2004l\r"]
[92.308086, "o", "\u001b[?2004h> "]
[92.308211, "o", " start_epoch=$$(date +%s)\r\n\u001b[?2004l\r"]
[92.308241, "o", "\u001b[?2004h"]
[92.30826, "o", "> \r\n\u001b[?2004l\r"]
[92.308285, "o", "\u001b[?2004h"]
[92.308303, "o", "> "]
[92.308407, "o", "# Run jobs in parallel\r\n\u001b[?2004l\r"]
[92.308436, "o", "\u001b[?2004h"]
[92.308456, "o", "> "]
[92.308623, "o", " network_output=$$(analyze_network &)\r\n\u001b[?2004l\r"]
[92.308652, "o", "\u001b[?2004h"]
[92.308669, "o", "> "]
[92.308814, "o", " user_output=$$(analyze_users &)\r\n\u001b[?2004l\r"]
[92.308838, "o", "\u001b[?2004h"]
[92.308855, "o", "> \r\n\u001b[?2004l\r"]
[92.308888, "o", "\u001b[?2004h"]
[92.308907, "o", "> "]
[92.30909, "o", "# Wait for background jobs to complete\r\n\u001b[?2004l\r"]
[92.309118, "o", "\u001b[?2004h"]
[92.309137, "o", "> "]
[92.309164, "o", " wait\r\n"]
[92.309182, "o", "\u001b[?2004l\r"]
[92.3092, "o", "\u001b[?2004h"]
[92.309219, "o", "> \r\n\u001b[?2004l\r"]
[92.309238, "o", "\u001b[?2004h"]
[92.309256, "o", "> "]
[92.309363, "o", " end_epoch=$$(date +%s)\r\n"]
[92.309383, "o", "\u001b[?2004l\r"]
[92.309402, "o", "\u001b[?2004h"]
[92.30942, "o", "> \r\n\u001b[?2004l\r"]
[92.309439, "o", "\u001b[?2004h"]
[92.309458, "o", "> "]
[92.309568, "o", "# Generate final reports\r\n\u001b[?2004l\r"]
[92.309592, "o", "\u001b[?2004h"]
[92.30961, "o", "> "]
[92.309997, "o", " generate_reports \"${start_epoch}\" \"${end_epoch}\" \"${network_output}\" \"${user_output}\"\r\n"]
[92.310018, "o", "\u001b[?2004l\r"]
[92.310035, "o", "\u001b[?2004h"]
[92.310053, "o", "> \r\n\u001b[?2004l\r"]
[92.310073, "o", "\u001b[?2004h"]
[92.310091, "o", "> "]
[92.310221, "o", "# Set executable permission\r\n\u001b[?2004l\r"]
[92.310251, "o", "\u001b[?2004h"]
[92.310271, "o", "> "]
[92.310488, "o", " chmod +x \"${OUTPUT_DIR}/run_security_scan.sh\"\r\n\u001b[?2004l\r"]
[92.310517, "o", "\u001b[?2004h"]
[92.310535, "o", "> \r\n"]
[92.310554, "o", "\u001b[?2004l\r"]
[92.310571, "o", "\u001b[?2004h"]
[92.342489, "o", "> echo \"Security scan completed successfully\"\r\n\u001b[?2004l\r\u001b[?2004h> EOF"]
[101.924125, "i", "/home/user/reports/run_security_scan.sh\n"]
[101.924364, "o", "/home/user/reports/run_security_scan.sh\r\n"]
[101.924401, "o", "\u001b[?2004l\r"]
[101.924427, "o", "\u001b[?2004h"]
[101.924448, "o", "> "]
[103.864606, "i", "ls -la /home/user/reports/\n"]
[103.864729, "o", "ls -la /home/user/reports/\r\n\u001b[?2004l\r"]
[103.864779, "o", "\u001b[?2004h> "]
[103.96075, "i", "file /home/user/reports/infra_security_report.yml\n"]
[103.96093, "o", "file /home/user/reports/infra_security_report.yml\r\n\u001b[?2004l\r"]
[103.961013, "o", "\u001b[?2004h> "]
[104.105908, "i", "file /home/user/reports/scan_exec_time.log\n"]
[104.106193, "o", "file /home/user/reports/scan_exec_time.log\r\n\u001b[?2004l\r"]
[104.10625, "o", "\u001b[?2004h> "]
[104.233137, "i", "cat /home/user/reports/infra_security_report.yml\n"]
[104.233491, "o", "cat /home/user/reports/infra_security_report.yml\r\n\u001b[?2004l\r"]
[104.233598, "o", "\u001b[?2004h> "]
[104.724432, "i", "cat /home/user/reports/scan_exec_time.log\n"]
[104.724598, "o", "cat /home/user/reports/scan_exec_time.log\r\n\u001b[?2004l\r"]
[104.724636, "o", "\u001b[?2004h> "]
[110.533804, "i", "ls -la /home/user/reports/\n"]
[110.53405, "o", "ls -la /home/user/reports/\r\n"]
[110.534117, "o", "\u001b[?2004l\r\u001b[?2004h> "]
[110.609029, "i", "head -5 /home/user/reports/infra_security_report.yml\n"]
[110.609452, "o", "head -5 /home/user/reports/infra_security_report.yml\r\n\u001b[?2004l\r"]
[110.609522, "o", "\u001b[?2004h"]
[110.609567, "o", "> "]
[110.72689, "i", "head -1 /home/user/reports/scan_exec_time.log\n"]
[110.727089, "o", "head -1 /home/user/reports/scan_exec_time.log\r\n\u001b[?2004l\r"]
[110.727121, "o", "\u001b[?2004h> "]
[110.83465, "i", "wc -l /home/user/reports/*\n"]
[110.834826, "o", "wc -l /home/user/reports/*\r\n"]
[110.834855, "o", "\u001b[?2004l\r"]
[110.834897, "o", "\u001b[?2004h"]
[110.834925, "o", "> "]
[116.437565, "i", "pwd\n"]
[116.437729, "o", "pwd\r\n\u001b[?2004l\r\u001b[?2004h> "]
[116.61034, "i", "ls -la /home/user/reports/\n"]
[116.610467, "o", "ls -la /home/user/reports/\r\n\u001b[?2004l\r"]
[116.610517, "o", "\u001b[?2004h> "]
[116.733567, "i", "ls -la /home/user/sample_data/\n"]
[116.733696, "o", "ls -la /home/user/sample_data/\r\n\u001b[?2004l\r"]
[116.73373, "o", "\u001b[?2004h"]
[116.733751, "o", "> "]
[116.809832, "i", "ls -la /home/user/config/\n"]
[116.809947, "o", "ls -la /home/user/config/\r\n\u001b[?2004l\r"]
[116.809991, "o", "\u001b[?2004h"]
[116.810011, "o", "> "]
[122.468549, "i", "clear\n"]
[122.468666, "o", "clear\r\n\u001b[?2004l\r"]
[122.468725, "o", "\u001b[?2004h"]
[122.468756, "o", "> "]
[122.551346, "i", "ls -la /home/user/\n"]
[122.551442, "o", "ls -la /home/user/\r\n\u001b[?2004l\r"]
[122.551468, "o", "\u001b[?2004h"]
[122.551486, "o", "> "]
[122.655381, "i", "find /home/user -type f -name '*.sh' -o -name '*.txt' -o -name '*.csv' -o -name '*.yml' -o -name '*.log'\n"]
[122.655706, "o", "find /home/user -type f -name '*.sh' -o -name '*.txt' -o -name '*.csv' -o -name '*.yml' -o -name '*.log'\r\n\u001b[?2004l\r"]
[122.655744, "o", "\u001b[?2004h> "]
[127.170514, "i", "exit\n"]
[127.170635, "o", "exit\r\n\u001b[?2004l\r\u001b[?2004h> "]
[127.271482, "i", "bash\n"]
[127.271659, "o", "bash\r\n\u001b[?2004l\r\u001b[?2004h> "]
[127.377736, "i", "cd /home/user\n"]
[127.377836, "o", "cd /home/user\r\n\u001b[?2004l\r"]
[127.377887, "o", "\u001b[?2004h> "]
[127.510885, "i", "ls -la\n"]
[127.510995, "o", "ls -la\r\n\u001b[?2004l\r"]
[127.511032, "o", "\u001b[?2004h"]
[127.511061, "o", "> "]
[132.073736, "i", "whoami\n"]
[132.073847, "o", "whoami\r\n\u001b[?2004l\r\u001b[?2004h> "]
[132.227754, "i", "df -h\n"]
[132.227846, "o", "df -h\r\n\u001b[?2004l\r"]
[132.22788, "o", "\u001b[?2004h> "]
[132.7673, "i", "test -d /home/user && echo \"Directory exists\" || echo \"Directory missing\"\n"]
[132.767559, "o", "test -d /home/user && echo \"Directory exists\" || echo \"Directory missing\"\r\n\u001b[?2004l\r"]
[132.767598, "o", "\u001b[?2004h> "]
[137.243569, "i", "echo \"Testing terminal output\"\n"]
[137.243715, "o", "echo \"Testing terminal output\"\r\n\u001b[?2004l\r"]
[137.24375, "o", "\u001b[?2004h> "]
[137.360353, "i", "hostname\n"]
[137.360469, "o", "hostname\r\n\u001b[?2004l\r"]
[137.360519, "o", "\u001b[?2004h> "]
[137.554924, "i", "uname -a\n"]
[137.555103, "o", "uname -a\r\n\u001b[?2004l\r"]
[137.555169, "o", "\u001b[?2004h"]
[137.555191, "o", "> "]
