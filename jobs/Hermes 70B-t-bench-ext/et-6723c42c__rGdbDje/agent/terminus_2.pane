[?2004hroot@a5b0d1ba-cddc-434e-8844-55181941b3d9:~# asciinema rec --stdin /logs/agent/recording.cast
[?2004l[0;32masciinema: recording asciicast to /logs/agent/recording.cast[0m
[0;32masciinema: press <ctrl-d> or type "exit" when you're done[0m
[?2004hroot@a5b0d1ba-cddc-434e-8844-55181941b3d9:~# clear
[?2004l[H[J[?2004hroot@a5b0d1ba-cddc-434e-8844-55181941b3d9:~# cd /home/user/app
[?2004l[?2004hroot@a5b0d1ba-cddc-434e-8844-55181941b3d9:/home/user/app# grep -E '^current_badge_id' config/system_settings.conf | awk -F'=' '{print $2}' | tr -d ' '\n'
[?2004l[?2004h> C-c
[?2004l[?2004h> grep -m1 'current_badge_id' config/system_settings.conf | awk -F= '{print $2}' | xargs
[?2004l[?2004h> C-c
[?2004l[?2004h> sed -n 's/^current_badge_id\s*//p' config/system_settings.conf | tr -d ' '\n'
[?2004ltr: extra operand â€˜} | xargs\nC-c\nsed -n s/^current_badge_ids*//p config/system_settings.conf | tr -d â€™
Try 'tr --help' for more information.
[?2004hroot@a5b0d1ba-cddc-434e-8844-55181941b3d9:/home/user/app# badge_id=$(grep -E '^current_badge_id' config/system_settings.conf | awk -F= '{print $2}' | tr -d ' \n'); echo "$badge_id"
[?2004lOMEGA-99-XRAY
[?2004hroot@a5b0d1ba-cddc-434e-8844-55181941b3d9:/home/user/app# mkdir -p /home/user/diag/stage
[?2004l[?2004hroot@a5b0d1ba-cddc-434e-8844-55181941b3d9:/home/user/app# cd /home/user/diag/stage
[?2004l[?2004hroot@a5b0d1ba-cddc-434e-8844-55181941b3d9:/home/user/diag/stage# find /home/user/app/logs -type f \( -not -path "*/test/*" -and -not -path "*/mock/*" -and -not -path "*/staging/*" \) -print0 > ../filelist.txt
[?2004l[?2004hroot@a5b0d1ba-cddc-434e-8844-55181941b3d9:/home/user/diag/stage# while IFS= read -r -d '' file; do
[?2004l[?2004h>   if [ ! -f "$file" ]; then continue; fi
[?2004l[?2004h>   size=$(stat -c%s "$file")
[?2004l[?2004h>   if [ "$size" -le 512 ]; then continue; fi
[?2004l[?2004h>   if [ $(find "$file" -mtime -7 -printf p) ]; then
[?2004l[?2004h>     if grep -q \[SECURITY-AUDIT-FAIL\] "$file" 2>/dev/null; then
[?2004l[?2004h>       rel_path="${file#/home/user/app/logs/}"
[?2004l[?2004h>       mkdir -p "$(dirname "$rel_path")"
[?2004l[?2004h>       cp -a "$file" "$rel_path"
[?2004l[?2004h>       echo "$rel_path" >> ../found_files.txt
[?2004l[?2004h>     fi
[?2004l[?2004h>   fi
[?2004l[?2004h> done < <(cat ../filelist.txt)
[?2004l[?2004hroot@a5b0d1ba-cddc-434e-8844-55181941b3d9:/home/user/diag/stage# if [ -f "../found_files.txt" ] && [ -s "../found_files.txt" ]; then
[?2004l[?2004h>   tar -czf ../forensic_bundle.tar.gz -T ../found_files.txt -C /home/user/diag/stage
[?2004l[?2004h>   echo "Archive created successfully"
[?2004l[?2004h> else
[?2004l[?2004h>   echo "No qualifying files found"
[?2004l[?2004h> fi
[?2004lNo qualifying files found
[?2004hroot@a5b0d1ba-cddc-434e-8844-55181941b3d9:/home/user/diag/stage# echo '[]' | tee /home/user/diag/custody_manifest.json
[?2004l[]
[?2004hroot@a5b0d1ba-cddc-434e-8844-55181941b3d9:/home/user/diag/stage# rm -rf /home/user/diag/stage ../filelist.txt ../found_files.txt 2>/dev/null
[?2004l[?2004hroot@a5b0d1ba-cddc-434e-8844-55181941b3d9:/home/user/diag/stage# ls -la /home/user/diag/
[?2004ltotal 4
drwxr-xr-x 1 root root 43 Feb 13 18:58 [0m[01;34m.[0m
drwxr-xr-x 1 root root 26 Feb 13 18:50 [01;34m..[0m
-rw-r--r-- 1 root root  3 Feb 13 18:58 custody_manifest.json
[?2004hroot@a5b0d1ba-cddc-434e-8844-55181941b3d9:/home/user/diag/stage# 