[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# asciinema rec --stdin /logs/agent/recording.cast
[?2004lasciinema needs an ASCII or UTF-8 character encoding to run. Check the output of `locale` command.
[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# clear
[?2004l[H[J[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# export AUDIT_LOCATION=/home/user/audit
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# mkdir -p "$AUDIT_LOCATION"
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# if [ -f "$AUDIT_LOCATION/benchmark_audit.log" ]; then mv "$AUDIT_LOCATION/benchmark_audit.log" "$AUDIT_LOCATION/bencchmark_audit.log.old"; fi
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# ls -la "$AUDIT_LOCATION"
[?2004ltotal 0
drwxr-xr-x 2 root root 10 Feb 13 18:51 [0m[01;34m.[0m
drwxrwxrwx 1 root root 27 Feb 13 18:51 [34;42m..[0m
[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ')|CPU_CORES|$(nproc)|count|nproc" >> "$AUDIT_LOCATION/benchmark_audit.log"
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# total_mem_mib=$(free -m | awk 'NR==2{print $2}')
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ')|MEM_TOTAL_MIB|${total_mem_mib}|MiB|free -m" >> "$AUDIT_LOCATION/benchmark_auddit.log"
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# dd if=/dev/zero of=/tmp/disktest bs=1M count=1024 oflag=dsync 2>&1 | grep 'bytes\|Bytes' | awk -F', ' '{print $1}' || awk '{print $(NF-1)}'
[?2004l(1.1
[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# disk_write_speed=$(dd if=/dev/zero of=/tmp/disktest bs=1M count=1024 oflag=dsync 2>&1 | grep 'bytes\|Bytes' | awk -FF', ' '{print $1}' | awk '{print $(NF-1)}')
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ')|DISK_WRITE_MIBPS|${disk_write_speed}|MiB/s|dd if=/dev/zero of=/tmp/disktest bbs=1M count=1024 oflag=dsync" >> "$AUDIT_LOCATION/benchmark_audit.log"
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# rm /tmp/disktest
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# ping_output=$(ping -c 5 8.8.8.8 2>&1)
[?2004lmin_time=$(echo "$ping_output" | awk 'NR>1 && NR<=6 {print $7}' | sed 's/time=//g' | sort -n | head -n 1)
max_time=$(echo "$ping_output" | awk 'NR>1 && NR<=6 {print $7}' | sed 's/time=//g' | sort -n | tail -n 1)
all_times=$(echo "$ping_output" | awk 'NR>1 && NR<=6 {print $7}' | sed 's/time=//g' | tr '\n' ' ')
sorted_times=$(echo "$all_times" | tr ' ' '\n' | sort -n | tr '\n' ' ')
median_latency=$(echo "$sorted_times" | awk -F' ' '{print $(NF/2+1)}')
network_jitter=$(echo "${max_time} - ${min_time}" | bc)
echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ')|NET_LATENCY_MS|${median_latency}|ms|ping -c 5 8.8.8.8" >> "$AUDIT_LOCATION/benchmark_audit.log"
echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ')|NET_JITTER_MS|${network_jitter}|ms|ping -c 5 8.8.8.8" >> "$AUDIT_LOCATION/benchmark_audit.log"
log_content=$(cat "$AUDIT_LOCATION/benchmark_audit.log")
first_timestamp=$(echo "$log_content" | head -n 1 | cut -d'|' -f1)
last_timestamp=$(echo "$log_content" | tail -n 1 | cut -d'|' -f1)
first_epoch=$(date -u -d "$first_timestamp" +%s)
last_epoch=$(date -u -d "$last_timestamp" +%s)
benchmark_duration=$(echo "scale=3; ($last_epoch - $first_epoch)" | bc | awk '{printf "%.3f", $1}')
mem_total_mib=$(echo "$log_content" | awk -F'|' '$2 == "MEM_TOTAL_MIB" {print $3}')
total_memory_bytes=$(echo "${mem_total_mib} * 1048576" | bc)
cpu_core_count=$(echo "$log_content" | awk -F'|' '$2 == "CPU_CORES" {print $3}')
disk_write_mib_per_sec=$(echo "$log_content" | awk -F'|' '$2 == "DISK_WRITE_MIBPS" {print $3}')
network_latency_ms=$(echo "$log_content" | awk -F'|' '$2 == "NET_LATENCY_MS" {print $3}')
network_jitter_ms=$(echo "$log_content" | awk -F'|' '$2 == "NET_JITTER_MS" {print $3}')
[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# min_time=$(echo "$ping_output" | awk 'NR>1 && NR<=6 {print $7}' | sed 's/time=//g' | sort -n | head -n 1)
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# max_time=$(echo "$ping_output" | awk 'NR>1 && NR<=6 {print $7}' | sed 's/time=//g' | sort -n | tail -n 1)
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# all_times=$(echo "$ping_output" | awk 'NR>1 && NR<=6 {print $7}' | sed 's/time=//g' | tr '\n' ' ')
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# sorted_times=$(echo "$all_times" | tr ' ' '\n' | sort -n | tr '\n' ' ')
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# median_latency=$(echo "$sorted_times" | awk -F' ' '{print $(NF/2+1)}')
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# network_jitter=$(echo "${max_time} - ${min_time}" | bc)
[?2004lbash: bc: command not found
[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ')|NET_LATENCY_MS|${median_latency}|ms|ping -c 5 8.8.8.8" >> "$AUDIT_LOCATION/beenchmark_audit.log"
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ')|NET_JITTER_MS|${network_jitter}|ms|ping -c 5 8.8.8.8" >> "$AUDIT_LOCATION/bennchmark_audit.log"
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# log_content=$(cat "$AUDIT_LOCATION/benchmark_audit.log")
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# first_timestamp=$(echo "$log_content" | head -n 1 | cut -d'|' -f1)
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# last_timestamp=$(echo "$log_content" | tail -n 1 | cut -d'|' -f1)
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# first_epoch=$(date -u -d "$first_timestamp" +%s)
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# last_epoch=$(date -u -d "$last_timestamp" +%s)
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# benchmark_duration=$(echo "scale=3; ($last_epoch - $first_epoch)" | bc | awk '{printf "%.3f", $1}')
[?2004lbash: bc: command not found
[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# mem_total_mib=$(echo "$log_content" | awk -F'|' '$2 == "MEM_TOTAL_MIB" {print $3}')
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# total_memory_bytes=$(echo "${mem_total_mib} * 1048576" | bc)
[?2004lbash: bc: command not found
[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# cpu_core_count=$(echo "$log_content" | awk -F'|' '$2 == "CPU_CORES" {print $3}')
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# disk_write_mib_per_sec=$(echo "$log_content" | awk -F'|' '$2 == "DISK_WRITE_MIBPS" {print $3}')
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# network_latency_ms=$(echo "$log_content" | awk -F'|' '$2 == "NET_LATENCY_MS" {print $3}')
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# network_jitter_ms=$(echo "$log_content" | awk -F'|' '$2 == "NET_JITTER_MS" {print $3}')
[?2004lsummary_timestamp=$(date -u +'%Y-%m-%dT%H:%M:%SZ')
[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# summary_timestamp=$(date -u +'%Y-%m-%dT%H:%M:%SZ')
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# cat > "$AUDIT_LOCATION/benchmark_summary.json" << EOF
[?2004l[?2004h> {
[?2004l[?2004h>   "cpu_core_count": ${cpu_core_count},
[?2004l[?2004h>   "total_memory_bytes": ${total_memory_bytes},
[?2004l[?2004h>   "disk_write_mib_per_sec": ${disk_write_mib_per_sec},
[?2004l[?2004h>   "network_latency_ms": ${network_latency_ms},
[?2004l[?2004h>   "network_jitter_ms": ${network_jitter_ms},
[?2004l[?2004h>   "benchmark_duration_seconds": ${benchmark_duration},
[?2004l[?2004h>   "timestamp": "${summary_timestamp}"
[?2004l[?2004h> }
[?2004l[?2004h> EOF
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# ls -la "$AUDIT_LOCATION"
[?2004ltotal 8
drwxr-xr-x 2 root root  75 Feb 13 18:51 [0m[01;34m.[0m
drwxrwxrwx 1 root root  27 Feb 13 18:51 [34;42m..[0m
-rw-r--r-- 1 root root 331 Feb 13 18:51 benchmark_audit.log
-rw-r--r-- 1 root root 216 Feb 13 18:51 benchmark_summary.json
[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# cat "$AUDIT_LOCATION/benchmark_audit.log"
[?2004l2026-02-13T18:51:41Z|CPU_CORES|48|count|nproc
2026-02-13T18:51:41Z|MEM_TOTAL_MIB|386466|MiB|free -m
2026-02-13T18:51:43Z|DISK_WRITE_MIBPS|(1.1|MiB/s|dd if=/dev/zero of=/tmp/disktest bs=1M count=1024 oflag=dsync
2026-02-13T18:51:48Z|NET_LATENCY_MS|0.497|ms|ping -c 5 8.8.8.8
2026-02-13T18:51:48Z|NET_JITTER_MS||ms|ping -c 5 8.8.8.8
[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# echo "=== Summary JSON ==="
[?2004l=== Summary JSON ===
[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# cat "$AUDIT_LOCATION/benchmark_summary.json"
[?2004l{
  "cpu_core_count": 48,
  "total_memory_bytes": ,
  "disk_write_mib_per_sec": (1.1,
  "network_latency_ms": 0.497,
  "network_jitter_ms": ,
  "benchmark_duration_seconds": ,
  "timestamp": "2026-02-13T18:51:48Z"
}
[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# rm -f "$AUDIT_LOCATION/benchmark_audit.log" "$AUDIT_LOCATION/benchmark_summary.json"export AUDIT_LOCATION=/home/userr/audit
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# mkdir -p "$AUDIT_LOCATION"
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# if [ -f "$AUDIT_LOCATION/benchmark_audit.log" ]; then mv "$AUDIT_LOCATION/benchmark_audit.log" "$AUDIT_LOCATION/bencchmark_audit.log.old"; fi
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ')|CPU_CORES|$(nproc)|count|nproc" >> "$AUDIT_LOCATION/benchmark_audit.log"
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# total_mem_mib=$(free -m | awk 'NR==2{print $2}')
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ')|MEM_TOTAL_MIB|${total_mem_mib}|MiB|free -m" >> "$AUDIT_LOCATION/benchmark_auddit.log"
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# disk_write_speed=$(dd if=/dev/zero of=/tmp/disktest bs=1M count=1024 oflag=dsync 2>&1 | tail -n 1 | awk '{print $8}'' | sed 's/[^0-9.]//g')
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ')|DISK_WRITE_MIBPS|${disk_write_speed}|MiB/s|dd if=/dev/zero of=/tmp/disktest bbs=1M count=1024 oflag=dsync" >> "$AUDIT_LOCATION/benchmark_audit.log"
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# rm /tmp/disktest
[?2004l[?2004hroot@4a14b452-893b-4492-98aa-d59f4baad136:~# ping_output=$(ping -c 5 8.8.8.8 2>&1 || echo "PING_FAILED")
[?2004lmin_time="failed"; max_time="failed"; median_latency="failed"; network_jitter="failed"
if [[ "$ping_output" != "PING_FAILED" ]]; then
  min_time=$(echo "$ping_output" | awk 'NR>1 && NR<=6 {print $7}' | sed 's/time=//g' | sort -n | head -n 1)
  max_time=$(echo "$ping_output" | awk 'NR>1 && NR<=6 {print $7}' | sed 's/time=//g' | sort -n | tail -n 1)
  if [[ -n "$min_time" && -n "$max_time" ]]; then
    all_times=$(echo "$ping_output" | awk 'NR>1 && NR<=6 {print $7}' | sed 's/time=//g' | tr '\n' ' ')
    sorted_times=$(echo "$all_times" | tr ' ' '\n' | sort -n | tr '\n' ' ')
    median_latency=$(echo "$sorted_times" | awk -F' ' '{print $(NF/2+1)}')
    if [[ -n "$min_time" && -n "$max_time" && $(echo "$min_time < $max_time" | bc -l 2>/dev/null) == 1 ]]; then
      network_jitter=$(echo "$max_time - $min_time" | bc -l 2>/dev/null || echo "failed")
    fi
  fi
fi
echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ')|NET_LATENCY_MS|${median_latency}|ms|ping -c 5 8.8.8.8" >> "$AUDIT_LOCATION/benchmark_audit.log"
echo "$(date -u +'%Y-%m-%dT%H:%M:%SZ')|NET_JITTER_MS|${network_jitter}|ms|ping -c 5 8.8.8.8" >> "$AUDIT_LOCATION/benchmark_audit.log"
log_content=$(cat "$AUDIT_LOCATION/benchmark_audit.log")
first_timestamp=$(echo "$log_content" | head -n 1 | cut -d'|' -f1)
last_timestamp=$(echo "$log_content" | tail -n 1 | cut -d'|' -f1)
first_epoch=$(date -u -d "$first_timestamp" +%s 2>/dev/null || echo 0)
last_epoch=$(date -u -d "$last_timestamp" +%s 2>/dev/null || echo 0)
benchmark_duration_seconds="failed"
if [[ "$first_epoch" != "0" && "$last_epoch" != "0" ]]; then
  duration_float=$(echo "scale=3; ($last_epoch - $first_epoch)" | bc -l 2>/dev/null || echo "failed")
  if [[ "$duration_float" != "failed" ]]; then benchmark_duration_seconds=$(printf "%.3f" "$duration_float"); fi
fi
mem_total_mib=$(echo "$log_content" | awk -F'|' '$2 == "MEM_TOTAL_MIB" {print $3}')
total_memory_bytes="failed"
if [[ -n "$mem_total_mib" && "$mem_total_mib" =~ ^[0-9]+$ ]]; then
  total_memory_bytes=$(($mem_total_mib * 1048576))
fi
cpu_core_count=$(echo "$log_content" | awk -F'|' '$2 == "CPU_CORES" {print $3}')
disk_write_mib_per_sec=$(echo "$log_content" | awk -F'|' '$2 == "DISK_WRITE_MIBPS" {print $3}')
network_latency_ms=$(echo "$log_content" | awk -F'|' '$2 == "NET_LATENCY_MS" {print $3}')
network_jitter_ms=$(echo "$log_content" | awk -F'|' '$2 == "NET_JITTER_MS" {print $3}')
summary_timestamp=$(date -u +'%Y-%m-%dT%H:%M:%SZ')
cat > "$AUDIT_LOCATION/benchmark_summary.json" << EOF
{
  "cpu_core_count": ${cpu_core_count:-0},
  "total_memory_bytes": ${total_memory_bytes:-0},
  "disk_write_mib_per_sec": ${disk_write_mib_per_sec:-0.0},
  "network_latency_ms": ${network_latency_ms:-0.0},
  "network_jitter_ms": ${network_jitter_ms:-0.0},
  "benchmark_duration_seconds": "${benchmark_duration_seconds}",
  "timestamp": "${summary_timestamp}"
}
EOF
ls -la "$AUDIT_LOCATION"
cat "$AUDIT_LOCATION/benchmark_audit.log"
echo "=== Summary JSON ==="
cat "$AUDIT_LOCATION/benchmark_summary.json"
