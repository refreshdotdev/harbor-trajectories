Hit:1 http://security.ubuntu.com/ubuntu jammy-security InRelease
Hit:2 http://archive.ubuntu.com/ubuntu jammy InRelease
Hit:3 http://archive.ubuntu.com/ubuntu jammy-updates InRelease
Hit:4 http://archive.ubuntu.com/ubuntu jammy-backports InRelease
Reading package lists...
Reading package lists...
Building dependency tree...
Reading state information...
curl is already the newest version (7.81.0-1ubuntu1.21).
0 upgraded, 0 newly installed, 0 to remove and 4 not upgraded.
downloading uv 0.9.5 x86_64-unknown-linux-gnu
no checksums to verify
installing to /root/.local/bin
  uv
  uvx
everything's installed!

To add $HOME/.local/bin to your PATH, either restart your shell or run:

    source $HOME/.local/bin/env (sh, bash, zsh)
    source $HOME/.local/bin/env.fish (fish)
Downloading cpython-3.12.12-linux-x86_64-gnu (download) (31.1MiB)
 Downloading cpython-3.12.12-linux-x86_64-gnu (download)
Downloading pygments (1.2MiB)
 Downloading pygments
Installed 6 packages in 14ms
============================= test session starts ==============================
platform linux -- Python 3.12.12, pytest-8.4.1, pluggy-1.6.0 -- /root/.cache/uv/archive-v0/au6X26qeL3wnJE6PMPXHE/bin/python
cachedir: .pytest_cache
rootdir: /tests
plugins: order-1.3.0
collecting ... collected 4 items

../../tests/test_final_state.py::test_files_exist PASSED                 [ 25%]
../../tests/test_final_state.py::test_report_encoding_and_line_endings PASSED [ 50%]
../../tests/test_final_state.py::test_report_content_logic FAILED        [ 75%]
../../tests/test_final_state.py::test_manifest_structure FAILED          [100%]

=================================== FAILURES ===================================
__________________________ test_report_content_logic ___________________________

    @pytest.mark.order(3)
    def test_report_content_logic():
        # Read with strict CRLF handling
        with REPORT_FILE.open("r", encoding="iso-8859-1", newline="\r\n") as f:
            lines = [l.strip() for l in f.readlines()]
    
>       assert len(lines) == 5, f"Expected 5 lines (1 header + 4 logs), found {len(lines)}"
E       AssertionError: Expected 5 lines (1 header + 4 logs), found 3
E       assert 3 == 5
E        +  where 3 = len(['05004bfe20c15397fdc5ca74bbc5ed10\r[04/10/2023 23:55:00] INFO Backup completed', '[01/11/2023 08:30:00] ERROR Connection timeout to 10.0.0.5', '[02/11/2023 09:15:00] WARN System resource low'])

/tests/test_final_state.py:68: AssertionError
___________________________ test_manifest_structure ____________________________

    @pytest.mark.order(4)
    def test_manifest_structure():
        with MANIFEST_FILE.open("r", encoding="utf-8") as f:
            data = json.load(f)
    
        assert "processed_date" in data
>       assert data["total_lines_reported"] == 4
E       assert 3 == 4

/tests/test_final_state.py:86: AssertionError
=========================== short test summary info ============================
FAILED ../../tests/test_final_state.py::test_report_content_logic - Assertion...
FAILED ../../tests/test_final_state.py::test_manifest_structure - assert 3 == 4
========================= 2 failed, 2 passed in 0.04s ==========================
