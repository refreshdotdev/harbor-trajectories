{"version": 2, "width": 160, "height": 40, "timestamp": 1771009563, "env": {"SHELL": "/bin/bash", "TERM": "screen"}}
[0.005585, "o", "\u001b[?2004hroot@f20579cc-b850-49ba-a4ff-8d22f3d01ed2:~# "]
[0.994576, "i", "clear\r"]
[0.994783, "o", "clear\r\n\u001b[?2004l\r"]
[0.996693, "o", "\u001b[H\u001b[J"]
[0.997008, "o", "\u001b[?2004h"]
[0.997077, "o", "root@f20579cc-b850-49ba-a4ff-8d22f3d01ed2:~# "]
[28.311604, "i", "grep -E \"^\\s*(ROOT_DIR|REPORT_PATH)\\s*=\\s*\\S+\" /etc/oldguard/scanner.ini | sed -E 's/\\s*ROOT_DIR\\s*=\\s*(.+)/export ROOT_DIR=\\\"\\1\\\"/p; s/\\s*REPORT_PATH\\s*=\\s*(.+)/export REPORT_PATH=\\\"\\1\\\"/p; d'"]
[28.312133, "o", "grep -E \"^\\s*(ROOT_DIR|REPORT_PATH)\\s*=\\s*\\S+\" /etc/oldguard/scanner.ini | sed -E 's/\\s*ROOT_DIR\\s*=\\s*(.+)/export ROOT_DIR=\\\"\\1\\\"/p; s/\\s*REPORT_PATH\\s*=\\s*(.+)/export REPORT_PATH=\\\"\\1\\\"/p; d'"]
[28.562388, "i", "if [ -n \"$ROOT_DIR\" ] && [ -n \"$REPORT_PATH\" ]; then echo \"Configuration read: ROOT_DIR='$ROOT_DIR', REPORT_PATH='$REPORT_PATH'\"; else echo \"ERROR: Could not read ROOT_DIR or REPORT_PATH from /etc/oldguard/scanner.ini\"; exit 1; fi"]
[28.56302, "o", "if [ -n \"$ROOT_DIR\" ] && [ -n \"$REPORT_PATH\" ]; then echo \"Configuration read: ROOT_DIR='$ROOT_DIR', REPORT_PATH='$REPORT_PATH'\"; else echo \"ERROR: Could not read ROOT_DIR or REPORT_PATH from /etc/oldguard/scanner.ini\"; exit 1; fi"]
[28.769204, "i", "if [ -d \"$ROOT_DIR\" ]; then echo \"ROOT_DIR '$ROOT_DIR' exists and is a directory.\"; else echo \"ERROR: ROOT_DIR '$ROOT_DIR' is not a valid directory.\"; exit 1; fi"]
[28.770311, "o", "if [ -d \"$ROOT_DIR\" ]; then echo \"ROOT_DIR '$ROOT_DIR' exists and is a directory.\"; else echo \"ERROR: ROOT_DIR '$ROOT_DIR' is not a valid directory.\"; exit 1; fi"]
[29.202505, "i", "REPORT_DIR=$(dirname \"$REPORT_PATH\") && mkdir -p \"$REPORT_DIR\" && echo \"Ensured parent directory for REPORT_PATH exists: $REPORT_DIR\""]
[29.202893, "o", "REPORT_DIR=$(dirname \"$REPORT_PATH\") && mkdir -p \"$REPORT_DIR\" && echo \"Ensured parent directory for REPORT_PATH exists: $REPORT_DIR\""]
[29.481922, "i", "TMP_REPORT_FILE=$(mktemp /tmp/oldguard_report_XXXXXX) && echo \"Using temporary file for report assembly: $TMP_REPORT_FILE\""]
[29.482292, "o", "TMP_REPORT_FILE=$(mktemp /tmp/oldguard_report_XXXXXX) && echo \"Using temporary file for report assembly: $TMP_REPORT_FILE\""]
[29.722076, "i", "echo \"SCAN_ID: $BUILD_ID\" > \"$TMP_REPORT_FILE\""]
[29.722257, "o", "echo \"SCAN_ID: $BUILD_ID\" > \"$TMP_REPORT_FILE\""]
[30.011172, "i", "echo \"\" >> \"$TMP_REPORT_FILE\""]
[30.011375, "o", "echo \"\" >> \"$TMP_REPORT_FILE\""]
[58.78461, "i", "echo \"BUILD_ID: '$BUILD_ID'\""]
[58.784817, "o", "echo \"BUILD_ID: '$BUILD_ID'\""]
[59.230908, "i", "cat /etc/oldguard/scanner.ini"]
[59.231179, "o", "cat /etc/oldguard/scanner.ini"]
[59.781199, "i", "export ROOT_DIR=\"/home/user/release\"\nexport REPORT_PATH=\"/var/log/oldguard_report.txt\""]
[59.781529, "o", "export ROOT_DIR=\"/home/user/release\"\r\n\u001b[?2004l\r"]
[59.781754, "o", "bash: syntax error near unexpected token `then'\r\n\u001b[?2004h"]
[59.781814, "o", "root@f20579cc-b850-49ba-a4ff-8d22f3d01ed2:~# "]
[59.782039, "o", "export REPORT_PATH=\"/var/log/oldguard_report.txt\""]
[60.038104, "i", "echo \"Manually set ROOT_DIR='$ROOT_DIR', REPORT_PATH='$REPORT_PATH' based on typical values.\""]
[60.038785, "o", "echo \"Manually set ROOT_DIR='$ROOT_DIR', REPORT_PATH='$REPORT_PATH' based on typical values.\""]
[60.237014, "i", "if [ -d \"$ROOT_DIR\" ]; then echo \"ROOT_DIR '$ROOT_DIR' exists and is a directory.\"; else echo \"ERROR: ROOT_DIR '$ROOT_DIR' is not a valid directory. Please check /etc/oldguard/scanner.ini or set it manually.\"; fi"]
[60.238338, "o", "if [ -d \"$ROOT_DIR\" ]; then echo \"ROOT_DIR '$ROOT_DIR' exists and is a directory.\"; else echo \"ERROR: ROOT_DIR '$ROOT_DIR' is not a valid directory. Please check /etc/oldguard/scanner.ini or set it manually.\"; fi"]
[60.477347, "i", "REPORT_DIR=$(dirname \"$REPORT_PATH\") && mkdir -p \"$REPORT_DIR\" && echo \"Ensured parent directory for REPORT_PATH exists: $REPORT_DIR\""]
[60.478257, "o", "REPORT_DIR=$(dirname \"$REPORT_PATH\") && mkdir -p \"$REPORT_DIR\" && echo \"Ensured parent directory for REPORT_PATH exists: $REPORT_DIR\""]
[60.790011, "i", "TMP_REPORT_FILE=$(mktemp /tmp/oldguard_report_XXXXXX) && echo \"Using temporary file for report assembly: $TMP_REPORT_FILE\""]
[60.790936, "o", "TMP_REPORT_FILE=$(mktemp /tmp/oldguard_report_XXXXXX) && echo \"Using temporary file for report assembly: $TMP_REPORT_FILE\""]
[60.953015, "i", "echo \"SCAN_ID: $BUILD_ID\" > \"$TMP_REPORT_FILE\""]
[60.953227, "o", "echo \"SCAN_ID: $BUILD_ID\" > \"$TMP_REPORT_FILE\""]
[61.196027, "i", "echo \"\" >> \"$TMP_REPORT_FILE\""]
[61.196252, "o", "echo \"\" >> \"$TMP_REPORT_FILE\""]
[84.004415, "i", "echo \"BUILD_ID is: '$BUILD_ID'\"\n"]
[84.004688, "o", "echo \"BUILD_ID is: '$BUILD_ID'\"\r\n"]
[84.004713, "o", "\u001b[?2004l\r"]
[84.004763, "o", "bash: syntax error near unexpected token `then'\r\n"]
[84.004824, "o", "\u001b[?2004h"]
[84.004898, "o", "root@f20579cc-b850-49ba-a4ff-8d22f3d01ed2:~# "]
[84.187939, "i", "export BUILD_ID=\"legacy-mainframe-integration-001\"\n"]
[84.18839, "o", "export BUILD_ID=\"legacy-mainframe-integration-001\"\r\n"]
[84.188424, "o", "\u001b[?2004l\r"]
[84.188528, "o", "\u001b[?2004hroot@f20579cc-b850-49ba-a4ff-8d22f3d01ed2:~# "]
[84.372778, "i", "cat /etc/oldguard/scanner.ini\n"]
[84.372893, "o", "cat /etc/oldguard/scanner.ini\r\n\u001b[?2004l\r"]
[84.373617, "o", "# OldGuard Scanner Configuration\r\nROOT_DIR = /home/user/release   \r\nREPORT_PATH = /home/user/audit/scan_report.dat\r\n"]
[84.373766, "o", "\u001b[?2004h"]
[84.373801, "o", "root@f20579cc-b850-49ba-a4ff-8d22f3d01ed2:~# "]
[84.872444, "i", "export ROOT_DIR=\"/home/user/release\"\n"]
[84.872768, "o", "export ROOT_DIR=\"/home/user/release\"\r\n\u001b[?2004l\r"]
[84.872919, "o", "\u001b[?2004h"]
[84.872969, "o", "root@f20579cc-b850-49ba-a4ff-8d22f3d01ed2:~# "]
[85.097176, "i", "export REPORT_PATH=\"/var/log/oldguard_report.txt\"\n"]
[85.09769, "o", "export REPORT_PATH=\"/var/log/oldguard_report.txt\"\r\n\u001b[?2004l\r"]
[85.097857, "o", "\u001b[?2004hroot@f20579cc-b850-49ba-a4ff-8d22f3d01ed2:~# "]
[85.42728, "i", "echo \"ROOT_DIR='$ROOT_DIR', REPORT_PATH='$REPORT_PATH'\"\n"]
[85.427544, "o", "echo \"ROOT_DIR='$ROOT_DIR', REPORT_PATH='$REPORT_PATH'\"\r\n\u001b[?2004l\rROOT_DIR='/home/user/release', REPORT_PATH='/var/log/oldguard_report.txt'\r\n"]
[85.427663, "o", "\u001b[?2004hroot@f20579cc-b850-49ba-a4ff-8d22f3d01ed2:~# "]
[85.743544, "i", "if [ -d \"$ROOT_DIR\" ]; then echo \"ROOT_DIR exists\"; else echo \"ROOT_DIR does not exist\"; fi\n"]
[85.743815, "o", "if [ -d \"$ROOT_DIR\" ]; then echo \"ROOT_DIR exists\"; else echo \"ROOT_DIR does not exist\"; fi\r\n\u001b[?2004l\r"]
[85.743925, "o", "ROOT_DIR exists\r\n"]
[85.743968, "o", "\u001b[?2004hroot@f20579cc-b850-49ba-a4ff-8d22f3d01ed2:~# "]
[85.954039, "i", "REPORT_DIR=$(dirname \"$REPORT_PATH\") && mkdir -p \"$REPORT_DIR\" && echo \"REPORT_DIR: $REPORT_DIR\"\n"]
[85.954568, "o", "REPORT_DIR=$(dirname \"$REPORT_PATH\") && mkdir -p \"$REPORT_DIR\" && echo \"REPORT_DIR: $REPORT_DIR\"\r\n\u001b[?2004l\r"]
[85.958692, "o", "REPORT_DIR: /var/log\r\n"]
[85.958767, "o", "\u001b[?2004h"]
[85.958814, "o", "root@f20579cc-b850-49ba-a4ff-8d22f3d01ed2:~# "]
[86.192066, "i", "TMP_REPORT_FILE=$(mktemp /tmp/oldguard_report_XXXXXX) && echo \"TMP_REPORT_FILE: $TMP_REPORT_FILE\"\n"]
[86.19285, "o", "TMP_REPORT_FILE=$(mktemp /tmp/oldguard_report_XXXXXX) && echo \"TMP_REPORT_FILE: $TMP_REPORT_FILE\"\r\n\u001b[?2004l\r"]
[86.194929, "o", "TMP_REPORT_FILE: /tmp/oldguard_report_YBTcHr\r\n"]
[86.195013, "o", "\u001b[?2004h"]
[86.195061, "o", "root@f20579cc-b850-49ba-a4ff-8d22f3d01ed2:~# "]
[86.390619, "i", "echo \"SCAN_ID: $BUILD_ID\" > \"$TMP_REPORT_FILE\"\n"]
[86.391007, "o", "echo \"SCAN_ID: $BUILD_ID\" > \"$TMP_REPORT_FILE\"\r\n\u001b[?2004l\r"]
[86.391254, "o", "\u001b[?2004h"]
[86.391343, "o", "root@f20579cc-b850-49ba-a4ff-8d22f3d01ed2:~# "]
[86.586196, "i", "echo \"\" >> \"$TMP_REPORT_FILE\"\n"]
[86.586471, "o", "echo \"\" >> \"$TMP_REPORT_FILE\"\r\n\u001b[?2004l\r"]
[86.586569, "o", "\u001b[?2004hroot@f20579cc-b850-49ba-a4ff-8d22f3d01ed2:~# "]
[105.251377, "i", "find \"$ROOT_DIR\" -type f -not -path '*/.*' ! -name '.*' -perm -0002 -print0 | xargs -0 stat --format=\"%s  %n\" | sort -k1,1nr -k2,2 | tee > >(cat >> \"$TMP_REPORT_FILE\")"]
[105.252275, "o", "find \"$ROOT_DIR\" -type f -not -path '*/.*' ! -name '.*' -perm -0002 -print0 | xargs -0 stat --format=\"%s  %n\" | sort -k1,1nr -k2,2 | tee > >(cat >> \"$TMP_REPORT_FILE\")"]
[107.154844, "i", "echo \"-----BEGIN WORLD_WRITABLE-----\" >> \"$TMP_REPORT_FILE\""]
[107.155869, "o", "echo \"-----BEGIN WORLD_WRITABLE-----\" >> \"$TMP_REPORT_FILE\""]
[107.319911, "i", "find \"$ROOT_DIR\" -type f -not -path '*/.*' ! -name '.*' -perm -0002 -print0 | xargs -0 stat --format=\"%s  %n\" | sort -k1,1nr -k2,2 >> \"$TMP_REPORT_FILE\""]
[107.320904, "o", "find \"$ROOT_DIR\" -type f -not -path '*/.*' ! -name '.*' -perm -0002 -print0 | xargs -0 stat --format=\"%s  %n\" | sort -k1,1nr -k2,2 >> \"$TMP_REPORT_FILE\""]
[109.465001, "i", "echo \"\" >> \"$TMP_REPORT_FILE\""]
[109.465291, "o", "echo \"\" >> \"$TMP_REPORT_FILE\""]
[129.653045, "i", "find \"$ROOT_DIR\" -type f -not -type l -not -path '*/.*' -perm -o=w -print0 | xargs -0 stat --format=\"%s  %n\" | sort -k1,1nr -k2,2 >> \"$TMP_REPORT_FILE\""]
[129.654668, "o", "find \"$ROOT_DIR\" -type f -not -type l -not -path '*/.*' -perm -o=w -print0 | xargs -0 stat --format=\"%s  %n\" | sort -k1,1nr -k2,2 >> \"$TMP_REPORT_FILE\""]
[131.561332, "i", "echo \"-----BEGIN WORLD_WRITABLE-----\" >> \"$TMP_REPORT_FILE\""]
[131.561888, "o", "echo \"-----BEGIN WORLD_WRITABLE-----\" >> \"$TMP_REPORT_FILE\""]
[131.730878, "i", "find \"$ROOT_DIR\" -type f -not -type l -not -path '*/.*' -perm -o=w -print0 | xargs -0 stat --format=\"%s  %n\" | sort -k1,1nr -k2,2 >> \"$TMP_REPORT_FILE\""]
[131.731641, "o", "find \"$ROOT_DIR\" -type f -not -type l -not -path '*/.*' -perm -o=w -print0 | xargs -0 stat --format=\"%s  %n\" | sort -k1,1nr -k2,2 >> \"$TMP_REPORT_FILE\""]
[133.754486, "i", "echo \"\" >> \"$TMP_REPORT_FILE\""]
[133.754752, "o", "echo \"\" >> \"$TMP_REPORT_FILE\""]
[156.077029, "i", "echo \"-----BEGIN WORLD_WRITABLE-----\" >> \"$TMP_REPORT_FILE\""]
[156.077632, "o", "echo \"-----BEGIN WORLD_WRITABLE-----\" >> \"$TMP_REPORT_FILE\""]
[156.325813, "i", "echo \"\" >> \"$TMP_REPORT_FILE\""]
[156.326077, "o", "echo \"\" >> \"$TMP_REPORT_FILE\""]
[156.542748, "i", "echo \"-----BEGIN TODO_LINES-----\" >> \"$TMP_REPORT_FILE\""]
[156.543099, "o", "echo \"-----BEGIN TODO_LINES-----\" >> \"$TMP_REPORT_FILE\""]
[156.732238, "i", "find \"$ROOT_DIR\" -type f \\( -name '*.py' -o -name '*.log' \\) -not -type l -not -path '*/.*' -size -10k -print0 | xargs -0 -I{} sh -c 'grep -Hn \"TODO\" \"{}\" | grep -v \"NO_FIX\" | sed \"s/{}:/$(echo {} | sed \\\"s,$ROOT_DIR/,,\\\" | sed \\\"s,^\\./,\\\"):/\" | tr -d '\\\\n' | sed \\\"s/\\\\$/\\\\n\\\\\\\"/\"' >> \"$TMP_REPORT_FILE\""]
[156.733761, "o", "find \"$ROOT_DIR\" -type f \\( -name '*.py' -o -name '*.log' \\) -not -type l -not -path '*/.*' -size -10k -print0 | xargs -0 -I{} sh -c 'grep -Hn \"TODO\" \"{}\" | grep -v \"NO_FIX\" | sed \"s/{}:/$(echo {} | sed \\\"s,$ROOT_DIR/,,\\\" | sed \\\"s,^\\./,\\\"):/\" | tr -d '\\\\n' | sed \\\"s/\\\\$/\\\\n\\\\\\\"/\"' >> \"$TMP_REPORT_FILE\""]
[183.251592, "i", "echo \"\" >> \"$TMP_REPORT_FILE\""]
[183.251924, "o", "echo \"\" >> \"$TMP_REPORT_FILE\""]
[183.437199, "i", "REPORT_CONTENT=$(cat \"$TMP_REPORT_FILE\") && echo \"MD5: $(echo -n \"$REPORT_CONTENT\" | md5sum | cut -d' ' -f1)\" >> \"$TMP_REPORT_FILE\""]
[183.437994, "o", "REPORT_CONTENT=$(cat \"$TMP_REPORT_FILE\") && echo \"MD5: $(echo -n \"$REPORT_CONTENT\" | md5sum | cut -d' ' -f1)\" >> \"$TMP_REPORT_FILE\""]
[184.493449, "i", "cp \"$TMP_REPORT_FILE\" \"$REPORT_PATH\""]
[184.493892, "o", "cp \"$TMP_REPORT_FILE\" \"$REPORT_PATH\""]
[184.95563, "i", "echo '{\"status\": \"complete\", \"report_file\": \"$REPORT_PATH\"}'"]
[184.956125, "o", "echo '{\"status\": \"complete\", \"report_file\": \"$REPORT_PATH\"}'"]
[185.197599, "i", "rm \"$TMP_REPORT_FILE\""]
[185.197763, "o", "rm \"$TMP_REPORT_FILE\""]
