[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# asciinema rec --stdin /logs/agent/recording.cast
[?2004l[0;32masciinema: recording asciicast to /logs/agent/recording.cast[0m
[0;32masciinema: press <ctrl-d> or type "exit" when you're done[0m
[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# clear
[?2004l[H[J[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# cat /etc/oldguard/scanner.ini
[?2004l# OldGuard Scanner Configuration
ROOT_DIR = /home/user/release   
REPORT_PATH = /home/user/audit/scan_report.dat
[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# ROOT_DIR=$(grep '^ROOT_DIR' /etc/oldguard/scanner.ini | awk -F'=' '{print $2}' | xargs)
[?2004l[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# REPORT_PATH=$(grep '^REPORT_PATH' /etc/oldguard/scanner.ini | awk -F'=' '{print $2}' | xargs)
[?2004l[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# echo "ROOT_DIR is set to: '${ROOT_DIR}'"
[?2004lROOT_DIR is set to: '/home/user/release'
[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# echo "REPORT_PATH is set to: '${REPORT_PATH}'"
[?2004lREPORT_PATH is set to: '/home/user/audit/scan_report.dat'
[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# mkdir -p "${REPORT_PATH%/*}"
[?2004l[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# PART_A_CONTENT="$(find '${ROOT_DIR}' -type f -not -type l -perm -0002 -not -path '*/.*' -printf '%s %p\n' | sort -k1,1nr -k2,2 | awk '{printf "%s  %s\n", $1, $2}' )"
[?2004lfind: â€˜${ROOT_DIR}â€™: No such file or directory
[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# eval "PART_A_CONTENT='$(find \"${ROOT_DIR}\" -type f -not -type l -perm -0002 -not -path '*/.*' -printf '%s %p\n' | sort -k1,1nr -k2,2 | awk '{printf \"%s  %s\n\", \$1, \$2}' )'"
[?2004lfind: â€˜"/home/user/release"â€™: No such file or directory
awk: 1: unexpected character '\'
awk: line 1: runaway string constant "%s  %s\n\" ...
[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# echo "Part A content (first 2 lines):"; echo "$PART_A_CONTENT" | head -n 2
[?2004lPart A content (first 2 lines):

[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# PART_B_CONTENT=$(find '${ROOT_DIR}' -type f \( -iname '*.py' -o -iname '*.log' \) -not -type l -not -path '*/.*' -size -10k -exec grep -l 'TODO' '{}'; do grep -Hn 'TODO' "$f" | grep -v 'NO_FIX'; done | sed 's|^${ROOT_DIR}/||; s|:|: |; s/\\n$//' | sort -k1,1 -k2,2n )
[?2004lbash: command substitution: line 12: syntax error near unexpected token `do'
bash: command substitution: line 12: `find '${ROOT_DIR}' -type f \( -iname '*.py' -o -iname '*.log' \) -not -type l -not -path '*/.*' -size -10k -exec grep -l 'TODO' '{}'; do grep -Hn 'TODO' "$f" | grep -v 'NO_FIX'; done | sed 's|^${ROOT_DIR}/||; s|:|: |; s/\\n$//' | sort -k1,1 -k2,2n )'
[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# echo "Part B content (first 2 lines):"; echo "$PART_B_CONTENT" | head -n 2
[?2004lPart B content (first 2 lines):

[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# REPORT_CONTENT=""
[?2004l[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# BUILD_ID="${BUILD_ID:-UNSET_BUILD_ID}"
[?2004l[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# REPORT_CONTENT="$BUILD_ID\n-----BEGIN WORLD_WRITABLE-----\n\n-----BEGIN TODO_LINES-----\n"
[?2004l[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# CONTENT_BEFORE_MD5=$(echo -n "$REPORT_CONTENT" | head -c -1)
[?2004l[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# MD5_CHECKSUM=$(echo -n "$CONTENT_BEFORE_MD5" | md5sum | cut -d' ' -f1)
[?2004l[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# FINAL_REPORT_CONTENT="$REPORT_CONTENT"MD5: $MD5_CHECKSUM
[?2004lbash: f6ed82fa1fccdba7d9128ce451b7b2d3: command not found
[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# FINAL_REPORT_CONTENT="${REPORT_CONTENT}MD5: ${MD5_CHECKSUM}"echo -n "$FINAL_REPORT_CONTENT" | iconv -f UTF-8 -t ISO-8859-1//TRANSLIT > "${REPORT_PATH}"
[?2004lbash: -n: command not found
[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# echo '{"status": "complete", "report_file": "${REPORT_PATH}"}'
[?2004l{"status": "complete", "report_file": "${REPORT_PATH}"}
[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# echo "$FINAL_REPORT_CONTENT" | iconv -f UTF-8 -t ISO-8859-1//TRANSLIT > "${REPORT_PATH}"
[?2004l[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# echo '{"status": "complete", "report_file": "${REPORT_PATH}"}'
[?2004l{"status": "complete", "report_file": "${REPORT_PATH}"}
[?2004hroot@bd9b1f37-34f6-4f28-bc61-0e9b48379b32:~# echo '{"status": "complete", "report_file": "${REPORT_PATH}"}'