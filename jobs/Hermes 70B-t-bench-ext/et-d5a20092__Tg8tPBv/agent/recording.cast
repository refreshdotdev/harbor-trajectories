{"version": 2, "width": 160, "height": 40, "timestamp": 1771009003, "env": {"SHELL": "/bin/bash", "TERM": "screen"}}
[0.005869, "o", "\u001b[?2004hroot@5796a375-dbf6-41c9-a2c9-9c12d187c8ad:/home/user# "]
[0.962735, "i", "clear\r"]
[0.962859, "o", "clear\r\n\u001b[?2004l\r"]
[0.963769, "o", "\u001b[H\u001b[J"]
[0.963919, "o", "\u001b[?2004hroot@5796a375-dbf6-41c9-a2c9-9c12d187c8ad:/home/user# "]
[10.633566, "i", "mkdir -p /tmp/capacity_work\n"]
[10.633778, "o", "mkdir -p /tmp/capacity_work\r\n\u001b[?2004l\r"]
[10.635243, "o", "\u001b[?2004h"]
[10.635299, "o", "root@5796a375-dbf6-41c9-a2c9-9c12d187c8ad:/home/user# "]
[10.934278, "i", "cd /home/user/capacity\n"]
[10.934414, "o", "cd /home/user/capacity\r\n\u001b[?2004l\r"]
[10.934467, "o", "\u001b[?2004h"]
[10.934495, "o", "root@5796a375-dbf6-41c9-a2c9-9c12d187c8ad:/home/user/capacity# "]
[19.958585, "i", "cat config/manifest.txt\n"]
[19.958749, "o", "cat config/manifest.txt\r\n\u001b[?2004l\r"]
[19.959749, "o", "# Active Regions for Jan 2023\r\nregion_alpha\r\n# Region Gamma is deprecated\r\nregion_beta\r\n"]
[19.959937, "o", "\u001b[?2004h"]
[19.959964, "o", "root@5796a375-dbf6-41c9-a2c9-9c12d187c8ad:/home/user/capacity# "]
[65.853308, "i", "cat > /tmp/capacity_work/process_data.py << 'EOF'\n#!/usr/bin/env python3\n\"\"\"\nProcess log files for capacity planning.\n\"\"\"\nimport os\nimport json\nimport struct\nimport hashlib\nimport sys\nfrom pathlib import Path\n\ndef process_file(filepath, is_legacy, file_count, metric_sums, metric_counts):\n    \"\"\"Process a single log file.\"\"\"\n    try:\n        if is_legacy:\n            with open(filepath, 'r', encoding='ISO-8859-1') as f:\n                lines = f.readlines()\n        else:\n            with open(filepath, 'r', encoding='utf-8-sig') as f:  # Handles BOM\n                lines = f.readlines()\n        \n        active_file = False\n        cpu_values = []\n        mem_values = []\n        disk_values = []\n        \n        for line in lines:\n            if \"meta_status: active\" in line:\n                active_file = True\n                continue\n            \n            if \"CPU_USED:\" in line:\n                val = float(line.split(':')[1].strip())\n                if not is_legacy:\n                    val = round(val)  # "]
[65.853409, "i", "Round modern floating-point values\n                if 5 <= val <= 95:\n                    cpu_values.append(val)\n            elif \"MEM_USED:\" in line:\n                val = float(line.split(':')[1].strip())\n                if not is_legacy:\n                    val = round(val)\n                if 5 <= val <= 95:\n                    mem_values.append(val)\n            elif \"DISK_USED:\" in line:\n                val = float(line.split(':')[1].strip())\n                if not is_legacy:\n                    val = round(val)\n                if 5 <= val <= 95:\n                    disk_values.append(val)\n        \n        if active_file and (cpu_values or mem_values or disk_values):\n            file_count[0] += 1\n            if cpu_values:\n                metric_sums[0] += sum(cpu_values)\n                metric_counts[0] += len(cpu_values)\n            if mem_values:\n                metric_sums[1] += sum(mem_values)\n                metric_counts[1] += len(mem_values)\n            if disk_values:\n                metric_sums"]
[65.853432, "i", "[2] += sum(disk_values)\n                metric_counts[2] += len(disk_values)\n    except Exception as e:\n        print(f\"Error processing {filepath}: {e}\", file=sys.stderr)\n\ndef main():\n    \"\"\"Main processing function.\"\"\"\n    script_dir = Path(__file__).parent\n    base_dir = Path.cwd()\n    manifest_path = base_dir / 'config' / 'manifest.txt'\n    \n    # Read manifest file\n    active_dirs = []\n    try:\n        with open(manifest_path, 'r') as f:\n            for line in f:\n                line = line.strip()\n                if line and not line.startswith('#'):\n                    active_dirs.append(line)\n    except FileNotFoundError:\n        print(f\"Manifest file not found: {manifest_path}\", file=sys.stderr)\n        return 1\n    \n    # Initialize metrics\n    file_count = [0]\n    metric_sums = [0.0, 0.0, 0.0]  # CPU, MEM, DISK\n    metric_counts = [0, 0, 0]\n    \n    # Process files\n    for active_dir in active_dirs:\n        full_path = base_dir / 'raw' / active_dir\n        if full_path.exists():\n            for ro"]
[65.853457, "i", "ot, _, files in os.walk(full_path):\n                for file in files:\n                    if file.endswith('_202301.log'):\n                        filepath = Path(root) / file\n                        is_legacy = 'legacy' in file\n                        process_file(filepath, is_legacy, file_count, metric_sums, metric_counts)\n    \n    # Calculate averages\n    avg_cpu = int(metric_sums[0] / metric_counts[0]) if metric_counts[0] > 0 else 0\n    avg_mem = int(metric_sums[1] / metric_counts[1]) if metric_counts[1] > 0 else 0\n    avg_disk = int(metric_sums[2] / metric_counts[2]) if metric_counts[2] > 0 else 0\n    \n    # Prepare results\n    results = {\n        'AVG_CPU_USED': avg_cpu,\n        'AVG_MEM_USED': avg_mem,\n        'AVG_DISK_USED': avg_disk,\n        'total_files_processed': file_count[0]\n    }\n    \n    # Write intermediate JSON\n    intermediate_path = base_dir / 'reports' / 'intermediate.json'\n    with open(intermediate_path, 'w') as f:\n        json.dump(results, f, separators=(',', ':'))\n    \n    # Write "]
[65.853476, "i", "summary log\n    summary_path = base_dir / 'reports' / 'summary_202301.log'\n    with open(summary_path, 'wb') as f:\n        f.write(f\"AVG_CPU_USED={results['AVG_CPU_USED']}\\r\\n\".encode('utf-8'))\n        f.write(f\"AVG_MEM_USED={results['AVG_MEM_USED']}\\r\\n\".encode('utf-8'))\n        f.write(f\"AVG_DISK_USED={results['AVG_DISK_USED']}\\r\\n\".encode('utf-8'))\n        f.write(f\"source_size={os.path.getsize(intermediate_path)}\\r\\n\".encode('utf-8'))\n    \n    # Create binary checksum\n    md5_hash = hashlib.md5()\n    with open(summary_path, 'rb') as f:\n        md5_hash.update(f.read())\n    \n    checksum_path = base_dir / 'reports' / 'checksum.bin'\n    with open(checksum_path, 'wb') as f:\n        f.write(md5_hash.digest())\n    \n    # Get SHA256 of the checksum file\n    sha256_hash = hashlib.sha256()\n    with open(checksum_path, 'rb') as f:\n        sha256_hash.update(f.read())\n    \n    # Update symlink\n    latest_path = base_dir / 'latest'\n    if latest_path.exists():\n        latest_path.unlink()\n    latest_path.symlink_to("]
[65.853488, "o", "cat > /tmp/capacity_work/process_data.py << 'EOF'\r\n\u001b[?2004l\r"]
[65.853508, "i", "summary_path, absolute=True)\n    \n    # Append to operations log\n    ops_log_path = base_dir / 'operations.log'\n    with open(ops_log_path, 'a') as f:\n        f.write(f\"Publication 2023-01: {results['total_files_processed']} files, Checksum: {sha256_hash.hexdigest()}\\n\")\n    \n    print(\"Processing complete. Results are in the reports directory.\")\n    return 0\n\nif __name__ == '__main__':\n    sys.exit(main())\nEOF"]
[65.853534, "o", "\u001b[?2004h"]
[65.85355, "o", "> "]
[65.85363, "o", "#!/usr/bin/env python3\r\n\u001b[?2004l\r"]
[65.853659, "o", "\u001b[?2004h"]
[65.853678, "o", "> \"\"\""]
[65.853707, "o", "\r\n\u001b[?2004l\r"]
[65.853725, "o", "\u001b[?2004h> "]
[65.85387, "o", "Process log files for capacity planning.\r\n\u001b[?2004l\r"]
[65.853898, "o", "\u001b[?2004h"]
[65.853916, "o", "> \"\"\"\r\n\u001b[?2004l\r\u001b[?2004h"]
[65.853935, "o", "> "]
[65.853957, "o", "import os\r\n\u001b[?2004l\r"]
[65.853971, "o", "\u001b[?2004h"]
[65.853991, "o", "> "]
[65.854017, "o", "import json\r\n\u001b[?2004l\r"]
[65.854033, "o", "\u001b[?2004h"]
[65.854049, "o", "> "]
[65.854089, "o", "import struct\r\n\u001b[?2004l\r"]
[65.854102, "o", "\u001b[?2004h"]
[65.854117, "o", "> "]
[65.854158, "o", "import hashlib\r\n\u001b[?2004l\r"]
[65.854177, "o", "\u001b[?2004h"]
[65.854193, "o", "> "]
[65.854218, "o", "import sys\r\n\u001b[?2004l\r"]
[65.854232, "o", "\u001b[?2004h"]
[65.854247, "o", "> "]
[65.854334, "o", "from pathlib import Path\r\n\u001b[?2004l\r"]
[65.854348, "o", "\u001b[?2004h"]
[65.854363, "o", "> \r\n\u001b[?2004l\r"]
[65.854378, "o", "\u001b[?2004h"]
[65.854393, "o", "> "]
[65.854683, "o", "def process_file(filepath, is_legacy, file_count, metric_sums, metric_counts):\r\n\u001b[?2004l\r"]
[65.854714, "o", "\u001b[?2004h> "]
[65.854816, "o", "    \"\"\"Process a single log file.\"\"\"\r\n\u001b[?2004l\r"]
[65.854833, "o", "\u001b[?2004h"]
[65.854851, "o", "> "]
[65.854866, "o", "    try:\r\n\u001b[?2004l\r"]
[65.854879, "o", "\u001b[?2004h"]
[65.854894, "o", "> "]
[65.854967, "o", "        if is_legacy:\r\n\u001b[?2004l\r"]
[65.854984, "o", "\u001b[?2004h"]
[65.854998, "o", "> "]
[65.855217, "o", "            with open(filepath, 'r', encoding='ISO-8859-1') as f:\r\n\u001b[?2004l\r"]
[65.855233, "o", "\u001b[?2004h> "]
[65.855351, "o", "                lines = f.readlines()\r\n\u001b[?2004l\r"]
[65.855371, "o", "\u001b[?2004h> "]
[65.855414, "o", "        else:\r\n\u001b[?2004l\r"]
[65.855432, "o", "\u001b[?2004h"]
[65.855448, "o", "> "]
[65.855695, "o", "            with open(filepath, 'r', encoding='utf-8-sig') as f:  # Handles BOM\r\n\u001b[?2004l\r"]
[65.855715, "o", "\u001b[?2004h> "]
[65.855823, "o", "                lines = f.readlines()\r\n\u001b[?2004l\r"]
[65.855836, "o", "\u001b[?2004h"]
[65.855854, "o", "> "]
[65.85587, "o", "        \r\n\u001b[?2004l\r"]
[65.855884, "o", "\u001b[?2004h"]
[65.855901, "o", "> "]
[65.855977, "o", "        active_file = False\r\n\u001b[?2004l\r"]
[65.85599, "o", "\u001b[?2004h"]
[65.856003, "o", "> "]
[65.856071, "o", "        cpu_values = []\r\n\u001b[?2004l\r"]
[65.856084, "o", "\u001b[?2004h"]
[65.856099, "o", "> "]
[65.856165, "o", "        mem_values = []\r\n\u001b[?2004l\r"]
[65.856184, "o", "\u001b[?2004h"]
[65.8562, "o", "> "]
[65.856277, "o", "        disk_values = []\r\n\u001b[?2004l\r"]
[65.856295, "o", "\u001b[?2004h"]
[65.85631, "o", "> "]
[65.856337, "o", "        \r\n\u001b[?2004l\r"]
[65.856351, "o", "\u001b[?2004h"]
[65.856365, "o", "> "]
[65.856448, "o", "        for line in lines:\r\n\u001b[?2004l\r"]
[65.856464, "o", "\u001b[?2004h"]
[65.85648, "o", "> "]
[65.856609, "o", "            if \"meta_status: active\" in line:\r\n\u001b[?2004l\r"]
[65.856626, "o", "\u001b[?2004h> "]
[65.85674, "o", "                active_file = True\r\n\u001b[?2004l\r"]
[65.856755, "o", "\u001b[?2004h> "]
[65.856832, "o", "                continue\r\n\u001b[?2004l\r"]
[65.856848, "o", "\u001b[?2004h"]
[65.856865, "o", "> "]
[65.856895, "o", "            \r\n\u001b[?2004l\r"]
[65.85691, "o", "\u001b[?2004h"]
[65.856927, "o", "> "]
[65.857024, "o", "            if \"CPU_USED:\" in line:\r\n\u001b[?2004l\r"]
[65.857044, "o", "\u001b[?2004h> "]
[65.857218, "o", "                val = float(line.split(':')[1].strip())\r\n\u001b[?2004l\r"]
[65.857238, "o", "\u001b[?2004h> "]
[65.857336, "o", "                if not is_legacy:\r\n\u001b[?2004l\r"]
[65.857349, "o", "\u001b[?2004h"]
[65.857363, "o", "> "]
[65.857594, "o", "                    val = round(val)  # Round modern floating-point values\r\n\u001b[?2004l\r"]
[65.857614, "o", "\u001b[?2004h> "]
[65.857749, "o", "                if 5 <= val <= 95:\r\n\u001b[?2004l\r"]
[65.857766, "o", "\u001b[?2004h"]
[65.857784, "o", "> "]
[65.857905, "o", "                    cpu_values.append(val)\r\n\u001b[?2004l\r"]
[65.857925, "o", "\u001b[?2004h> "]
[65.858039, "o", "            elif \"MEM_USED:\" in line:\r\n\u001b[?2004l\r"]
[65.858052, "o", "\u001b[?2004h"]
[65.858066, "o", "> "]
[65.858223, "o", "                val = float(line.split(':')[1].strip())\r\n\u001b[?2004l\r"]
[65.858236, "o", "\u001b[?2004h"]
[65.85825, "o", "> "]
[65.858343, "o", "                if not is_legacy:\r\n\u001b[?2004l\r"]
[65.858356, "o", "\u001b[?2004h"]
[65.858369, "o", "> "]
[65.858474, "o", "                    val = round(val)\r\n\u001b[?2004l\r"]
[65.858494, "o", "\u001b[?2004h"]
[65.85851, "o", "> "]
[65.858603, "o", "                if 5 <= val <= 95:\r\n\u001b[?2004l\r"]
[65.858621, "o", "\u001b[?2004h"]
[65.858638, "o", "> "]
[65.858779, "o", "                    mem_values.append(val)\r\n\u001b[?2004l\r\u001b[?2004h"]
[65.858797, "o", "> "]
[65.858927, "o", "            elif \"DISK_USED:\" in line:\r\n\u001b[?2004l\r"]
[65.858945, "o", "\u001b[?2004h"]
[65.85896, "o", "> "]
[65.8591, "o", "                val = float(line.split(':')[1].strip())\r\n\u001b[?2004l\r"]
[65.859113, "o", "\u001b[?2004h"]
[65.859126, "o", "> "]
[65.859204, "o", "                if not is_legacy:\r\n\u001b[?2004l\r"]
[65.859217, "o", "\u001b[?2004h"]
[65.859233, "o", "> "]
[65.859314, "o", "                    val = round(val)\r\n\u001b[?2004l\r"]
[65.859328, "o", "\u001b[?2004h"]
[65.859342, "o", "> "]
[65.859423, "o", "                if 5 <= val <= 95:\r\n\u001b[?2004l\r"]
[65.859436, "o", "\u001b[?2004h"]
[65.859454, "o", "> "]
[65.85955, "o", "                    disk_values.append(val)\r\n\u001b[?2004l\r"]
[65.859589, "o", "\u001b[?2004h>         \r\n"]
[65.859618, "o", "\u001b[?2004l\r\u001b[?2004h> "]
[65.85979, "o", "        if active_file and (cpu_values or mem_values or disk_values):\r\n\u001b[?2004l\r"]
[65.859816, "o", "\u001b[?2004h> "]
[65.859887, "o", "            file_count[0] += 1\r\n\u001b[?2004l\r"]
[65.859907, "o", "\u001b[?2004h"]
[65.859926, "o", "> "]
[65.859978, "o", "            if cpu_values:\r\n\u001b[?2004l\r"]
[65.859995, "o", "\u001b[?2004h> "]
[65.86015, "o", "                metric_sums[0] += sum(cpu_values)\r\n\u001b[?2004l\r"]
[65.860166, "o", "\u001b[?2004h"]
[65.860184, "o", "> "]
[65.860301, "o", "                metric_counts[0] += len(cpu_values)\r\n\u001b[?2004l\r"]
[65.860327, "o", "\u001b[?2004h> "]
[65.860394, "o", "            if mem_values:\r\n\u001b[?2004l\r"]
[65.860411, "o", "\u001b[?2004h> "]
[65.860533, "o", "                metric_sums[1] += sum(mem_values)\r\n\u001b[?2004l\r"]
[65.860546, "o", "\u001b[?2004h"]
[65.86056, "o", "> "]
[65.860692, "o", "                metric_counts[1] += len(mem_values)\r\n\u001b[?2004l\r"]
[65.860709, "o", "\u001b[?2004h> "]
[65.860786, "o", "            if disk_values:\r\n\u001b[?2004l\r"]
[65.860807, "o", "\u001b[?2004h> "]
[65.860931, "o", "                metric_sums[2] += sum(disk_values)\r\n\u001b[?2004l\r"]
[65.86095, "o", "\u001b[?2004h> "]
[65.861086, "o", "                metric_counts[2] += len(disk_values)\r\n\u001b[?2004l\r"]
[65.861104, "o", "\u001b[?2004h> "]
[65.861176, "o", "    except Exception as e:\r\n\u001b[?2004l\r"]
[65.861192, "o", "\u001b[?2004h"]
[65.861211, "o", "> "]
[65.861395, "o", "        print(f\"Error processing {filepath}: {e}\", file=sys.stderr)\r\n\u001b[?2004l\r"]
[65.861438, "o", "\u001b[?2004h> \r\n\u001b[?2004l\r\u001b[?2004h"]
[65.861464, "o", "> "]
[65.861488, "o", "def main():\r\n\u001b[?2004l\r"]
[65.861504, "o", "\u001b[?2004h"]
[65.861521, "o", "> "]
[65.86161, "o", "    \"\"\"Main processing function.\"\"\"\r\n\u001b[?2004l\r"]
[65.861629, "o", "\u001b[?2004h"]
[65.861659, "o", "> "]
[65.86175, "o", "    script_dir = Path(__file__).parent\r\n\u001b[?2004l\r"]
[65.861773, "o", "\u001b[?2004h> "]
[65.861843, "o", "    base_dir = Path.cwd()\r\n\u001b[?2004l\r"]
[65.861863, "o", "\u001b[?2004h> "]
[65.86201, "o", "    manifest_path = base_dir / 'config' / 'manifest.txt'\r\n\u001b[?2004l\r"]
[65.862029, "o", "\u001b[?2004h"]
[65.862046, "o", ">     \r\n"]
[65.862062, "o", "\u001b[?2004l\r"]
[65.862079, "o", "\u001b[?2004h> "]
[65.862147, "o", "    # Read manifest file\r\n\u001b[?2004l\r"]
[65.862182, "o", "\u001b[?2004h> "]
[65.86224, "o", "    active_dirs = []\r\n\u001b[?2004l\r"]
[65.862256, "o", "\u001b[?2004h"]
[65.862273, "o", "> "]
[65.862293, "o", "    try:\r\n\u001b[?2004l\r"]
[65.862312, "o", "\u001b[?2004h"]
[65.862327, "o", "> "]
[65.862427, "o", "        with open(manifest_path, 'r') as f:\r\n\u001b[?2004l\r"]
[65.862443, "o", "\u001b[?2004h"]
[65.862457, "o", "> "]
[65.862532, "o", "            for line in f:\r\n\u001b[?2004l\r"]
[65.862552, "o", "\u001b[?2004h"]
[65.862566, "o", "> "]
[65.862665, "o", "                line = line.strip()\r\n\u001b[?2004l\r"]
[65.862681, "o", "\u001b[?2004h> "]
[65.862813, "o", "                if line and not line.startswith('#'):\r\n\u001b[?2004l\r"]
[65.862829, "o", "\u001b[?2004h> "]
[65.862942, "o", "                    active_dirs.append(line)\r\n\u001b[?2004l\r"]
[65.862962, "o", "\u001b[?2004h> "]
[65.863041, "o", "    except FileNotFoundError:\r\n\u001b[?2004l\r"]
[65.863059, "o", "\u001b[?2004h"]
[65.863077, "o", "> "]
[65.863289, "o", "        print(f\"Manifest file not found: {manifest_path}\", file=sys.stderr)\r\n\u001b[?2004l\r"]
[65.863309, "o", "\u001b[?2004h> "]
[65.863356, "o", "        return 1\r\n\u001b[?2004l\r"]
[65.863372, "o", "\u001b[?2004h> "]
[65.863391, "o", "    \r\n\u001b[?2004l\r"]
[65.863413, "o", "\u001b[?2004h> "]
[65.863469, "o", "    # Initialize metrics\r\n\u001b[?2004l\r"]
[65.863483, "o", "\u001b[?2004h"]
[65.863501, "o", "> "]
[65.863539, "o", "    file_count = [0]\r\n\u001b[?2004l\r"]
[65.863553, "o", "\u001b[?2004h"]
[65.86357, "o", "> "]
[65.863699, "o", "    metric_sums = [0.0, 0.0, 0.0]  # CPU, MEM, DISK\r\n\u001b[?2004l\r"]
[65.863716, "o", "\u001b[?2004h"]
[65.863734, "o", "> "]
[65.863817, "o", "    metric_counts = [0, 0, 0]\r\n\u001b[?2004l\r"]
[65.863836, "o", "\u001b[?2004h> "]
[65.863854, "o", "    \r\n\u001b[?2004l\r"]
[65.863868, "o", "\u001b[?2004h"]
[65.863889, "o", "> "]
[65.863925, "o", "    # Process files\r\n\u001b[?2004l\r"]
[65.86394, "o", "\u001b[?2004h"]
[65.863958, "o", "> "]
[65.864043, "o", "    for active_dir in active_dirs:\r\n\u001b[?2004l\r"]
[65.864058, "o", "\u001b[?2004h"]
[65.864075, "o", "> "]
[65.864202, "o", "        full_path = base_dir / 'raw' / active_dir\r\n\u001b[?2004l\r"]
[65.864218, "o", "\u001b[?2004h> "]
[65.864296, "o", "        if full_path.exists():\r\n\u001b[?2004l\r"]
[65.864316, "o", "\u001b[?2004h> "]
[65.864446, "o", "            for root, _, files in os.walk(full_path):\r\n\u001b[?2004l\r"]
[65.864461, "o", "\u001b[?2004h> "]
[65.86455, "o", "                for file in files:\r\n\u001b[?2004l\r"]
[65.864564, "o", "\u001b[?2004h"]
[65.864581, "o", "> "]
[65.864717, "o", "                    if file.endswith('_202301.log'):\r\n\u001b[?2004l\r"]
[65.864742, "o", "\u001b[?2004h> "]
[65.864871, "o", "                        filepath = Path(root) / file\r\n\u001b[?2004l\r"]
[65.864888, "o", "\u001b[?2004h> "]
[65.865042, "o", "                        is_legacy = 'legacy' in file\r\n\u001b[?2004l\r"]
[65.865058, "o", "\u001b[?2004h"]
[65.865066, "o", "> "]
[65.865295, "o", "                        process_file(filepath, is_legacy, file_count, metric_sums, metric_counts)\r\n\u001b[?2004l\r"]
[65.865314, "o", "\u001b[?2004h> "]
[65.865334, "o", "    \r\n\u001b[?2004l\r"]
[65.865356, "o", "\u001b[?2004h> "]
[65.865409, "o", "    # Calculate averages\r\n\u001b[?2004l\r"]
[65.865423, "o", "\u001b[?2004h"]
[65.86544, "o", "> "]
[65.865629, "o", "    avg_cpu = int(metric_sums[0] / metric_counts[0]) if metric_counts[0] > 0 else 0\r\n\u001b[?2004l\r"]
[65.865651, "o", "\u001b[?2004h> "]
[65.865854, "o", "    avg_mem = int(metric_sums[1] / metric_counts[1]) if metric_counts[1] > 0 else 0\r\n\u001b[?2004l\r"]
[65.865874, "o", "\u001b[?2004h> "]
[65.866107, "o", "    avg_disk = int(metric_sums[2] / metric_counts[2]) if metric_counts[2] > 0 else 0\r\n\u001b[?2004l\r"]
[65.866129, "o", "\u001b[?2004h> "]
[65.866148, "o", "    \r\n\u001b[?2004l\r"]
[65.86617, "o", "\u001b[?2004h> "]
[65.866215, "o", "    # Prepare results\r\n\u001b[?2004l\r"]
[65.866229, "o", "\u001b[?2004h"]
[65.866246, "o", "> "]
[65.866275, "o", "    results = {\r\n\u001b[?2004l\r"]
[65.866289, "o", "\u001b[?2004h> "]
[65.866374, "o", "        'AVG_CPU_USED': avg_cpu,\r\n\u001b[?2004l\r"]
[65.866394, "o", "\u001b[?2004h"]
[65.866416, "o", "> "]
[65.866473, "o", "        'AVG_MEM_USED': avg_mem,\r\n\u001b[?2004l\r"]
[65.866487, "o", "\u001b[?2004h"]
[65.866504, "o", "> "]
[65.866578, "o", "        'AVG_DISK_USED': avg_disk,\r\n\u001b[?2004l\r"]
[65.866596, "o", "\u001b[?2004h> "]
[65.866719, "o", "        'total_files_processed': file_count[0]\r\n\u001b[?2004l\r"]
[65.866737, "o", "\u001b[?2004h> "]
[65.866753, "o", "    }\r\n\u001b[?2004l\r"]
[65.86677, "o", "\u001b[?2004h"]
[65.866792, "o", ">     \r\n\u001b[?2004l\r"]
[65.866813, "o", "\u001b[?2004h> "]
[65.866909, "o", "    # Write intermediate JSON\r\n\u001b[?2004l\r"]
[65.866928, "o", "\u001b[?2004h> "]
[65.86709, "o", "    intermediate_path = base_dir / 'reports' / 'intermediate.json'\r\n\u001b[?2004l\r"]
[65.867107, "o", "\u001b[?2004h> "]
[65.867214, "o", "    with open(intermediate_path, 'w') as f:\r\n\u001b[?2004l\r"]
[65.86723, "o", "\u001b[?2004h> "]
[65.867363, "o", "        json.dump(results, f, separators=(',', ':'))\r\n\u001b[?2004l\r"]
[65.867403, "o", "\u001b[?2004h>     \r\n\u001b[?2004l\r"]
[65.867425, "o", "\u001b[?2004h"]
[65.867447, "o", "> "]
[65.867499, "o", "    # Write summary log\r\n\u001b[?2004l\r"]
[65.867518, "o", "\u001b[?2004h"]
[65.867534, "o", "> "]
[65.867718, "o", "    summary_path = base_dir / 'reports' / 'summary_202301.log'\r\n\u001b[?2004l\r"]
[65.867754, "o", "\u001b[?2004h> "]
[65.867861, "o", "    with open(summary_path, 'wb') as f:\r\n\u001b[?2004l\r"]
[65.86788, "o", "\u001b[?2004h> "]
[65.868069, "o", "        f.write(f\"AVG_CPU_USED={results['AVG_CPU_USED']}\\r\\n\".encode('utf-8'))\r\n\u001b[?2004l\r"]
[65.868082, "o", "\u001b[?2004h"]
[65.868096, "o", "> "]
[65.868275, "o", "        f.write(f\"AVG_MEM_USED={results['AVG_MEM_USED']}\\r\\n\".encode('utf-8'))\r\n\u001b[?2004l\r"]
[65.868288, "o", "\u001b[?2004h"]
[65.868305, "o", "> "]
[65.868486, "o", "        f.write(f\"AVG_DISK_USED={results['AVG_DISK_USED']}\\r\\n\".encode('utf-8'))\r\n\u001b[?2004l\r"]
[65.868501, "o", "\u001b[?2004h> "]
[65.868754, "o", "        f.write(f\"source_size={os.path.getsize(intermediate_path)}\\r\\n\".encode('utf-8'))\r\n\u001b[?2004l\r"]
[65.86879, "o", "\u001b[?2004h>     \r\n"]
[65.868813, "o", "\u001b[?2004l\r\u001b[?2004h"]
[65.86883, "o", "> "]
[65.868901, "o", "    # Create binary checksum\r\n\u001b[?2004l\r"]
[65.868917, "o", "\u001b[?2004h"]
[65.868935, "o", "> "]
[65.869004, "o", "    md5_hash = hashlib.md5()\r\n\u001b[?2004l\r"]
[65.869026, "o", "\u001b[?2004h> "]
[65.869133, "o", "    with open(summary_path, 'rb') as f:\r\n\u001b[?2004l\r"]
[65.869149, "o", "\u001b[?2004h"]
[65.869165, "o", "> "]
[65.869248, "o", "        md5_hash.update(f.read())\r\n\u001b[?2004l\r"]
[65.869263, "o", "\u001b[?2004h"]
[65.869285, "o", "> "]
[65.869301, "o", "    \r\n\u001b[?2004l\r"]
[65.869322, "o", "\u001b[?2004h> "]
[65.869483, "o", "    checksum_path = base_dir / 'reports' / 'checksum.bin'\r\n\u001b[?2004l\r"]
[65.869519, "o", "\u001b[?2004h> "]
[65.869612, "o", "    with open(checksum_path, 'wb') as f:\r\n\u001b[?2004l\r"]
[65.869631, "o", "\u001b[?2004h"]
[65.869653, "o", "> "]
[65.869723, "o", "        f.write(md5_hash.digest())\r\n\u001b[?2004l\r"]
[65.869741, "o", "\u001b[?2004h"]
[65.869757, "o", ">     \r\n\u001b[?2004l\r"]
[65.869772, "o", "\u001b[?2004h"]
[65.869788, "o", "> "]
[65.869867, "o", "    # Get SHA256 of the checksum file\r\n\u001b[?2004l\r"]
[65.869884, "o", "\u001b[?2004h"]
[65.869906, "o", "> "]
[65.869972, "o", "    sha256_hash = hashlib.sha256()\r\n\u001b[?2004l\r"]
[65.869988, "o", "\u001b[?2004h"]
[65.870004, "o", "> "]
[65.87009, "o", "    with open(checksum_path, 'rb') as f:\r\n\u001b[?2004l\r"]
[65.870107, "o", "\u001b[?2004h"]
[65.870129, "o", "> "]
[65.870198, "o", "        sha256_hash.update(f.read())\r\n\u001b[?2004l\r"]
[65.870215, "o", "\u001b[?2004h> "]
[65.870231, "o", "    \r\n\u001b[?2004l\r"]
[65.870247, "o", "\u001b[?2004h"]
[65.870263, "o", "> "]
[65.870318, "o", "    # Update symlink\r\n\u001b[?2004l\r"]
[65.870335, "o", "\u001b[?2004h"]
[65.870357, "o", "> "]
[65.870445, "o", "    latest_path = base_dir / 'latest'\r\n\u001b[?2004l\r"]
[65.870462, "o", "\u001b[?2004h"]
[65.870478, "o", "> "]
[65.870534, "o", "    if latest_path.exists():\r\n\u001b[?2004l\r"]
[65.870552, "o", "\u001b[?2004h"]
[65.870569, "o", "> "]
[65.870624, "o", "        latest_path.unlink()\r\n\u001b[?2004l\r"]
[65.870642, "o", "\u001b[?2004h"]
[65.870669, "o", "> "]
[65.87079, "o", "    latest_path.symlink_to(summary_path, absolute=True)\r\n\u001b[?2004l\r"]
[65.870808, "o", "\u001b[?2004h"]
[65.870824, "o", ">     \r\n\u001b[?2004l\r"]
[65.870841, "o", "\u001b[?2004h"]
[65.870864, "o", "> "]
[65.870935, "o", "    # Append to operations log\r\n\u001b[?2004l\r"]
[65.870961, "o", "\u001b[?2004h> "]
[65.871088, "o", "    ops_log_path = base_dir / 'operations.log'\r\n\u001b[?2004l\r"]
[65.871105, "o", "\u001b[?2004h"]
[65.871121, "o", "> "]
[65.871224, "o", "    with open(ops_log_path, 'a') as f:\r\n\u001b[?2004l\r"]
[65.871244, "o", "\u001b[?2004h> "]
[65.871541, "o", "        f.write(f\"Publication 2023-01: {results['total_files_processed']} files, Checksum: {sha256_hash.hexdigest()}\\n\")\r\n\u001b[?2004l\r"]
[65.871559, "o", "\u001b[?2004h> "]
[65.871581, "o", "    \r\n\u001b[?2004l\r"]
[65.8716, "o", "\u001b[?2004h"]
[65.871618, "o", "> "]
[65.871798, "o", "    print(\"Processing complete. Results are in the reports directory.\")\r\n\u001b[?2004l\r"]
[65.87182, "o", "\u001b[?2004h"]
[65.871838, "o", "> "]
[65.871866, "o", "    return 0\r\n\u001b[?2004l\r"]
[65.871887, "o", "\u001b[?2004h> "]
[65.871905, "o", "\r\n\u001b[?2004l\r"]
[65.871924, "o", "\u001b[?2004h> "]
[65.872, "o", "if __name__ == '__main__':\r\n\u001b[?2004l\r"]
[65.872018, "o", "\u001b[?2004h> "]
[65.872082, "o", "    sys.exit(main())\r\n\u001b[?2004l\r"]
[65.872102, "o", "\u001b[?2004h"]
[65.872119, "o", "> EOF"]
[66.681446, "i", "chmod +x /tmp/capacity_work/process_data.py\n"]
[66.681594, "o", "chmod +x /tmp/capacity_work/process_data.py\r\n\u001b[?2004l\r"]
[66.681623, "o", "\u001b[?2004h"]
[66.681642, "o", "> "]
[66.77355, "i", "python3 /tmp/capacity_work/process_data.py\n"]
[66.773757, "o", "python3 /tmp/capacity_work/process_data.py\r\n\u001b[?2004l\r"]
[66.773798, "o", "\u001b[?2004h> "]
[80.977632, "i", "ls -la reports/\n"]
[80.977756, "o", "ls -la reports/\r\n\u001b[?2004l\r"]
[80.977791, "o", "\u001b[?2004h> "]
[91.981621, "i", "ls -la reports/\n"]
[91.981774, "o", "ls -la reports/\r\n\u001b[?2004l\r"]
[91.981842, "o", "\u001b[?2004h> "]
[92.085212, "i", "wc -c reports/intermediate.json\n"]
[92.085331, "o", "wc -c reports/intermediate.json\r\n"]
[92.085367, "o", "\u001b[?2004l\r"]
[92.085394, "o", "\u001b[?2004h> "]
[92.233401, "i", "od -c reports/summary_202301.log | head -3\n"]
[92.233568, "o", "od -c reports/summary_202301.log | head -3\r\n\u001b[?2004l\r"]
[92.233613, "o", "\u001b[?2004h> "]
[92.355393, "i", "hexdump -C reports/checksum.bin\n"]
[92.355518, "o", "hexdump -C reports/checksum.bin\r\n\u001b[?2004l\r"]
[92.355556, "o", "\u001b[?2004h"]
[92.355601, "o", "> "]
[92.471066, "i", "tail -1 operations.log\n"]
[92.471182, "o", "tail -1 operations.log\r\n\u001b[?2004l\r"]
[92.471219, "o", "\u001b[?2004h> "]
[101.603752, "i", "bash -c \"ls -la reports/\"\n"]
[101.603878, "o", "bash -c \"ls -la reports/\"\r\n"]
[101.603899, "o", "\u001b[?2004l\r"]
[101.603956, "o", "\u001b[?2004h> "]
[102.065902, "i", "bash -c \"cat reports/intermediate.json\"\n"]
[102.066045, "o", "bash -c \"cat reports/intermediate.json\"\r\n\u001b[?2004l\r"]
[102.066077, "o", "\u001b[?2004h"]
[102.066097, "o", "> "]
[110.348745, "i", "\n"]
[110.348841, "o", "\r\n\u001b[?2004l\r"]
[110.348866, "o", "\u001b[?2004h> "]
[110.43773, "i", "ls\n"]
[110.437829, "o", "ls\r\n\u001b[?2004l\r\u001b[?2004h> "]
[118.66693, "i", "bash -c 'cd /home/user/capacity && ls -la reports/'\n"]
[118.667114, "o", "bash -c 'cd /home/user/capacity && ls -la reports/'\r\n\u001b[?2004l\r"]
[118.667158, "o", "\u001b[?2004h> "]
[128.682598, "i", "exec bash -c \"cd /home/user/capacity && ls reports/\"\n"]
[128.682836, "o", "exec bash -c \"cd /home/user/capacity && ls reports/\"\r\n\u001b[?2004l\r"]
[128.682879, "o", "\u001b[?2004h> "]
[137.25071, "i", "rm -rf /tmp/capacity_work\n"]
[137.250827, "o", "rm -rf /tmp/capacity_work\r\n\u001b[?2004l\r"]
[137.250858, "o", "\u001b[?2004h> "]
