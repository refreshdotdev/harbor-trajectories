New Terminal Output:

root@1420d0fc-ea92-4280-aba8-678707baa0a3:/home/user/firewall# ls -la *.json *.v4 *.csv
-rw-r--r-- 1 root root    0 Feb 13 19:06 audit_manifest.csv
-rwxr-xr-x 1 root root  335 Feb 12 22:36 base_rules.v4
-rw-r--r-- 1 root root 2489 Feb 13 19:06 intermediate.json
-rw-r--r-- 1 root root 1598 Feb 13 19:06 optimized_rules.v4
root@1420d0fc-ea92-4280-aba8-678707baa0a3:/home/user/firewall# cat intermediate.json
[
  {
    "type": "allow",
    "protocol": "tcp",
    "ip": "172.16.0.8",
    "port": "80"
  },
  {
    "type": "allow",
    "protocol": "tcp",
    "ip": "172.16.0.8",
    "port": "443"
  },
  {
    "type": "allow",
    "protocol": "tcp",
    "ip": "172.16.0.8",
    "port": "9000"
  },
  {
    "type": "allow",
    "protocol": "tcp",
    "ip": "172.16.0.8",
    "port": "9001"
  },
  {
    "type": "allow",
    "protocol": "tcp",
    "ip": "172.16.0.8",
    "port": "9002"
  },
  {
    "type": "allow",
    "protocol": "tcp",
    "ip": "172.16.0.8",
    "port": "9003"
  },
  {
    "type": "allow",
    "protocol": "tcp",
    "ip": "172.16.0.8",
    "port": "9004"
  },
  {
    "type": "allow",
    "protocol": "tcp",
    "ip": "172.16.0.8",
    "port": "9005"
  },
  {
    "type": "allow",
    "protocol": "tcp",
    "ip": "172.16.0.8",
    "port": "9006"
  },
  {
    "type": "allow",
    "protocol": "tcp",
    "ip": "172.16.0.8",
    "port": "9007"
  },
  {
    "type": "allow",
    "protocol": "tcp",
    "ip": "172.16.0.8",
    "port": "9008"
  },
  {
    "type": "allow",
    "protocol": "tcp",
    "ip": "172.16.0.8",
    "port": "9009"
  },
  {
    "type": "allow",
    "protocol": "tcp",
    "ip": "172.16.0.8",
    "port": "9010"
  },
  {
    "type": "block",
    "protocol": "tcp",
    "ip": "any",
    "port": "25"
  },
  {
    "type": "block",
    "protocol": "tcp",
    "ip": "any",
    "port": "143"
  },
  {
    "type": "block",
    "protocol": "tcp",
    "ip": "any",
    "port": "993"
  },
  {
    "type": "block",
    "protocol": "tcp",
    "ip": "any",
    "port": "8080"
  },
  {
    "type": "block",
    "protocol": "tcp",
    "ip": "any",
    "port": "8081"
  },
  {
    "type": "block",
    "protocol": "tcp",
    "ip": "any",
    "port": "8082"
  },
  {
    "type": "block",
    "protocol": "tcp",
    "ip": "any",
    "port": "8083"
  },
  {
    "type": "block",
    "protocol": "tcp",
    "ip": "any",
    "port": "8084"
  },
  {
    "type": "block",
    "protocol": "tcp",
    "ip": "any",
    "port": "8085"
  },
  {
    "type": "block",
    "protocol": "tcp",
    "ip": "any",
    "port": "8086"
  },
  {
    "type": "block",
    "protocol": "tcp",
    "ip": "any",
    "port": "8087"
  },
  {
    "type": "block",
    "protocol": "tcp",
    "ip": "any",
    "port": "8088"
  },
  {
    "type": "block",
    "protocol": "tcp",
    "ip": "any",
    "port": "8089"
  },
  {
    "type": "block",
    "protocol": "tcp",
    "ip": "any",
    "port": "8090"
  }
]root@1420d0fc-ea92-4280-aba8-678707baa0a3:/home/user/firewall# cat optimized_rules.v4
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
-A INPUT -p tcp --dport 25 -j DROP
-A INPUT -p tcp --dport 80 -s 172.16.0.8 -j ACCEPT
-A INPUT -p tcp --dport 143 -j DROP
-A INPUT -p tcp --dport 443 -s 172.16.0.8 -j ACCEPT
-A INPUT -p tcp --dport 993 -j DROP
-A INPUT -p tcp --dport 8080 -j DROP
-A INPUT -p tcp --dport 8081 -j DROP
-A INPUT -p tcp --dport 8082 -j DROP
-A INPUT -p tcp --dport 8083 -j DROP
-A INPUT -p tcp --dport 8084 -j DROP
-A INPUT -p tcp --dport 8085 -j DROP
-A INPUT -p tcp --dport 8086 -j DROP
-A INPUT -p tcp --dport 8087 -j DROP
-A INPUT -p tcp --dport 8088 -j DROP
-A INPUT -p tcp --dport 8089 -j DROP
-A INPUT -p tcp --dport 8090 -j DROP
-A INPUT -p tcp --dport 9000 -s 172.16.0.8 -j ACCEPT
-A INPUT -p tcp --dport 9001 -s 172.16.0.8 -j ACCEPT
-A INPUT -p tcp --dport 9002 -s 172.16.0.8 -j ACCEPT
-A INPUT -p tcp --dport 9003 -s 172.16.0.8 -j ACCEPT
-A INPUT -p tcp --dport 9004 -s 172.16.0.8 -j ACCEPT
-A INPUT -p tcp --dport 9005 -s 172.16.0.8 -j ACCEPT
-A INPUT -p tcp --dport 9006 -s 172.16.0.8 -j ACCEPT
-A INPUT -p tcp --dport 9007 -s 172.16.0.8 -j ACCEPT
-A INPUT -p tcp --dport 9008 -s 172.16.0.8 -j ACCEPT
-A INPUT -p tcp --dport 9009 -s 172.16.0.8 -j ACCEPT
-A INPUT -p tcp --dport 9010 -s 172.16.0.8 -j ACCEPT
*filter
:INPUT ACCEPT [0:0]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
-A INPUT -p tcp --dport 22 -j ACCEPT
-A INPUT -p tcp --dport 80 -j ACCEPT
-A INPUT -p tcp --dport 443 -j ACCEPT
-A INPUT -p tcp --dport 8080 -j ACCEPT
-A INPUT -p tcp --dport 3306 -j ACCEPT
COMMIT
COMMIT
root@1420d0fc-ea92-4280-aba8-678707baa0a3:/home/user/firewall# file audit_manifest.csv
bash: file: command not found
root@1420d0fc-ea92-4280-aba8-678707baa0a3:/home/user/firewall# head -5 audit_manifest.csv
root@1420d0fc-ea92-4280-aba8-678707baa0a3:/home/user/firewall#
