Previous response had warnings:
WARNINGS: - Extra text detected before JSON object
- Extra text detected after JSON object

New Terminal Output:

root@fed5a6e7-5eb4-4b1c-91ac-722212d1f822:/workspace/repo/pygears/sim# cat inst.py
import inspect
import weakref
from pygears import reg, Intf, module, find
from pygears.sim.sim_gear import SimGear, is_simgear_func
from pygears.sim.sim import SimPlugin, cosim
from pygears.core.gear import GearPlugin
from pygears.core.gear_inst import gear_base_resolver
from pygears.core.hier_node import HierVisitorBase
from pygears.core.port import HDLConsumer, HDLProducer
intfs = []

class SimInstVisitor(HierVisitorBase):

    def __init__(self):
        self.namespace = reg['sim/module_namespace']
        self.sim_map = reg['sim/map']

    def Gear(self, module):
        if module.parent is None:
            return False
        if module.params.get('__sim__', None) is not None:
            cfg = module.params['__sim__']
            if isinstance(cfg, dict):
                cfg = cfg.copy()
                sim = cfg.pop('sim')
                cosim(module, sim, **cfg)
            else:
                cosim(module, cfg)
        sim_cls = module.params.get('sim_cls', None)
        sim_inst = None
        if sim_cls is None:
            sim_cls = self.namespace.get(module.definition, None)
        if sim_cls:
            sim_inst = sim_cls(module)
        elif is_simgear_func(module.func):
            sim_inst = SimGear(module)
        if sim_inst:
            self.sim_map[module] = sim_inst
            return True

def sim_inst(top=None):
    if top is None:
        top = find('/')
    v = SimInstVisitor()
    v.visit(top)
    return top

class SimInstPlugin(SimPlugin, GearPlugin):

    @classmethod
    def bind(cls):
        reg['sim/flow'].append(sim_inst)
        reg['sim/module_namespace'] = {}
        reg['sim/map'] = {}
        reg['gear/params/extra/sim_cls'] = None
        reg['gear/params/extra/__sim__'] = None
        reg['gear/gear_dflt_resolver'] = sim_compile_resolver

    @classmethod
    def reset(cls):
        reg['sim/map'] = {}root@fed5a6e7-5eb4-4b1c-91ac-722212d1f822:/workspace/repo/pygears/sim#
