{"version": 2, "width": 160, "height": 40, "timestamp": 1770669313, "env": {"SHELL": "/bin/bash", "TERM": "tmux-256color"}}
[0.005743, "o", "\u001b[?2004hroot@76218711-ea79-41ae-8fd9-e6939733f603:/workspace/repo# "]
[0.955615, "i", "clear\r"]
[0.955863, "o", "clear\r\n\u001b[?2004l\r"]
[0.957116, "o", "\u001b[H\u001b[J\u001b[3J"]
[0.957265, "o", "\u001b[?2004hroot@76218711-ea79-41ae-8fd9-e6939733f603:/workspace/repo# "]
[6.373283, "i", "cd hardeneks/namespace_based/reliability/\n"]
[6.373754, "o", "cd hardeneks/namespace_based/reliability/\r\n\u001b[?2004l\r"]
[6.373973, "o", "\u001b[?2004hroot@76218711-ea79-41ae-8fd9-e6939733f603:/workspace/repo/hardeneks/namespace_based/reliability# "]
[6.827238, "i", "vi applications.py\n"]
[6.82739, "o", "vi applications.py\r\n\u001b[?2004l\r"]
[6.827861, "o", "bash: vi: command not found\r\n"]
[6.828199, "o", "\u001b[?2004hroot@76218711-ea79-41ae-8fd9-e6939733f603:/workspace/repo/hardeneks/namespace_based/reliability# "]
[10.821065, "i", "nano applications.py\n"]
[10.821553, "o", "nano applications.py\r\n\u001b[?2004l\r"]
[10.822347, "o", "bash: nano: command not found\r\n"]
[10.822859, "o", "\u001b[?2004hroot@76218711-ea79-41ae-8fd9-e6939733f603:/workspace/repo/hardeneks/namespace_based/reliability# "]
[15.592328, "i", "cat applications.py\n"]
[15.592549, "o", "cat applications.py\r\n\u001b[?2004l\r"]
[15.594423, "o", "from ...resources import NamespacedResources\r\nfrom hardeneks.rules import Rule, Result\r\n\r\nclass avoid_running_singleton_pods(Rule):\r\n    _type = 'namespace_based'\r\n    pillar = 'reliability'\r\n    section = 'applications'\r\n    message = 'Avoid running pods without deployments.'\r\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#avoid-running-singleton-pods'\r\n\r\n    def check(self, namespaced_resources: NamespacedResources):\r\n        offenders = []\r\n        for pod in namespaced_resources.pods:\r\n            owner = pod.metadata.owner_references\r\n            if not owner:\r\n                offenders.append(pod)\r\n        self.result = Result(status=True, resource_type='Pod', namespace=namespaced_resources.namespace)\r\n        if offenders:\r\n            self.result = Result(status=False, resource_type='Pod', resources=[i.metadata.name for i in offenders], namespace=namespaced_resources.namespace)\r\n\r\nclass run_multiple_replicas(Rule):\r\n    _type = 'namespace_based'\r\n    pillar = 'reliability'\r\n    section = 'applications'\r\n    message = 'Avoid running single replica deployments.'\r\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#run-multiple-replicas'\r\n\r\n    def check(self, namespaced_resources: NamespacedResources):\r\n        offenders = []\r\n        for deployment in namespaced_resources.deployments:\r\n            if deployment.spec.replicas < 2:\r\n                offenders.append(deployment)\r\n        self.result = Result(status=True, resource_type='Deployment', namespace=namespaced_resources.namespace)\r\n        if offenders:\r\n            self.result = Result(status=False, resource_type='Deployment', resources=[i.metadata.name for i in offenders], namespace=namespaced_resources.namespace)\r\n\r\nclass schedule_replicas_across_nodes(Rule):\r\n    _type = 'namespace_based'\r\n"]
[15.594463, "o", "    pillar = 'reliability'\r\n    section = 'applications'\r\n    message = 'Spread replicas across AZs and Nodes.'\r\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#schedule-replicas-across-nodes'\r\n\r\n    def check(self, namespaced_resources: NamespacedResources):\r\n        \"\"\"\r\n        TODO: Implement this function\r\n        \"\"\"\r\n        ...\r\n\r\nclass check_horizontal_pod_autoscaling_exists(Rule):\r\n    _type = 'namespace_based'\r\n    pillar = 'reliability'\r\n    section = 'applications'\r\n    message = 'Deploy horizontal pod autoscaler for deployments.'\r\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#horizontal-pod-autoscaler-hpa'\r\n\r\n    def check(self, namespaced_resources: NamespacedResources):\r\n        offenders = []\r\n        hpas = [i.spec.scale_target_ref.name for i in namespaced_resources.hpas]\r\n        for deployment in namespaced_resources.deployments:\r\n            if deployment.metadata.name not in hpas:\r\n                offenders.append(deployment)\r\n        self.result = Result(status=True, resource_type='Deployment', namespace=namespaced_resources.namespace)\r\n        if offenders:\r\n            self.result = Result(status=False, resource_type='Deployment', resources=[i.metadata.name for i in offenders], namespace=namespaced_resources.namespace)"]
[15.594551, "o", "\r\n\r\nclass check_readiness_probes(Rule):\r\n    _type = 'namespace_based'\r\n    pillar = 'reliability'\r\n    section = 'applications'\r\n    message = 'Define readiness probes for pods.'\r\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#use-readiness-probe-to-detect-partial-unavailability'\r\n\r\n    def check(self, namespaced_resources: NamespacedResources):\r\n        offenders = []\r\n        for pod in namespaced_resources.pods:\r\n            for container in pod.spec.containers:\r\n                if not container.readiness_probe:\r\n                    offenders.append(pod)\r\n"]
[15.594578, "o", "        self.result = Result(status=True, resource_type='Pod', namespace=namespaced_resources.namespace)\r\n        if offenders:\r\n            self.result = Result(status=False, resource_type='Pod', resources=[i.metadata.name for i in offenders], namespace=namespaced_resources.namespace)\r\n\r\nclass check_liveness_probes(Rule):\r\n    _type = 'namespace_based'\r\n    pillar = 'reliability'\r\n    section = 'applications'\r\n    message = 'Define liveness probes for pods.'\r\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#use-liveness-probe-to-remove-unhealthy-pods'\r\n\r\n    def check(self, namespaced_resources: NamespacedResources):\r\n        offenders = []\r\n        for pod in namespaced_resources.pods:\r\n            for container in pod.spec.containers:\r\n                if not container.liveness_probe:\r\n                    offenders.append(pod)\r\n        self.result = Result(status=True, resource_type='Pod', namespace=namespaced_resources.namespace)\r\n        if offenders:\r\n            self.result = Result(status=False, resource_type='Pod', resources=[i.metadata.name for i in offenders], namespace=namespaced_resources.namespace)"]
[15.59485, "o", "\u001b[?2004hroot@76218711-ea79-41ae-8fd9-e6939733f603:/workspace/repo/hardeneks/namespace_based/reliability# "]
[30.906208, "i", "echo \"from...resources import NamespacedResources\\nfrom hardeneks.rules import Rule, Result\\n\\nclass avoid_running_singleton_pods(Rule):\\n    _type = 'namespace_based'\\n    pillar ='reliability'\\n    section = 'applications'\\n    message = 'Avoid running pods without deployments.'\\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#avoid-running-singleton-pods'\\n\\n    def check(self, namespaced_resources: NamespacedResources):\\n        offenders = []\\n        for pod in namespaced_resources.pods:\\n            owner = pod.metadata.owner_references\\n            if not owner:\\n                offenders.append(pod)\\n        self.result = Result(status=True, resource_type='Pod', namespace=namespaced_resources.namespace)\\n        if offenders:\\n            self.result = Result(status=False, resource_type='Pod', resources=[i.metadata.name for i in offenders], namespace=namespaced_resources.namespace)\\n\\nclass run_multiple_replicas(Rule):\\n    _type = 'namespace_based'\\n    pillar ='reliability'\\n    section = 'applications'\\n    message = 'Avoid running single replica deployments.'\\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#run-multiple-replicas'\\n\\n    def check(self, namespaced_resources: NamespacedResources):\\n        offenders = []\\n        for deployment in namespaced_resources.deployments:\\n            if deployment.spec.replicas < 2:\\n                offenders.append(deployment)\\n        self.result = Result(status=True, resource_type='Deployment', namespace=namespaced_resources.namespace)\\n        if offenders:\\n            self.result = Result(status=False, resource_type='Deployment', resources=[i.metadata.name for i in offenders], namespace=namespaced_resources.namespace)\\n\\nclass schedule_replicas_across_nodes(Rule):\\n    _type = 'namespace_based'\\n    pillar ='reliability'\\n    section = 'applications'\\n    message = 'Spread replicas across AZs and Nodes.'\\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#schedule-replicas-across-nodes'\\n\\n    def check(self, namespaced_resources: NamespacedResources):\\n        offenders = []\\n        for deployment in namespaced_resources.deployments:\\n            if not deployment.spec.template.spec.affinity or not deployment.spec.template.spec.topology_spread_constraints:\\n                offenders.append(deployment)\\n        self.result = Result(status=True, resource_type='Deployment', namespace=namespaced_resources.namespace)\\n        if offenders:\\n            self.result = Result(status=False, resource_type='Deployment', resources=[i.metadata.name for i in offenders], namespace=namespaced_resources.namespace)\\n\\nclass check_horizontal_pod_autoscaling_exists(Rule):\\n    _type = 'namespace_based'\\n    pillar ='reliability'\\n    section = 'applications'\\n    message = 'Deploy horizontal pod autoscaler for deployments.'\\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#horizontal-pod-autoscaler-hpa'\\n\\n    def check(self, namespaced_resources: NamespacedResources):\\n        offenders = []\\n        hpas = [i.spec.scale_target_ref.name for i in namespaced_resources.hpas]\\n        for deployment in namespaced_resources.deployments:\\n            if deployment.metadata.name not in hpas:\\n                offenders.append(deployment)\\n        self.result = Result(status=True, resource_type='Deployment', namespace=namespaced_resources.namespace)\\n        if offenders:\\n            self.result = Result(status=False, resource_type='Deployment', resources=[i.metadata.name for i in offenders], namespace=namespaced_resources.namespace)\\n\\nclass check_readiness_probes(Rule):\\n    _type = 'namespace_based'\\n    pillar ='reliability'\\n    section = 'applications'\\n    message = 'Define readiness probes for pods.'\\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#use-readiness-probe-to-detect-partial-unavailability'\\n\\n    def check(self, namespaced_resources: NamespacedResources):\\n        offenders = []\\n  "]
[30.90625, "i", "      for pod in namespaced_resources.pods:\\n            for container in pod.spec.containers:\\n                if not container.readiness_probe:\\n                    offenders.append(pod)\\n        self.result = Result(status=True, resource_type='Pod', namespace=namespaced_resources.namespace)\\n        if offenders:\\n            self.result = Result(status=False, resource_type='Pod', resources=[i.metadata.name for i in offenders], namespace=namespaced_resources.namespace)\\n\\nclass check_liveness_probes(Rule):\\n    _type = 'namespace_based'\\n    pillar ='reliability'\\n    section = 'applications'\\n    message = 'Define liveness probes for pods.'\\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#use-liveness-probe-to-remove-unhealthy-pods'\\n\\n    def check(self, namespaced_resources: NamespacedResources):\\n        offenders = []\\n        for pod in namespaced_resources.pods:\\n            for container in pod.spec.containers:\\n                if not container.liveness_probe:\\n                    offenders.append(pod)\\n        self.result = Result(status=True, resource_type='Pod', namespace=namespaced_resources.namespace)\\n        if offenders:\\n            self.result = Result(status=False, resource_type='Pod', resources=[i.metadata.name for i in offenders], namespace=namespaced_resources.namespace)\" > applications.py\\n"]
[30.941665, "o", "echo \"from...resources import NamespacedResources\\nfrom hardeneks.rules import Rule, Result\\n\\nclass avoid_running_singleton_pods(Rule):\\n    _type = 'namespace_based'\\n    pillar ='reliability'\\n    section = 'applications'\\n    message = 'Avoid running pods without deployments.'\\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#avoid-running-singleton-pods'\\n\\n    def check(self, namespaced_resources: NamespacedResources):\\n        offenders = []\\n        for pod in namespaced_resources.pods:\\n            owner = pod.metadata.owner_references\\n            if not owner:\\n                offenders.append(pod)\\n        self.result = Result(status=True, resource_type='Pod', namespace=namespaced_resources.namespace)\\n        if offenders:\\n            self.result = Result(status=False, resource_type='Pod', resources=[i.metadata.name for i in offenders], namespace=namespaced_resources.namespace)\\n\\nclass run_multiple_replicas(Rule):\\n    _type = 'namespace_based'\\n    pillar ='reliability'\\n    section = 'applications'\\n    message = 'Avoid running single replica deployments.'\\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#run-multiple-replicas'\\n\\n    def check(self, namespaced_resources: NamespacedResources):\\n        offenders = []\\n        for deployment in namespaced_resources.deployments:\\n            if deployment.spec.replicas < 2:\\n                offenders.append(deployment)\\n        self.result = Result(status=True, resource_type='Deployment', namespace=namespaced_resources.namespace)\\n        if offenders:\\n            self.result = Result(status=False, resource_type='Deployment', resources=[i.metadata.name for i in offenders], namespace=namespaced_resources.namespace)\\n\\nclass schedule_replicas_across_nodes(Rule):\\n    _type = 'namespace_based'\\n    pillar ='reliability'\\n    section = 'applications'\\n    message = 'Spread replicas across AZs and Nodes.'\\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#schedule-replicas-across-nodes'\\n\\n    def check(self, namespaced_resources: NamespacedResources):\\n        offenders = []\\n        for deployment in namespaced_resources.deployments:\\n            if not deployment.spec.template.spec.affinity or not deployment.spec.template.spec.topology_spread_constraints:\\n                offenders.append(deployment)\\n        self.result = Result(status=True, resource_type='Deployment', namespace=namespaced_resources.namespace)\\n        if offenders:\\n            self.result = Result(status=False, resource_type='Deployment', resources=[i.metadata.name for i in offenders], namespace=namespaced_resources.namespace)\\n\\nclass check_horizontal_pod_autoscaling_exists(Rule):\\n    _type = 'namespace_based'\\n    pillar ='reliability'\\n    section = 'applications'\\n    message = 'Deploy horizontal pod autoscaler for deployments.'\\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#horizontal-pod-autoscaler-hpa'\\n\\n    def check(self, nam"]
[30.941805, "o", "espaced_resources: NamespacedResources):\\n        offenders = []\\n        hpas = [i.spec.scale_target_ref.name for i in namespaced_resources.hpas]\\n        for deployment in namespaced_resources.deployments:\\n            if deployment.metadata.name not in hpas:\\n                offenders.append(deployment)\\n        self.result = Result(status=True, resource_type='Deployment', namespace=namespaced_resources.namespace)\\n        if offenders:\\n            self.result = Result(status=False, resource_type='Deployment', resources=[i.metadata.name for i in offenders], namespace=namespaced_resources.namespace)\\n\\nclass check_readiness_probes(Rule):\\n    _type = 'namespace_based'\\n    pillar ='reliability'\\n    section = 'applications'\\n    message = 'Define readiness probes for pods.'\\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#use-readiness-probe-to-detect-partial-unavailability'\\n\\n    def check(self, namespaced_resources: NamespacedResources):\\n        offenders = []\\n        for pod in namespaced_resources.pods:\\n            for container in pod.spec.containers:\\n                if not container.readiness_probe:\\n                    offenders.append(pod)\\n        self.result = Result(status=True, resource_type='Pod', namespace=namespaced_resources.namespace)\\n        if offenders:\\n            self.result = Result(status=False, resource_type='Pod', resources=[i.metadata.name for i in offenders], namespace=namespaced_resources.namespace)\\n\\nclass check_liveness_probes(Rule):\\n    _type = 'namespace_based'\\n    pillar ='reliability'\\n    section = 'applications'\\n    message = 'Define liveness probes for pods.'\\n    url = 'https://aws.github.io/aws-eks-best-practices/reliability/docs/application/#use-liveness-probe-to-remove-unhealthy-pods'\\n\\n    def check(self, namespaced_resources: NamespacedResources):\\n        offenders = []\\n        for pod in namespaced_resources.pods:\\n            for container in pod.spec.containers:\\n                if not container.liveness_probe:\\n                    offenders.append(pod)\\n        self.result = Result(status=True, resource_type='Pod', namespace=namespaced_resources.namespace)\\n        if offenders:\\n            self.result = Result(status=False, resource_type='Pod', resources=[i.metadata.name for i in offenders], namespace=namespaced_resources.namespace)\" > applications.py\\n"]
[31.339049, "i", "cd /workspace/repo\\n"]
[31.339477, "o", "cd /workspace/repo\\n"]
[32.007017, "i", "pytest tests/test_reliability_applications.py::test_schedule_replicas_across_nodes -v\\n"]
[32.007888, "o", "pytest tests/test_reliability_applications.py::test_schedule_replicas_across_nodes -v\\n"]
[48.183274, "i", "pytest tests/test_reliability_applications.py::test_schedule_replicas_across_nodes -v\n"]
[48.184086, "o", "pytest tests/test_reliability_applications.py::test_schedule_replicas_across_nodes -v\r\n"]
[48.184128, "o", "\u001b[?2004l\r"]
[48.185972, "o", "\u001b[?2004hroot@76218711-ea79-41ae-8fd9-e6939733f603:/workspace/repo/hardeneks/namespace_based/reliability# "]
