{"version": 2, "width": 160, "height": 40, "timestamp": 1770669934, "env": {"SHELL": "/bin/bash", "TERM": "tmux-256color"}}
[0.004315, "o", "\u001b[?2004hroot@cdd27edd-7519-4cce-88a5-5511fff825b9:/workspace/repo# "]
[0.922934, "i", "clear\r"]
[0.923169, "o", "clear\r\n\u001b[?2004l\r"]
[0.925763, "o", "\u001b[H\u001b[J\u001b[3J"]
[0.926033, "o", "\u001b[?2004hroot@cdd27edd-7519-4cce-88a5-5511fff825b9:/workspace/repo# "]
[5.05863, "i", "cd app/contrib\n"]
[5.058891, "o", "cd app/contrib\r\n\u001b[?2004l\r"]
[5.059066, "o", "\u001b[?2004hroot@cdd27edd-7519-4cce-88a5-5511fff825b9:/workspace/repo/app/contrib# "]
[5.499496, "i", "cat types.py\n"]
[5.499862, "o", "cat types.py\r\n\u001b[?2004l\r"]
[5.501363, "o", "from datetime import datetime\r\nfrom humanize import naturaltime\r\nfrom pydantic import BaseModel, RootModel, Field\r\nfrom scan.utils import pretty_size\r\n\r\ndef truncate(name: str, limit: int) -> str:\r\n    if len(name) <= limit:\r\n        return name\r\n    return name[:limit] + '...'\r\n\r\nclass DockerVersion(BaseModel):\r\n    platform_name: str = Field(alias=('Platform', 'Name'), default='')\r\n    version: str = Field(alias='Version')\r\n    api_version: str = Field(alias='ApiVersion')\r\n    min_api_version: str = Field(alias='MinAPIVersion')\r\n    os: str = Field(alias='Os')\r\n    arch: str = Field(alias='Arch')\r\n    kernel_version: str = Field(alias='KernelVersion')\r\n\r\nclass DockerImage(BaseModel):\r\n    id: str = Field(alias='Id')\r\n    created: datetime = Field(alias='Created')\r\n    parent_id: str = Field(alias='ParentId', default='')\r\n    repo_tags: list[str] | None = Field(alias='RepoTags', default_factory=list)\r\n    shared_size: int = Field(alias='SharedSize', default=0)\r\n    size: int = Field(alias='Size', default=0)\r\n    containers: list[str] | None = Field(default_factory=list)\r\n\r\n    @property\r\n    def short_id(self) -> str:\r\n        \"\"\"\r\n        TODO: Implement this function\r\n        \"\"\"\r\n        ...\r\n\r\n    @property\r\n    def created_delta(self) -> str:\r\n        \"\"\"\r\n        TODO: Implement this function\r\n        \"\"\"\r\n        ...\r\n\r\n    @property\r\n    def safe_repo_tags(self) -> list[str]:\r\n        \"\"\"\r\n        TODO: Implement this function\r\n        \"\"\"\r\n        ...\r\n\r\nclass DockerImageList(RootModel):\r\n    root: list[DockerImage]\r\n\r\n    def __iter__(self):\r\n        return iter(self.root)\r\n\r\n    def __getitem__(self, item):\r\n        return self.root[item]\r\n\r\nclass DockerContainer(BaseModel):\r\n    id: str = Field(alias='Id')\r\n    names: list[str] | None = Field(alias='Names', default_factory=list)\r\n    image: str = Field(alias='Image')\r\n    image_id: str = Field(alias='ImageID')\r\n    created: datetime = Field(alias='Created')\r\n    size_rw: int = Field(alias='SizeRw', default=0)\r\n    size_root_fs: int = Field(alias='SizeRootFs', default=0)\r\n    state: str = Field(alias='State', default='')\r\n\r\n    @property\r\n    def short_id(self) -> str:\r\n        return self.id[:12]\r\n\r\n    @property\r\n    def short_image(self) -> str:\r\n        if self.image.startswith('sha256:'):\r\n            return self.image[7:19]\r\n        return self.image\r\n\r\n    @property\r\n    def clean_names(self) -> list[str]:\r\n        if not self.names:\r\n            return []\r\n        return [name.lstrip('/') for name in self.names]\r\n\r\n    @property\r\n    def created_delta(self) -> str:\r\n        return naturaltime(self.created)\r\n\r\nclass DockerContainerList(RootModel):\r\n    root: list[DockerContainer]\r\n\r\n    def __iter__(self):\r\n        return iter(self.root)\r\n\r\n    def __getitem__(self, item):\r\n        return self.root[item]\r\n\r\nclass DockerVolume(BaseModel):\r\n    name: str = Field(alias='Name')\r\n    driver: str = Field(alias='Driver')\r\n    created_at: datetime = Field(alias='CreatedAt')\r\n    mountpoint: str = Field(alias='Mountpoint', default='')\r\n    scope: str = Field(alias='Scope', default='local')\r\n    usage_data: dict | None = Field(alias='UsageData', default_factory=dict)\r\n    containers: list[str] | None = Field(default_factory=list)\r\n\r\n    @property\r\n    def short_name(self) -> str:\r\n        return truncate(self.name, 39)\r\n\r\n    @property\r\n    def size(self) -> int:\r\n        if 'Size' not in self.usage_data:\r\n            return 0\r\n        return self.usage_data['Size']\r\n\r\n    @property\r\n    def ref_count(self) -> int:\r\n        if 'RefCount' not in self.usage_data:\r\n            return 0\r\n        return self.usage_data['RefCount']\r\n\r\nclass DockerVolumeList(RootModel):\r\n    root: list[DockerVolume]\r\n\r\n    def __iter__(self):\r\n        return iter(self.root)\r\n\r\n    def __getitem__(self, item):\r\n        return self.root[item]\r\n\r\nclass DockerBuildCache(BaseModel):\r\n    id: str = Field(alias='ID')\r\n    type: str = Field(alias='Type')\r\n    description: str = Field(alias='Description', default='')\r\n    in_use: bool = Field(alias='InUse', default=False)\r\n    shared: bool = Field(alias='Shared', default=False)\r\n    size: int = Field(alias='Size', default=0)\r\n    created_at: datetime = Field(alias='CreatedAt')\r\n    last_used: datetime = Field(alias='LastUsedAt')\r\n    usage_count: int = Field(alias='UsageCount', default=0)\r\n\r\n    @property\r\n    def last_used_delta(self) -> str:\r\n        return naturaltime(self.last_used)\r\n\r\n    @property\r\n    def short_desc(self) -> str:\r\n        return truncate(self.description, 180)\r\n\r\nclass DockerBuildCacheList(RootModel):\r\n    root: list[DockerBuildCache]\r\n\r\n    def __iter__(self):\r\n        return iter(self.root)\r\n\r\n    def __getitem__(self, item):\r\n        return self.root[item]\r\n\r\nclass DockerSystemDF(BaseModel):\r\n    images: DockerImageList = Field(alias='Images', default_factory=list)\r\n    containers: DockerContainerList = Field(alias='Containers', default_factory=list)\r\n    volumes: DockerVolumeList = Field(alias='Volumes', default_factory=list)\r\n    build_cache: DockerBuildCacheList = Field(alias='BuildCache', default_factory=list)\r\n\r\nclass DockerMount(BaseModel):\r\n    source: str = Field(alias='Source')\r\n    destination: str = Field(alias='Destination')\r\n    mode: str = Field(alias='Mode', default='')\r\n    propagation: str = Field(alias='Propagation', default='')\r\n    rw: bool = Field(alias='RW', default=False)\r\n    type: str = Field(alias='Type', default='')\r\n    root: bool = Field(alias='Root', default=False)\r\n\r\n    @property\r\n    def src(self) -> str:\r\n        return self.source\r\n\r\n    @property\r\n    def dst(self) -> str:\r\n        return self.destination\r\n\r\n    def info(self) -> str:\r\n        s = f'{self.src} -> {self.dst}'\r\n        if self.mode:\r\n            s += f':{self.mode}'\r\n        if self.root:\r\n            s += ' (root)'\r\n        return s\r\n\r\nclass DockerContainerLog(BaseModel):\r\n    id: str\r\n    name: str\r\n    image: str\r\n    path: str\r\n    size: int\r\n    last_scan: datetime\r\n\r\n    @property\r\n    def short_path(self) -> str:\r\n        return self.path[:39] + '...' + self.path[-9:]\r\n\r\nclass DockerBindMounts(BaseModel):\r\n    path: str\r\n    err: bool\r\n    size: int\r\n    scan_in_progress: bool\r\n    last_scan: datetime\r\n    containers: list[str]\r\n\r\n    @property\r\n    def last_scan_delta(self) -> str:\r\n        return naturaltime(self.last_scan)\r\n\r\nclass DockerOverlay2Layer(BaseModel):\r\n    id: str\r\n    created: datetime\r\n    diff_root: str\r\n    err: bool\r\n    size: int\r\n    scan_in_progress: bool\r\n    last_scan: datetime\r\n    in_use: bool\r\n\r\n    @property\r\n    def short_id(self) -> str:\r\n        return truncate(self.id, 22)\r\n\r\n    @property\r\n    def created_delta(self) -> str:\r\n        return naturaltime(self.created)\r\n\r\n    @property\r\n    def last_scan_delta(self) -> str:\r\n        return naturaltime(self.last_scan)\r\n\r\nclass DiskUsage(BaseModel):\r\n    total: int\r\n    used: int\r\n    free: int\r\n    percent: float\r\n\r\n    @property\r\n    def pretty_total(self) -> str:\r\n        return pretty_size(self.total)\r\n\r\n    @property\r\n    def pretty_used(self) -> str:\r\n        return pretty_size(self.used)\r\n\r\n    @property\r\n    def pretty_free(self) -> str:\r\n        return pretty_size(self.free)"]
[5.501708, "o", "\u001b[?2004hroot@cdd27edd-7519-4cce-88a5-5511fff825b9:/workspace/repo/app/contrib# "]
[37.891511, "i", "nano types.py\n"]
[37.891697, "o", "nano types.py\r\n\u001b[?2004l\r"]
[37.892336, "o", "bash: nano: command not found\r\n"]
[37.892693, "o", "\u001b[?2004h"]
[37.89272, "o", "root@cdd27edd-7519-4cce-88a5-5511fff825b9:/workspace/repo/app/contrib# "]
[49.673214, "i", "vi types.py\n"]
[49.673441, "o", "vi types.py\r\n\u001b[?2004l\r"]
[49.673886, "o", "bash: vi: command not found\r\n"]
[49.674153, "o", "\u001b[?2004hroot@cdd27edd-7519-4cce-88a5-5511fff825b9:/workspace/repo/app/contrib# "]
